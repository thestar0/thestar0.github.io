<!DOCTYPE html><html lang="zh-CN"><head><link rel="icon" href="/favicon.ico"/><title>代码混淆技术之控制流平坦化 | thestar的博客</title><meta name="theme-color" content="#000000"/><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, minimum-scale=1.0"/><meta name="robots" content="follow, index, max-snippet:-1, max-image-preview:large, max-video-preview:-1"/><meta charSet="UTF-8"/><meta name="format-detection" content="telephone=no"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="default"/><meta name="apple-mobile-web-app-title" content="代码混淆技术之控制流平坦化 | thestar的博客"/><meta name="keywords" content="红队,攻防,钓鱼,逆向,代码混淆技术,java安全,渗透测试,安全工具,漏洞分析,CTF"/><meta name="description" content="控制流平坦化混淆技术"/><meta name="author" content="thestar"/><meta name="generator" content="NotionNext"/><meta http-equiv="content-language" content="zh-CN"/><meta name="geo.region" content="CN"/><meta name="geo.country" content="CN"/><meta property="og:locale" content="zh_CN"/><meta property="og:title" content="代码混淆技术之控制流平坦化 | thestar的博客"/><meta property="og:description" content="控制流平坦化混淆技术"/><meta property="og:url" content="https://thestar0.github.io//article/2022/12/21/eef4533f-2e0e-40aa-b2ad-b859a802825c"/><meta property="og:image" content="https://www.notion.so/image/attachment%3Ade44147d-4cdf-48f2-8ff9-2a64437e928b%3AUntitled.png?table=collection&amp;id=210b67db-fc9a-8121-bebe-000bb39448db&amp;t=210b67db-fc9a-8121-bebe-000bb39448db"/><meta property="og:image:width" content="1200"/><meta property="og:image:height" content="630"/><meta property="og:image:alt" content="代码混淆技术之控制流平坦化 | thestar的博客"/><meta property="og:site_name" content="thestar的博客"/><meta property="og:type" content="Post"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@NotionNext"/><meta name="twitter:creator" content="@NotionNext"/><meta name="twitter:title" content="代码混淆技术之控制流平坦化 | thestar的博客"/><meta name="twitter:description" content="控制流平坦化混淆技术"/><meta name="twitter:image" content="https://www.notion.so/image/attachment%3Ade44147d-4cdf-48f2-8ff9-2a64437e928b%3AUntitled.png?table=collection&amp;id=210b67db-fc9a-8121-bebe-000bb39448db&amp;t=210b67db-fc9a-8121-bebe-000bb39448db"/><meta name="twitter:image:alt" content="代码混淆技术之控制流平坦化 | thestar的博客"/><link rel="icon" href="/favicon.ico"/><meta name="referrer" content="no-referrer-when-downgrade"/><meta property="article:published_time"/><meta property="article:modified_time"/><meta property="article:author" content="thestar"/><meta property="article:section" content="二"/><meta property="article:tag" content="红队,攻防,钓鱼,逆向,代码混淆技术,java安全,渗透测试,安全工具,漏洞分析,CTF"/><meta property="article:publisher"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","headline":"代码混淆技术之控制流平坦化 | thestar的博客","description":"控制流平坦化混淆技术","image":"https://www.notion.so/image/attachment%3Ade44147d-4cdf-48f2-8ff9-2a64437e928b%3AUntitled.png?table=collection&id=210b67db-fc9a-8121-bebe-000bb39448db&t=210b67db-fc9a-8121-bebe-000bb39448db","url":"https://thestar0.github.io//article/2022/12/21/eef4533f-2e0e-40aa-b2ad-b859a802825c","author":{"@type":"Person","name":"thestar"},"publisher":{"@type":"Organization","name":"thestar的博客","logo":{"@type":"ImageObject","url":"notion://custom_emoji/0dd8935a-39f8-4c94-aaf7-d2de23196366/225b67db-fc9a-80fe-9e2f-007add087083?t=210b67db-fc9a-8121-bebe-000bb39448db"}},"mainEntityOfPage":{"@type":"WebPage","@id":"https://thestar0.github.io//article/2022/12/21/eef4533f-2e0e-40aa-b2ad-b859a802825c"},"articleSection":"二"}</script><link rel="dns-prefetch" href="//fonts.googleapis.com"/><link rel="dns-prefetch" href="//www.google-analytics.com"/><link rel="dns-prefetch" href="//www.googletagmanager.com"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"/><link rel="preload" href="/fonts/inter-var.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><meta name="next-head-count" content="49"/><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" as="style" crossorigin="anonymous"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" referrerPolicy="no-referrer"/><script>
(function() {
  const darkMode = localStorage.getItem('darkMode')

  const prefersDark =
    window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches

  const defaultAppearance = 'light'

  let shouldBeDark = darkMode === 'true' || darkMode === 'dark'

  if (darkMode === null) {
    if (defaultAppearance === 'dark') {
      shouldBeDark = true
    } else if (defaultAppearance === 'auto') {
      // 检查是否在深色模式时间范围内
      const date = new Date()
      const hours = date.getHours()
      const darkTimeStart = 18
      const darkTimeEnd = 6
      
      shouldBeDark = prefersDark || (hours >= darkTimeStart || hours < darkTimeEnd)
    }
  }
  
  // 立即设置 html 元素的类
  document.documentElement.classList.add(shouldBeDark ? 'dark' : 'light')
})()
</script><link data-next-font="" rel="preconnect" href="/" crossorigin="anonymous"/><link rel="preload" href="/_next/static/css/04d62fb05118c45f.css" as="style"/><link rel="stylesheet" href="/_next/static/css/04d62fb05118c45f.css" data-n-g=""/><link rel="preload" href="/_next/static/css/33185b4d3e8a5bc3.css" as="style"/><link rel="stylesheet" href="/_next/static/css/33185b4d3e8a5bc3.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-8eb9ea776c017071.js" defer=""></script><script src="/_next/static/chunks/vendors-7221d25fcca09d9b.js" defer=""></script><script src="/_next/static/chunks/main-16c791f9e7bc4077.js" defer=""></script><script src="/_next/static/chunks/pages/_app-b48d70eeb4d8e1c2.js" defer=""></script><script src="/_next/static/chunks/common-32106f6ac18b9779.js" defer=""></script><script src="/_next/static/chunks/pages/%5Bprefix%5D/%5Bslug%5D/%5B...suffix%5D-2b629fd6f5a5056c.js" defer=""></script><script src="/_next/static/RToBr5HfI6dJkN6UgSld7/_buildManifest.js" defer=""></script><script src="/_next/static/RToBr5HfI6dJkN6UgSld7/_ssgManifest.js" defer=""></script><style id="__jsx-763a7ba965151bca">.dark body{background-color:black}</style><style id="__jsx-2783458257">null

  </style></head><body><div id="__next"><div id="theme-nobelium" class="font-sans font-light nobelium relative dark:text-gray-300  w-full  bg-white dark:bg-black min-h-screen flex flex-col scroll-smooth"><div class="observer-element h-4 md:h-12"></div><div class="sticky-nav m-auto w-full h-6 flex flex-row justify-between items-center mb-2 md:mb-12 py-8 bg-opacity-60 max-w-3xl px-4" id="sticky-nav"><div class="flex items-center"><a aria-label="thestar的博客" href="/"><div class="h-6 w-6"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="24" height="24" class="fill-current text-black dark:text-white"></rect><rect width="24" height="24" fill="url(#paint0_radial)"></rect><defs><radialGradient id="paint0_radial" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="rotate(45) scale(39.598)"><stop stop-color="#CFCFCF" stop-opacity="0.6"></stop><stop offset="1" stop-color="#E9E9E9" stop-opacity="0"></stop></radialGradient></defs></svg></div></a><p class="ml-2 max-h-12 line-clamp-2 overflow-ellipsis font-medium text-gray-800 dark:text-gray-300 header-name">代码混淆技术之控制流平坦化</p></div><div class="flex-shrink-0 flex"><ul class="hidden md:flex flex-row"><li class="mx-3 my-2"><div class="cursor-pointer "><div class="block text-black dark:text-gray-50 nav"><a href="/"><i class="fas fa-home"></i> <!-- -->首页</a></div></div></li><li class="mx-3 my-2"><div class="cursor-pointer "><div class="block text-black dark:text-gray-50 nav"><a href="/archive"><i class="fas fa-clock-rotate-left"></i> <!-- -->历史归档</a></div></div></li><li class="mx-3 my-2"><div class="cursor-pointer "><div class="block text-black dark:text-gray-50 nav"><a href="/tag"><i class="fas fa-tag"></i> <!-- -->文章标签</a></div></div></li><li class="mx-3 my-2"><div class="cursor-pointer "><div class="block text-black dark:text-gray-50 nav"><a href="/category"><i class="fas fa-th"></i> <!-- -->文章分类</a></div></div></li></ul><div class="md:hidden"><div style="height:0px;will-change:height" class="fixed top-16 right-6 overflow-hidden duration-300"><div class="dark:border-black bg-white dark:bg-black rounded border p-2 text-sm"><div class="w-full px-4 py-2 text-left dark:bg-hexo-black-gray dark:border-black"><a class="font-extralight  flex justify-between pl-2 pr-4 dark:text-gray-200 no-underline tracking-widest pb-1" href="/"><span class=" hover:text-red-400 transition-all items-center duration-200"><span class="mr-2"><i class="fas fa-home"></i></span>首页</span></a></div><div class="w-full px-4 py-2 text-left dark:bg-hexo-black-gray dark:border-black"><a class="font-extralight  flex justify-between pl-2 pr-4 dark:text-gray-200 no-underline tracking-widest pb-1" href="/archive"><span class=" hover:text-red-400 transition-all items-center duration-200"><span class="mr-2"><i class="fas fa-clock-rotate-left"></i></span>历史归档</span></a></div><div class="w-full px-4 py-2 text-left dark:bg-hexo-black-gray dark:border-black"><a class="font-extralight  flex justify-between pl-2 pr-4 dark:text-gray-200 no-underline tracking-widest pb-1" href="/tag"><span class=" hover:text-red-400 transition-all items-center duration-200"><span class="mr-2"><i class="fas fa-tag"></i></span>文章标签</span></a></div><div class="w-full px-4 py-2 text-left dark:bg-hexo-black-gray dark:border-black"><a class="font-extralight  flex justify-between pl-2 pr-4 dark:text-gray-200 no-underline tracking-widest pb-1" href="/category"><span class=" hover:text-red-400 transition-all items-center duration-200"><span class="mr-2"><i class="fas fa-th"></i></span>文章分类</span></a></div></div></div></div><i class="fas fa-bars cursor-pointer px-5 flex justify-center items-center md:hidden"></i></div></div><main id="out-wrapper" class="relative m-auto flex-grow w-full transition-all max-w-2xl px-4"><div class="transition ease-in-out duration-700 transform order-first opacity-0 translate-y-16"><div class="px-2"><section class="flex-wrap flex mt-2 text-gray--600 dark:text-gray-400 font-light leading-8"><div><h1 class="font-bold text-3xl text-black dark:text-white">代码混淆技术之控制流平坦化</h1><nav class="flex mt-7 items-start text-gray-500 dark:text-gray-400"><div class="flex mb-4"><a href="https://github.com/thestar0" class="flex"><img alt="thestar" loading="lazy" width="24" height="24" decoding="async" data-nimg="1" class="rounded-full" style="color:transparent" src="https://gravatar.com/avatar/d41d8cd98f00b204e9800998ecf8427e"/><p class="ml-2 md:block">thestar</p></a><span class="block"> / </span></div><div class="mr-2 mb-4 md:ml-0">2022-12-21</div><span class="hidden busuanzi_container_page_pv mr-2"><i class="mr-1 fas fa-eye"></i> <span class="mr-2 busuanzi_value_page_pv"></span></span></nav></div></section><div id="article-wrapper"><div id="notion-article" class="mx-auto overflow-hidden "><main class="notion light-mode notion-page notion-block-eef4533f2e0e40aab2adb859a802825c"><div class="notion-viewport"></div><div class="notion-collection-page-properties"><div class="notion-collection-row"><div class="notion-collection-row-body"><div class="notion-collection-row-property"><div class="notion-collection-column-title"><svg viewBox="0 0 14 14" class="notion-collection-column-title-icon"><path d="M7 13A6 6 0 107 1a6 6 0 000 12zM3.751 5.323A.2.2 0 013.909 5h6.182a.2.2 0 01.158.323L7.158 9.297a.2.2 0 01-.316 0L3.751 5.323z"></path></svg><div class="notion-collection-column-title-body">type</div></div><div class="notion-collection-row-value"><span class="notion-property notion-property-select"></span></div></div><div class="notion-collection-row-property"><div class="notion-collection-column-title"><svg viewBox="0 0 14 14" class="notion-collection-column-title-icon"><path d="M7 13A6 6 0 107 1a6 6 0 000 12zM3.751 5.323A.2.2 0 013.909 5h6.182a.2.2 0 01.158.323L7.158 9.297a.2.2 0 01-.316 0L3.751 5.323z"></path></svg><div class="notion-collection-column-title-body">status</div></div><div class="notion-collection-row-value"><span class="notion-property notion-property-select"></span></div></div><div class="notion-collection-row-property"><div class="notion-collection-column-title"><svg viewBox="0 0 14 14" class="notion-collection-column-title-icon"><path d="M10.889 5.5H3.11v1.556h7.778V5.5zm1.555-4.444h-.777V0H10.11v1.056H3.89V0H2.333v1.056h-.777c-.864 0-1.548.7-1.548 1.555L0 12.5c0 .856.692 1.5 1.556 1.5h10.888C13.3 14 14 13.356 14 12.5V2.611c0-.855-.7-1.555-1.556-1.555zm0 11.444H1.556V3.944h10.888V12.5zM8.556 8.611H3.11v1.556h5.445V8.61z"></path></svg><div class="notion-collection-column-title-body">date</div></div><div class="notion-collection-row-value"><span class="notion-property notion-property-date"></span></div></div><div class="notion-collection-row-property"><div class="notion-collection-column-title"><svg viewBox="0 0 14 14" class="notion-collection-column-title-icon"><path d="M7 4.568a.5.5 0 00-.5-.5h-6a.5.5 0 00-.5.5v1.046a.5.5 0 00.5.5h6a.5.5 0 00.5-.5V4.568zM.5 1a.5.5 0 00-.5.5v1.045a.5.5 0 00.5.5h12a.5.5 0 00.5-.5V1.5a.5.5 0 00-.5-.5H.5zM0 8.682a.5.5 0 00.5.5h11a.5.5 0 00.5-.5V7.636a.5.5 0 00-.5-.5H.5a.5.5 0 00-.5.5v1.046zm0 3.068a.5.5 0 00.5.5h9a.5.5 0 00.5-.5v-1.045a.5.5 0 00-.5-.5h-9a.5.5 0 00-.5.5v1.045z"></path></svg><div class="notion-collection-column-title-body">slug</div></div><div class="notion-collection-row-value"><span class="notion-property notion-property-text"></span></div></div><div class="notion-collection-row-property"><div class="notion-collection-column-title"><svg viewBox="0 0 14 14" class="notion-collection-column-title-icon"><path d="M7 4.568a.5.5 0 00-.5-.5h-6a.5.5 0 00-.5.5v1.046a.5.5 0 00.5.5h6a.5.5 0 00.5-.5V4.568zM.5 1a.5.5 0 00-.5.5v1.045a.5.5 0 00.5.5h12a.5.5 0 00.5-.5V1.5a.5.5 0 00-.5-.5H.5zM0 8.682a.5.5 0 00.5.5h11a.5.5 0 00.5-.5V7.636a.5.5 0 00-.5-.5H.5a.5.5 0 00-.5.5v1.046zm0 3.068a.5.5 0 00.5.5h9a.5.5 0 00.5-.5v-1.045a.5.5 0 00-.5-.5h-9a.5.5 0 00-.5.5v1.045z"></path></svg><div class="notion-collection-column-title-body">summary</div></div><div class="notion-collection-row-value"><span class="notion-property notion-property-text"></span></div></div><div class="notion-collection-row-property"><div class="notion-collection-column-title"><svg viewBox="0 0 14 14" class="notion-collection-column-title-icon"><path d="M4 3a1 1 0 011-1h7a1 1 0 110 2H5a1 1 0 01-1-1zm0 4a1 1 0 011-1h7a1 1 0 110 2H5a1 1 0 01-1-1zm0 4a1 1 0 011-1h7a1 1 0 110 2H5a1 1 0 01-1-1zM2 4a1 1 0 110-2 1 1 0 010 2zm0 4a1 1 0 110-2 1 1 0 010 2zm0 4a1 1 0 110-2 1 1 0 010 2z"></path></svg><div class="notion-collection-column-title-body">tags</div></div><div class="notion-collection-row-value"><span class="notion-property notion-property-multi_select"></span></div></div><div class="notion-collection-row-property"><div class="notion-collection-column-title"><svg viewBox="0 0 14 14" class="notion-collection-column-title-icon"><path d="M7 13A6 6 0 107 1a6 6 0 000 12zM3.751 5.323A.2.2 0 013.909 5h6.182a.2.2 0 01.158.323L7.158 9.297a.2.2 0 01-.316 0L3.751 5.323z"></path></svg><div class="notion-collection-column-title-body">category</div></div><div class="notion-collection-row-value"><span class="notion-property notion-property-select"></span></div></div><div class="notion-collection-row-property"><div class="notion-collection-column-title"><svg viewBox="0 0 14 14" class="notion-collection-column-title-icon"><path d="M7 4.568a.5.5 0 00-.5-.5h-6a.5.5 0 00-.5.5v1.046a.5.5 0 00.5.5h6a.5.5 0 00.5-.5V4.568zM.5 1a.5.5 0 00-.5.5v1.045a.5.5 0 00.5.5h12a.5.5 0 00.5-.5V1.5a.5.5 0 00-.5-.5H.5zM0 8.682a.5.5 0 00.5.5h11a.5.5 0 00.5-.5V7.636a.5.5 0 00-.5-.5H.5a.5.5 0 00-.5.5v1.046zm0 3.068a.5.5 0 00.5.5h9a.5.5 0 00.5-.5v-1.045a.5.5 0 00-.5-.5h-9a.5.5 0 00-.5.5v1.045z"></path></svg><div class="notion-collection-column-title-body">icon</div></div><div class="notion-collection-row-value"><span class="notion-property notion-property-text"></span></div></div><div class="notion-collection-row-property"><div class="notion-collection-column-title"><svg viewBox="0 0 14 14" class="notion-collection-column-title-icon"><path d="M7 4.568a.5.5 0 00-.5-.5h-6a.5.5 0 00-.5.5v1.046a.5.5 0 00.5.5h6a.5.5 0 00.5-.5V4.568zM.5 1a.5.5 0 00-.5.5v1.045a.5.5 0 00.5.5h12a.5.5 0 00.5-.5V1.5a.5.5 0 00-.5-.5H.5zM0 8.682a.5.5 0 00.5.5h11a.5.5 0 00.5-.5V7.636a.5.5 0 00-.5-.5H.5a.5.5 0 00-.5.5v1.046zm0 3.068a.5.5 0 00.5.5h9a.5.5 0 00.5-.5v-1.045a.5.5 0 00-.5-.5h-9a.5.5 0 00-.5.5v1.045z"></path></svg><div class="notion-collection-column-title-body">password</div></div><div class="notion-collection-row-value"><span class="notion-property notion-property-text"></span></div></div></div></div></div><h3 class="notion-h notion-h2 notion-h-indent-0 notion-block-82c80c1768ab4b4abd3706859f2bf09a" data-id="82c80c1768ab4b4abd3706859f2bf09a"><span><div id="82c80c1768ab4b4abd3706859f2bf09a" class="notion-header-anchor"></div><a class="notion-hash-link" href="#82c80c1768ab4b4abd3706859f2bf09a" title="控制流平坦化是什么"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">控制流平坦化是什么</span></span></h3><blockquote class="notion-quote notion-block-e29c1f508b7c4067813de5de85c60e9a"><div>控制流平坦化指的是将正常控制流中基本块之间的跳转关系删除，用一个集中
的分发块来调度基本块的执行顺序
</div></blockquote><div class="notion-text notion-block-d12ca3c22a7a49f79e2988062e0aa8d2">如图所示，右边的图就是通过控制流平坦化实现的（因为看起来很平坦，所以被称为控制流平坦化）</div><div class="notion-blank notion-block-7490f0bc0c664beeab0cafa11469abec"> </div><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-154e85d9a7a244029a45adc47c1cda8e"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column"><img src="https://thestar0-1308426403.cos.ap-chengdu.myqcloud.com/img/20221220181333.png?spaceId=0dd8935a-39f8-4c94-aaf7-d2de23196366&amp;t=154e85d9-a7a2-4402-9a45-adc47c1cda8e" alt="notion image" loading="lazy" decoding="async"/></div></figure><h4 class="notion-h notion-h3 notion-h-indent-1 notion-block-d22c5e1e249142f58501e9f0c7555745" data-id="d22c5e1e249142f58501e9f0c7555745"><span><div id="d22c5e1e249142f58501e9f0c7555745" class="notion-header-anchor"></div><a class="notion-hash-link" href="#d22c5e1e249142f58501e9f0c7555745" title="控制流平坦化流程结构"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">控制流平坦化流程结构</span></span></h4><div class="notion-text notion-block-05e5ed4138d74782be652c1bccbd8350">大致分为四个结构</div><ol start="1" class="notion-list notion-list-numbered notion-block-889ac16cf4b04902ae844117bdbc91f7" style="list-style-type:decimal"><li>入口块（进入函数第一个执行的基本块）</li></ol><ol start="2" class="notion-list notion-list-numbered notion-block-393bc37dec4a4a43ad5dccc578be8788" style="list-style-type:decimal"><li>主分发块与子分发块（：负责跳转到下一个要执
行的原基本块）</li></ol><ol start="3" class="notion-list notion-list-numbered notion-block-5f063915141c46ff89909a74d4ffa08b" style="list-style-type:decimal"><li>原基本块（混淆之前的基本块，真正完成程序工
作的基本块）</li></ol><ol start="4" class="notion-list notion-list-numbered notion-block-7c5be21e824c47b782ab296a50dd684f" style="list-style-type:decimal"><li>返回块（返回到主分发块）</li></ol><div class="notion-text notion-block-6aac4faebc29447791629bf84a9d5593"><div class="notion-text-children"><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-68ff7bb006ee44589471265b87ca732e"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column"><img src="https://thestar0-1308426403.cos.ap-chengdu.myqcloud.com/img/20221220181632.png?spaceId=0dd8935a-39f8-4c94-aaf7-d2de23196366&amp;t=68ff7bb0-06ee-4458-9471-265b87ca732e" alt="notion image" loading="lazy" decoding="async"/></div></figure></div></div><h4 class="notion-h notion-h3 notion-h-indent-1 notion-block-4e2c97c2931a463fb1011221548c6309" data-id="4e2c97c2931a463fb1011221548c6309"><span><div id="4e2c97c2931a463fb1011221548c6309" class="notion-header-anchor"></div><a class="notion-hash-link" href="#4e2c97c2931a463fb1011221548c6309" title="程序流程混淆效果"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">程序流程混淆效果</span></span></h4><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-5caa184aab4a47df932bbd408352b93e"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column"><img src="https://thestar0-1308426403.cos.ap-chengdu.myqcloud.com/img/20221220181811.png?spaceId=0dd8935a-39f8-4c94-aaf7-d2de23196366&amp;t=5caa184a-ab4a-47df-932b-bd408352b93e" alt="notion image" loading="lazy" decoding="async"/></div></figure><ul class="notion-list notion-list-disc notion-block-2bcaafd7714b408ea1c3648e6d84febf"><li>当我们分析正常的控制流时，我们能很容易的分析出程序的执行顺序，以及每一段代码完成的工作如何执行（一段代码可能由多个互相关联的基本块组成），进而掌握整个程序的逻辑</li></ul><ul class="notion-list notion-list-disc notion-block-9c4638f25db4465a9e577b7e5585411e"><li>当我们分析平坦化后的控制流时，在不知道基本块执行顺序的情况下，分别对每一个基本块进行分析是很难的，而如果要得知每一个基本块的执行顺序，必须分析分发块的调度逻辑</li></ul><ul class="notion-list notion-list-disc notion-block-144fc6dc7c0a4ea6b71ad535c100c6f8"><li>在实际分析中当函数比较复杂的时候，通过手动分析分发块还原原基本块的执行顺序是非常复杂的（比如上面这个图）</li></ul><h4 class="notion-h notion-h3 notion-h-indent-1 notion-block-54b3f765d72b4f2a82de1a90d0c86381" data-id="54b3f765d72b4f2a82de1a90d0c86381"><span><div id="54b3f765d72b4f2a82de1a90d0c86381" class="notion-header-anchor"></div><a class="notion-hash-link" href="#54b3f765d72b4f2a82de1a90d0c86381" title="程序代码混淆效果"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">程序代码混淆效果</span></span></h4><div class="notion-text notion-block-d3baf78811e8421eb19ceb5014efce57">控制流平坦化混淆后的伪代码，while + switch 结构对应平坦化后的控制流代码结构</div><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-194ece73097c4b8f854b3d93ce61ee06"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column"><img src="https://thestar0-1308426403.cos.ap-chengdu.myqcloud.com/img/20221220183924.png?spaceId=0dd8935a-39f8-4c94-aaf7-d2de23196366&amp;t=194ece73-097c-4b8f-854b-3d93ce61ee06" alt="notion image" loading="lazy" decoding="async"/></div></figure><h3 class="notion-h notion-h2 notion-h-indent-0 notion-block-a2a739778c8041fab819ffa8fbf53d94" data-id="a2a739778c8041fab819ffa8fbf53d94"><span><div id="a2a739778c8041fab819ffa8fbf53d94" class="notion-header-anchor"></div><a class="notion-hash-link" href="#a2a739778c8041fab819ffa8fbf53d94" title="代码实现"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">代码实现</span></span></h3><h4 class="notion-h notion-h3 notion-h-indent-1 notion-block-332bbbad6e8c4fc2889497f6dab30020" data-id="332bbbad6e8c4fc2889497f6dab30020"><span><div id="332bbbad6e8c4fc2889497f6dab30020" class="notion-header-anchor"></div><a class="notion-hash-link" href="#332bbbad6e8c4fc2889497f6dab30020" title="实现步骤"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">实现步骤</span></span></h4><div class="notion-text notion-block-85595a016bfb4235a0fd84529741be96">大致分为 5 步</div><ol start="1" class="notion-list notion-list-numbered notion-block-ce5daa84f04d4b09af96a4591706d59c" style="list-style-type:decimal"><li>保存原基本块</li></ol><ol start="2" class="notion-list notion-list-numbered notion-block-c749b3216a8749649d565e591d7b258d" style="list-style-type:decimal"><li>创建分发块和返回块</li></ol><ol start="3" class="notion-list notion-list-numbered notion-block-2f5b5e04a7f64274b440d6edaadb2082" style="list-style-type:decimal"><li>实现分发块调度</li></ol><ol start="4" class="notion-list notion-list-numbered notion-block-be88c4b42b0c4d9a8aed032e7caccb51" style="list-style-type:decimal"><li>实现调度变量自动调整</li></ol><ol start="5" class="notion-list notion-list-numbered notion-block-08f9b1b0dd154c6abdcaa63f427c0c08" style="list-style-type:decimal"><li>修复 PHI 指令和逃逸变量</li></ol><h4 class="notion-h notion-h3 notion-h-indent-1 notion-block-bb2468a1297749efa1e507e2c69845c4" data-id="bb2468a1297749efa1e507e2c69845c4"><span><div id="bb2468a1297749efa1e507e2c69845c4" class="notion-header-anchor"></div><a class="notion-hash-link" href="#bb2468a1297749efa1e507e2c69845c4" title="保存原基本块"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">保存原基本块</span></span></h4><ul class="notion-list notion-list-disc notion-block-6a67c94acc8c498db2a72ca3b058bfb4"><li>将除入口块以外的以外的基本块保存到 vector 容器中，方便后续处理（原因可以看上一篇的 LLVM 基本块分割里面说的有）</li></ul><ul class="notion-list notion-list-disc notion-block-a0a5b6f6d7c8446ebde2f0b74986a766"><li>如果入口块的终结指令是条件分支指令，则将该指令单独分离出来作为一个基本块，加入到 vector 容器的最前面</li></ul><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-01930e26c6c047ca924525cd699354d4"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column"><img src="https://thestar0-1308426403.cos.ap-chengdu.myqcloud.com/img/20221220184408.png?spaceId=0dd8935a-39f8-4c94-aaf7-d2de23196366&amp;t=01930e26-c6c0-47ca-9245-25cd699354d4" alt="notion image" loading="lazy" decoding="async"/></div></figure><div class="notion-text notion-block-03cc19778bc24e8eaa905c5c3c6e50f0">代码实现：</div><h4 class="notion-h notion-h3 notion-h-indent-1 notion-block-84ca54d8ccf84109a529e4df2bdb21e0" data-id="84ca54d8ccf84109a529e4df2bdb21e0"><span><div id="84ca54d8ccf84109a529e4df2bdb21e0" class="notion-header-anchor"></div><a class="notion-hash-link" href="#84ca54d8ccf84109a529e4df2bdb21e0" title="创建分发块和返回块"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">创建分发块和返回块</span></span></h4><ul class="notion-list notion-list-disc notion-block-61026fe8c3704250b502847027f4bb62"><li>除了原基本块之外，我们还要续创建一个分发块来调度基本块的执行顺序。并建立入口块到分发块的绝对跳转。</li></ul><ul class="notion-list notion-list-disc notion-block-c34a17593e9f4227b48d75d36e833495"><li>再创建一个返回块，原基本块执行完后都需要跳转到这个返回块，返回块会直接跳转到分发块。</li></ul><div class="notion-text notion-block-dfa13954d40a4c9e9f20a61f5b303f60"><div class="notion-text-children"><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-a3b6b96dde2d480480fbe5e3837b27fd"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column"><img src="https://thestar0-1308426403.cos.ap-chengdu.myqcloud.com/img/20221220211351.png?spaceId=0dd8935a-39f8-4c94-aaf7-d2de23196366&amp;t=a3b6b96d-de2d-4804-80fb-e5e3837b27fd" alt="notion image" loading="lazy" decoding="async"/></div></figure></div></div><div class="notion-text notion-block-cb9e79ed44fd42fe8d0f36fe034c53ea">代码实现：</div><h4 class="notion-h notion-h3 notion-h-indent-1 notion-block-da03cb6cfac547a790c12c14f34a63ae" data-id="da03cb6cfac547a790c12c14f34a63ae"><span><div id="da03cb6cfac547a790c12c14f34a63ae" class="notion-header-anchor"></div><a class="notion-hash-link" href="#da03cb6cfac547a790c12c14f34a63ae" title="实现分发块调度"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">实现分发块调度</span></span></h4><ul class="notion-list notion-list-disc notion-block-417d2443f9de42ada9276a2d9385c1d8"><li>在入口块中创建并初始化 switch 变量，在调度块中插入 switch 指令实现分发功能</li></ul><ul class="notion-list notion-list-disc notion-block-438bab14ab064e0aaaa1ed43a9045980"><li>将原基本块移动到返回块之前，并分配随机的 case 值，并将其添加到 switch 指令的分支中</li></ul><div class="notion-text notion-block-a6fe75c447974418a6899c42dad66550"><div class="notion-text-children"><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-52f52e5004484f5fb8edfd42b246105a"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column"><img src="https://thestar0-1308426403.cos.ap-chengdu.myqcloud.com/img/20221220211610.png?spaceId=0dd8935a-39f8-4c94-aaf7-d2de23196366&amp;t=52f52e50-0448-4f5f-b8ed-fd42b246105a" alt="notion image" loading="lazy" decoding="async"/></div></figure></div></div><div class="notion-text notion-block-33dc07cfd09a487682630951ee7b4261">代码实现：</div><h4 class="notion-h notion-h3 notion-h-indent-1 notion-block-35c1b440a2d94f71a4171ec92bab4e22" data-id="35c1b440a2d94f71a4171ec92bab4e22"><span><div id="35c1b440a2d94f71a4171ec92bab4e22" class="notion-header-anchor"></div><a class="notion-hash-link" href="#35c1b440a2d94f71a4171ec92bab4e22" title="实现调度变量自动调整"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">实现调度变量自动调整</span></span></h4><ul class="notion-list notion-list-disc notion-block-94acd58cfb0d4ff68b4328926c2d7d70"><li>在每个原基本块最后添加修改 switch 变量值的指令，以便返回分发块之后，能够正确执行到下一个基本块</li></ul><ul class="notion-list notion-list-disc notion-block-5523909136bd4553a546a9625bcc8a0e"><li>删除原基本块末尾的跳转，使其结束执行后跳转到返回块</li><ul class="notion-list notion-list-disc notion-block-5523909136bd4553a546a9625bcc8a0e"><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-43d8718bb696403d969850d4104ab1b5"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column"><img src="https://thestar0-1308426403.cos.ap-chengdu.myqcloud.com/img/20221221015624.png?spaceId=0dd8935a-39f8-4c94-aaf7-d2de23196366&amp;t=43d8718b-b696-403d-9698-50d4104ab1b5" alt="notion image" loading="lazy" decoding="async"/></div></figure></ul></ul><div class="notion-text notion-block-8bd0478ac6974510aa2879842bfbd2b9">代码实现：</div><h4 class="notion-h notion-h3 notion-h-indent-1 notion-block-ccf237bc331b4ed485f5be7db169ac0c" data-id="ccf237bc331b4ed485f5be7db169ac0c"><span><div id="ccf237bc331b4ed485f5be7db169ac0c" class="notion-header-anchor"></div><a class="notion-hash-link" href="#ccf237bc331b4ed485f5be7db169ac0c" title="修复 PHI 指令和逃逸变量"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">修复 PHI 指令和逃逸变量</span></span></h4><ul class="notion-list notion-list-disc notion-block-011de2298d9142d2826b93c82bbfbb4c"><li>PHI 指令的值由前驱块决定，平坦化后所有原基本块的前驱块都变成了分发块，因此 PHI 指令发生了损坏</li></ul><ul class="notion-list notion-list-disc notion-block-d2a9d47e127c46688e440482f8021f0c"><li>逃逸变量指在一个基本块中定义，并且在另一个基本块被引用的变量。在原程序中某些基本块可能引用之前某个基本块中的变量，平坦化后原基本块之间不存在确定的前后关系了（由分发块决定），因此某些变量的引用可能会损坏</li></ul><ul class="notion-list notion-list-disc notion-block-94fc5a13aa574a778ec73bb54dab69f0"><li>修复的方法是，将 PHI 指令和逃逸变量都转化为内存存取指令</li></ul><div class="notion-text notion-block-3dde32d05da3468cbfa8701cd880d416">代码实现：</div><h3 class="notion-h notion-h2 notion-h-indent-0 notion-block-2c64046209a94c6c8097045a95834ae4" data-id="2c64046209a94c6c8097045a95834ae4"><span><div id="2c64046209a94c6c8097045a95834ae4" class="notion-header-anchor"></div><a class="notion-hash-link" href="#2c64046209a94c6c8097045a95834ae4" title="最终效果"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">最终效果</span></span></h3><div class="notion-text notion-block-4ea06b32c1c34343b478f422857256f3">没有加基本块分割实现的控制流平坦化</div><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-c589226ac757484bbe2603130c7d8419"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%"><img style="object-fit:cover" src="https://www.notion.so/image/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F23afbb92-8e3f-40f0-81d4-1a4dff45b70d%2FUntitled.png?table=block&amp;id=c589226a-c757-484b-be26-03130c7d8419&amp;t=c589226a-c757-484b-be26-03130c7d8419&amp;width=605.9921875&amp;cache=v2" alt="notion image" loading="lazy" decoding="async"/></div></figure><div class="notion-text notion-block-2f70a65dbfd2409f99ffa8cff19a6783">加了基本块分割后</div><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-679419083b7e4218b28a06022083e658"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%"><img style="object-fit:cover" src="https://www.notion.so/image/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F12736e73-db51-46d8-b1fe-e2ff652ebe15%2FUntitled.png?table=block&amp;id=67941908-3b7e-4218-b28a-06022083e658&amp;t=67941908-3b7e-4218-b28a-06022083e658&amp;width=605.984375&amp;cache=v2" alt="notion image" loading="lazy" decoding="async"/></div></figure><div class="notion-blank notion-block-0f1bbb933f594b2e9196f0ba0b11fdce"> </div><div class="notion-blank notion-block-d89401693dff4b42ace92f93cf4c65c4"> </div><h3 class="notion-h notion-h2 notion-h-indent-0 notion-block-10691449c48d4e68bd9051cd0b4b9ef6" data-id="10691449c48d4e68bd9051cd0b4b9ef6"><span><div id="10691449c48d4e68bd9051cd0b4b9ef6" class="notion-header-anchor"></div><a class="notion-hash-link" href="#10691449c48d4e68bd9051cd0b4b9ef6" title="参考于"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">参考于</span></span></h3><div class="notion-row"><a target="_blank" rel="noopener noreferrer" class="notion-bookmark notion-block-f551174d597c4740abef8a785c841a85" href="https://www.kanxue.com/book-section_list-88.htm"><div><div class="notion-bookmark-title">LLVM与代码混淆技术 - Android - 看雪学苑-看雪-安全培训|安全招聘|www.kanxue.com</div><div class="notion-bookmark-description">LLVM与代码混淆技术 - 看雪学苑-看雪-安全培训|安全招聘|www.kanxue.com</div><div class="notion-bookmark-link"><div class="notion-bookmark-link-icon"><img src="https://www.notion.so/image/https%3A%2F%2Fwww.kanxue.com%2Fview%2Fimg%2Ffavicon.ico?table=block&amp;id=f551174d-597c-4740-abef-8a785c841a85&amp;t=f551174d-597c-4740-abef-8a785c841a85" alt="LLVM与代码混淆技术 - Android - 看雪学苑-看雪-安全培训|安全招聘|www.kanxue.com" loading="lazy" decoding="async"/></div><div class="notion-bookmark-link-text">https://www.kanxue.com/book-section_list-88.htm</div></div></div><div class="notion-bookmark-image"><img style="object-fit:cover" src="https://www.notion.so/image/https%3A%2F%2Fwww.kanxue.com%2Fupload%2Fbrief%2F195.png?table=block&amp;id=f551174d-597c-4740-abef-8a785c841a85&amp;t=f551174d-597c-4740-abef-8a785c841a85" alt="LLVM与代码混淆技术 - Android - 看雪学苑-看雪-安全培训|安全招聘|www.kanxue.com" loading="lazy" decoding="async"/></div></a></div></main></div></div><div id="comment" class="comment mt-5 text-gray-800 dark:text-gray-300 "><div class="text-center">Loading...<i class="fas fa-spinner animate-spin text-3xl "></i></div></div><div class="flex justify-between font-medium text-gray-500 dark:text-gray-400"><a><button class="mt-2 cursor-pointer hover:text-black dark:hover:text-gray-100">← <!-- -->返回上页</button></a><a><button class="mt-2 cursor-pointer hover:text-black dark:hover:text-gray-100">↑ <!-- -->回到顶部</button></a></div></div><div class="hidden lg:block absolute right-0 top-0 -mr-96 h-full"><div class="px-3 sticky top-32"><div class="pl-10 mt-32 overflow-y-auto max-w-96  max-h-96 overscroll-none scroll-hidden"><nav class="h-full text-black dark:text-gray-300"><a href="#82c80c1768ab4b4abd3706859f2bf09a" class="false hover:font-semibold border-l pl-4 block hover:text-gray-800 border-lduration-300 transform dark:text-gray-400 dark:border-gray-400
              notion-table-of-contents-item-indent-level-0 catalog-item "><span style="display:inline-block;margin-left:0" class="truncate ">控制流平坦化是什么</span></a><a href="#d22c5e1e249142f58501e9f0c7555745" class="false hover:font-semibold border-l pl-4 block hover:text-gray-800 border-lduration-300 transform dark:text-gray-400 dark:border-gray-400
              notion-table-of-contents-item-indent-level-1 catalog-item "><span style="display:inline-block;margin-left:16px" class="truncate ">控制流平坦化流程结构</span></a><a href="#4e2c97c2931a463fb1011221548c6309" class="false hover:font-semibold border-l pl-4 block hover:text-gray-800 border-lduration-300 transform dark:text-gray-400 dark:border-gray-400
              notion-table-of-contents-item-indent-level-1 catalog-item "><span style="display:inline-block;margin-left:16px" class="truncate ">程序流程混淆效果</span></a><a href="#54b3f765d72b4f2a82de1a90d0c86381" class="false hover:font-semibold border-l pl-4 block hover:text-gray-800 border-lduration-300 transform dark:text-gray-400 dark:border-gray-400
              notion-table-of-contents-item-indent-level-1 catalog-item "><span style="display:inline-block;margin-left:16px" class="truncate ">程序代码混淆效果</span></a><a href="#a2a739778c8041fab819ffa8fbf53d94" class="false hover:font-semibold border-l pl-4 block hover:text-gray-800 border-lduration-300 transform dark:text-gray-400 dark:border-gray-400
              notion-table-of-contents-item-indent-level-0 catalog-item "><span style="display:inline-block;margin-left:0" class="truncate ">代码实现</span></a><a href="#332bbbad6e8c4fc2889497f6dab30020" class="false hover:font-semibold border-l pl-4 block hover:text-gray-800 border-lduration-300 transform dark:text-gray-400 dark:border-gray-400
              notion-table-of-contents-item-indent-level-1 catalog-item "><span style="display:inline-block;margin-left:16px" class="truncate ">实现步骤</span></a><a href="#bb2468a1297749efa1e507e2c69845c4" class="false hover:font-semibold border-l pl-4 block hover:text-gray-800 border-lduration-300 transform dark:text-gray-400 dark:border-gray-400
              notion-table-of-contents-item-indent-level-1 catalog-item "><span style="display:inline-block;margin-left:16px" class="truncate ">保存原基本块</span></a><a href="#84ca54d8ccf84109a529e4df2bdb21e0" class="false hover:font-semibold border-l pl-4 block hover:text-gray-800 border-lduration-300 transform dark:text-gray-400 dark:border-gray-400
              notion-table-of-contents-item-indent-level-1 catalog-item "><span style="display:inline-block;margin-left:16px" class="truncate ">创建分发块和返回块</span></a><a href="#da03cb6cfac547a790c12c14f34a63ae" class="false hover:font-semibold border-l pl-4 block hover:text-gray-800 border-lduration-300 transform dark:text-gray-400 dark:border-gray-400
              notion-table-of-contents-item-indent-level-1 catalog-item "><span style="display:inline-block;margin-left:16px" class="truncate ">实现分发块调度</span></a><a href="#35c1b440a2d94f71a4171ec92bab4e22" class="false hover:font-semibold border-l pl-4 block hover:text-gray-800 border-lduration-300 transform dark:text-gray-400 dark:border-gray-400
              notion-table-of-contents-item-indent-level-1 catalog-item "><span style="display:inline-block;margin-left:16px" class="truncate ">实现调度变量自动调整</span></a><a href="#ccf237bc331b4ed485f5be7db169ac0c" class="false hover:font-semibold border-l pl-4 block hover:text-gray-800 border-lduration-300 transform dark:text-gray-400 dark:border-gray-400
              notion-table-of-contents-item-indent-level-1 catalog-item "><span style="display:inline-block;margin-left:16px" class="truncate ">修复 PHI 指令和逃逸变量</span></a><a href="#2c64046209a94c6c8097045a95834ae4" class="false hover:font-semibold border-l pl-4 block hover:text-gray-800 border-lduration-300 transform dark:text-gray-400 dark:border-gray-400
              notion-table-of-contents-item-indent-level-0 catalog-item "><span style="display:inline-block;margin-left:0" class="truncate ">最终效果</span></a><a href="#10691449c48d4e68bd9051cd0b4b9ef6" class="false hover:font-semibold border-l pl-4 block hover:text-gray-800 border-lduration-300 transform dark:text-gray-400 dark:border-gray-400
              notion-table-of-contents-item-indent-level-0 catalog-item "><span style="display:inline-block;margin-left:0" class="truncate ">参考于</span></a></nav></div></div></div></div></main><footer class="z-10 relative mt-6 flex-shrink-0 m-auto w-full text-gray-500 dark:text-gray-400 transition-all max-w-2xl px-4"><div class="text-center py-4 flex justify-center dark:text-gray-200 text-gray-800"><div id="darkModeButton" class=" hover:scale-110 cursor-pointer transform duration-200 w-5 h-5"> <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21.752 15.002A9.718 9.718 0 0118 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 003 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 009.002-5.998z"></path></svg></div></div><hr class="border-gray-200 dark:border-gray-600"/><div class="my-4 text-sm leading-6"><div class="flex align-baseline justify-between flex-wrap"><p>© <!-- -->thestar<!-- --> <!-- -->2021-2025</p><a href="https://vercel.com?utm_source=Craigary&amp;utm_campaign=oss" target="_blank" rel="noreferrer" aria-label="Vercel"><svg width="135" height="28" viewBox="0 0 135 28" fill="none" xmlns="http://www.w3.org/2000/svg" class="inline-block"><g clip-path="url(#clip0)"><path d="M129.818 0H5.09091C2.27928 0 0 2.27928 0 5.09091V22.9091C0 25.7207 2.27928 28 5.09091 28H129.818C132.63 28 134.909 25.7207 134.909 22.9091V5.09091C134.909 2.27928 132.63 0 129.818 0Z" fill="black"></path><path d="M38.4601 9.68997V16.8639H39.355V14.3036H41.1597C42.507 14.3036 43.4665 13.354 43.4665 12.0117C43.4665 10.6445 42.5268 9.68997 41.1696 9.68997H38.4601ZM39.355 10.4854H40.9359C41.975 10.4854 42.5467 11.0273 42.5467 12.0117C42.5467 12.9613 41.9551 13.5081 40.9359 13.5081H39.355V10.4854ZM46.6734 16.9584C48.1996 16.9584 49.1442 15.9044 49.1442 14.1843C49.1442 12.4591 48.1996 11.4101 46.6734 11.4101C45.1471 11.4101 44.2025 12.4591 44.2025 14.1843C44.2025 15.9044 45.1471 16.9584 46.6734 16.9584ZM46.6734 16.1878C45.6591 16.1878 45.0874 15.452 45.0874 14.1843C45.0874 12.9116 45.6591 12.1807 46.6734 12.1807C47.6875 12.1807 48.2593 12.9116 48.2593 14.1843C48.2593 15.452 47.6875 16.1878 46.6734 16.1878ZM56.8255 11.5046H55.9654L54.9115 15.7901H54.8319L53.6338 11.5046H52.8135L51.6153 15.7901H51.5358L50.4818 11.5046H49.6167L51.1182 16.8639H51.9832L53.1764 12.7177H53.2559L54.4541 16.8639H55.3241L56.8255 11.5046ZM59.7043 12.1658C60.5544 12.1658 61.1212 12.7922 61.1411 13.7418H58.1879C58.2526 12.7922 58.8492 12.1658 59.7043 12.1658ZM61.1162 15.4769C60.8925 15.9492 60.4252 16.2027 59.7341 16.2027C58.8243 16.2027 58.2327 15.5315 58.1879 14.4726V14.4328H62.0409V14.1047C62.0409 12.4392 61.161 11.4101 59.7142 11.4101C58.2427 11.4101 57.298 12.5038 57.298 14.1892C57.298 15.8845 58.2277 16.9584 59.7142 16.9584C60.8875 16.9584 61.7227 16.3916 61.9714 15.4769H61.1162ZM63.1796 16.8639H64.0346V13.5429C64.0346 12.7873 64.6264 12.2404 65.4416 12.2404C65.6109 12.2404 65.9189 12.2702 65.9889 12.2901V11.435C65.8794 11.42 65.6999 11.4101 65.5612 11.4101C64.8504 11.4101 64.2338 11.778 64.0747 12.3H63.9951V11.5046H63.1796V16.8639ZM68.8423 12.1658C69.6925 12.1658 70.2595 12.7922 70.2792 13.7418H67.3259C67.3908 12.7922 67.9877 12.1658 68.8423 12.1658ZM70.2544 15.4769C70.0304 15.9492 69.5633 16.2027 68.8722 16.2027C67.9622 16.2027 67.371 15.5315 67.3259 14.4726V14.4328H71.179V14.1047C71.179 12.4392 70.2989 11.4101 68.8525 11.4101C67.3806 11.4101 66.4362 12.5038 66.4362 14.1892C66.4362 15.8845 67.3659 16.9584 68.8525 16.9584C70.0259 16.9584 70.8609 16.3916 71.1097 15.4769H70.2544ZM74.3017 16.9584C75.0424 16.9584 75.6788 16.6055 76.0167 16.0088H76.0962V16.8639H76.9114V9.37675H76.0568V12.3497H75.9817C75.6788 11.7631 75.0475 11.4101 74.3017 11.4101C72.9392 11.4101 72.0496 12.5038 72.0496 14.1843C72.0496 15.8696 72.929 16.9584 74.3017 16.9584ZM74.5002 12.1807C75.47 12.1807 76.0765 12.9563 76.0765 14.1843C76.0765 15.4222 75.4745 16.1878 74.5002 16.1878C73.5209 16.1878 72.9341 15.4371 72.9341 14.1843C72.9341 12.9364 73.5259 12.1807 74.5002 12.1807ZM83.7033 16.9584C85.0607 16.9584 85.9503 15.8597 85.9503 14.1843C85.9503 12.4989 85.0651 11.4101 83.7033 11.4101C82.9677 11.4101 82.316 11.773 82.0227 12.3497H81.9431V9.37675H81.0879V16.8639H81.9037V16.0088H81.9832C82.3211 16.6055 82.9575 16.9584 83.7033 16.9584ZM83.5041 12.1807C84.4835 12.1807 85.0651 12.9314 85.0651 14.1843C85.0651 15.4371 84.4835 16.1878 83.5041 16.1878C82.5299 16.1878 81.9234 15.4222 81.9234 14.1843C81.9234 12.9464 82.5299 12.1807 83.5041 12.1807ZM87.3478 18.8029C88.2972 18.8029 88.7249 18.435 89.1818 17.1921L91.2754 11.5046H90.3654L88.8986 15.9144H88.819L87.3478 11.5046H86.4231L88.4067 16.8689L88.3068 17.1871C88.0834 17.8334 87.8149 18.0671 87.3229 18.0671C87.2033 18.0671 87.069 18.0621 86.9647 18.0422V18.773C87.0843 18.7929 87.2332 18.8029 87.3478 18.8029ZM98.4148 16.8639L100.895 9.68997H99.5284L97.7383 15.3675H97.6543L95.8496 9.68997H94.4324L96.9384 16.8639H98.4148ZM103.516 12.295C104.257 12.295 104.744 12.8121 104.769 13.6175H102.208C102.263 12.822 102.78 12.295 103.516 12.295ZM104.778 15.3675C104.6 15.7702 104.177 15.9939 103.565 15.9939C102.755 15.9939 102.233 15.4272 102.203 14.5223V14.4577H106.001V14.06C106.001 12.3447 105.072 11.3156 103.521 11.3156C101.945 11.3156 100.965 12.4144 100.965 14.1644C100.965 15.9144 101.93 16.9733 103.53 16.9733C104.813 16.9733 105.723 16.3568 105.947 15.3675H104.778ZM107.036 16.8639H108.269V13.7219C108.269 12.9613 108.826 12.4641 109.626 12.4641C109.835 12.4641 110.163 12.4989 110.257 12.5337V11.3902C110.143 11.3555 109.924 11.3355 109.745 11.3355C109.045 11.3355 108.458 11.7333 108.308 12.2702H108.224V11.425H107.036V16.8639ZM115.627 13.2546C115.498 12.1111 114.652 11.3156 113.255 11.3156C111.62 11.3156 110.66 12.3647 110.66 14.1296C110.66 15.9193 111.625 16.9733 113.26 16.9733C114.638 16.9733 115.493 16.2077 115.627 15.0692H114.454C114.324 15.636 113.897 15.9392 113.255 15.9392C112.415 15.9392 111.908 15.273 111.908 14.1296C111.908 13.001 112.41 12.3497 113.255 12.3497C113.932 12.3497 114.339 12.7276 114.454 13.2546H115.627ZM118.883 12.295C119.624 12.295 120.112 12.8121 120.136 13.6175H117.576C117.63 12.822 118.148 12.295 118.883 12.295ZM120.147 15.3675C119.967 15.7702 119.545 15.9939 118.933 15.9939C118.123 15.9939 117.601 15.4272 117.571 14.5223V14.4577H121.369V14.06C121.369 12.3447 120.439 11.3156 118.888 11.3156C117.312 11.3156 116.333 12.4144 116.333 14.1644C116.333 15.9144 117.298 16.9733 118.899 16.9733C120.181 16.9733 121.091 16.3568 121.314 15.3675H120.147ZM122.453 16.8639H123.686V9.32202H122.453V16.8639Z" fill="white"></path><path d="M14.8431 8.27271L20.7772 18.4545H8.90918L14.8431 8.27271Z" fill="white"></path><path d="M27.6819 0V28" stroke="#5E5E5E" stroke-width="0.636364"></path></g><defs><clipPath id="clip0"><rect width="134.909" height="28" fill="white"></rect></clipPath></defs></svg></a></div></div></footer><div class="fixed right-4 bottom-4"><div title="回到顶部" class="cursor-pointer p-2 text-center"><i class="fas fa-angle-up text-2xl"></i></div></div><div class="bottom-4 -left-14 fixed justify-end z-40"></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"NOTION_CONFIG":{"CUSTOM_MENU":true},"notice":null,"siteInfo":{"title":"thestar的博客","description":"记录所思","pageCover":"https://www.notion.so/image/attachment%3Ade44147d-4cdf-48f2-8ff9-2a64437e928b%3AUntitled.png?table=collection\u0026id=210b67db-fc9a-8121-bebe-000bb39448db\u0026t=210b67db-fc9a-8121-bebe-000bb39448db","icon":"notion://custom_emoji/0dd8935a-39f8-4c94-aaf7-d2de23196366/225b67db-fc9a-80fe-9e2f-007add087083?t=210b67db-fc9a-8121-bebe-000bb39448db","link":"https://thestar0.github.io/"},"allNavPages":[{"title":"帆软ReportServer RCE漏洞复现 （CNVD-2024-33679）","pageCoverThumbnail":"","category":"漏洞分析","tags":null,"summary":null,"slug":"article/2025/11/15/274b67db-fc9a-80ee-96bc-cd2f7ebbb79b","href":"/article/2025/11/15/274b67db-fc9a-80ee-96bc-cd2f7ebbb79b","pageIcon":"","lastEditedDate":"2025-11-30T13:12:16.624Z","publishDate":1763164800000,"ext":{},"short_id":"80ee-96bc-cd2f7ebbb79b"},{"title":"契约锁-dbtest接口JDBC反序列化漏洞复现","pageCoverThumbnail":"","category":"漏洞分析","tags":["JDBC反序列化漏洞","契约锁"],"summary":null,"slug":"article/2025/06/12/20fb67db-fc9a-8088-9172-e2de1af90222","href":"/article/2025/06/12/20fb67db-fc9a-8088-9172-e2de1af90222","pageIcon":"","lastEditedDate":"2025-10-13T12:34:56.746Z","publishDate":1749772800000,"ext":{},"short_id":"8088-9172-e2de1af90222"}],"tagOptions":[{"name":"JDBC反序列化漏洞","color":"gray","count":1},{"name":"契约锁","color":"brown","count":1}],"categoryOptions":[{"name":"漏洞分析","color":"green","count":2}],"customNav":[],"customMenu":[{"icon":"fas fa-home","date":{"start_date":"2023-03-23"},"type":"Menu","slug":"/","summary":"跳转到首页/ 的菜单","title":"首页","status":"Published","category":"","comment":"","publishDate":1679529600000,"publishDay":"2023-3-23","lastEditedDate":"2025-11-30T05:31:20.657Z","lastEditedDay":"2025-11-30","fullWidth":false,"pageIcon":"","pageCover":"","pageCoverThumbnail":"","ext":{},"tagItems":[],"href":"/","name":"首页","target":"_blank","password":"","show":true},{"icon":"fas fa-clock-rotate-left","date":{"start_date":"2021-07-02"},"type":"Menu","slug":"/archive","title":"历史归档","status":"Published","category":"","comment":"","publishDate":1625184000000,"publishDay":"2021-7-2","lastEditedDate":"2025-09-10T15:29:46.255Z","lastEditedDay":"2025-9-10","fullWidth":false,"pageIcon":"🗒️","pageCover":"","pageCoverThumbnail":"","ext":{},"tagItems":[],"href":"/archive","name":"历史归档","target":"_self","password":"","show":true},{"icon":"fas fa-tag","date":{"start_date":"2021-07-02"},"type":"Menu","slug":"/tag","title":"文章标签","status":"Published","category":"","comment":"","publishDate":1625184000000,"publishDay":"2021-7-2","lastEditedDate":"2025-09-10T15:29:46.255Z","lastEditedDay":"2025-9-10","fullWidth":false,"pageIcon":"🗒️","pageCover":"","pageCoverThumbnail":"","ext":{},"tagItems":[],"href":"/tag","name":"文章标签","target":"_self","password":"","show":true},{"icon":"fas fa-th","date":{"start_date":"2021-07-02"},"type":"Menu","slug":"/category","title":"文章分类","status":"Published","category":"","comment":"","publishDate":1625184000000,"publishDay":"2021-7-2","lastEditedDate":"2025-09-10T15:29:46.255Z","lastEditedDay":"2025-9-10","fullWidth":false,"pageIcon":"🗒️","pageCover":"","pageCoverThumbnail":"","ext":{},"tagItems":[],"href":"/category","name":"文章分类","target":"_self","password":"","show":true}],"postCount":2,"latestPosts":[{"id":"274b67db-fc9a-80ee-96bc-cd2f7ebbb79b","date":{"start_date":"2025-11-15"},"type":"Post","category":"漏洞分析","title":"帆软ReportServer RCE漏洞复现 （CNVD-2024-33679）","status":"Published","comment":"","publishDate":1763164800000,"publishDay":"2025-11-15","lastEditedDate":"2025-11-30T13:12:16.624Z","lastEditedDay":"2025-11-30","fullWidth":false,"pageIcon":"","pageCover":"","pageCoverThumbnail":"","ext":{},"tagItems":[],"slug":"article/2025/11/15/274b67db-fc9a-80ee-96bc-cd2f7ebbb79b","href":"/article/2025/11/15/274b67db-fc9a-80ee-96bc-cd2f7ebbb79b","target":"_self","password":""},{"id":"20fb67db-fc9a-8088-9172-e2de1af90222","date":{"start_date":"2025-06-13"},"type":"Post","category":"漏洞分析","tags":["JDBC反序列化漏洞","契约锁"],"title":"契约锁-dbtest接口JDBC反序列化漏洞复现","status":"Published","comment":"","publishDate":1749772800000,"publishDay":"2025-6-13","lastEditedDate":"2025-10-13T12:34:56.746Z","lastEditedDay":"2025-10-13","fullWidth":false,"pageIcon":"","pageCover":"","pageCoverThumbnail":"","ext":{},"tagItems":[{"name":"JDBC反序列化漏洞","color":"gray"},{"name":"契约锁","color":"brown"}],"slug":"article/2025/06/12/20fb67db-fc9a-8088-9172-e2de1af90222","href":"/article/2025/06/12/20fb67db-fc9a-8088-9172-e2de1af90222","target":"_self","password":""}],"post":{"id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","date":{"start_date":"2022-12-21"},"type":"Post","category":"二进制安全","summary":"控制流平坦化混淆技术","title":"代码混淆技术之控制流平坦化","status":"Invisible","comment":"","publishDate":1671580800000,"publishDay":"2022-12-21","lastEditedDate":"2025-11-30T10:34:50.438Z","lastEditedDay":"2025-11-30","fullWidth":false,"pageIcon":"","pageCover":"","pageCoverThumbnail":"","ext":{},"tagItems":[],"slug":"article/2022/12/21/eef4533f-2e0e-40aa-b2ad-b859a802825c","href":"/article/2022/12/21/eef4533f-2e0e-40aa-b2ad-b859a802825c","target":"_self","password":"","blockMap":{"block":{"eef4533f-2e0e-40aa-b2ad-b859a802825c":{"value":{"id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","version":392,"type":"page","content":["82c80c17-68ab-4b4a-bd37-06859f2bf09a","e29c1f50-8b7c-4067-813d-e5de85c60e9a","d12ca3c2-2a7a-49f7-9e29-88062e0aa8d2","7490f0bc-0c66-4bee-ab0c-afa11469abec","154e85d9-a7a2-4402-9a45-adc47c1cda8e","d22c5e1e-2491-42f5-8501-e9f0c7555745","05e5ed41-38d7-4782-be65-2c1bccbd8350","889ac16c-f4b0-4902-ae84-4117bdbc91f7","393bc37d-ec4a-4a43-ad5d-ccc578be8788","5f063915-141c-46ff-8990-9a74d4ffa08b","7c5be21e-824c-47b7-82ab-296a50dd684f","6aac4fae-bc29-4477-9162-9bf84a9d5593","4e2c97c2-931a-463f-b101-1221548c6309","5caa184a-ab4a-47df-932b-bd408352b93e","2bcaafd7-714b-408e-a1c3-648e6d84febf","9c4638f2-5db4-465a-9e57-7b7e5585411e","144fc6dc-7c0a-4ea6-b71a-d535c100c6f8","54b3f765-d72b-4f2a-82de-1a90d0c86381","d3baf788-11e8-421e-b19c-eb5014efce57","194ece73-097c-4b8f-854b-3d93ce61ee06","a2a73977-8c80-41fa-b819-ffa8fbf53d94","332bbbad-6e8c-4fc2-8894-97f6dab30020","85595a01-6bfb-4235-a0fd-84529741be96","ce5daa84-f04d-4b09-af96-a4591706d59c","c749b321-6a87-4964-9d56-5e591d7b258d","2f5b5e04-a7f6-4274-b440-d6edaadb2082","be88c4b4-2b0c-4d9a-8aed-032e7caccb51","08f9b1b0-dd15-4c6a-bdca-a63f427c0c08","bb2468a1-2977-49ef-a1e5-07e2c69845c4","6a67c94a-cc8c-498d-b2a7-2ca3b058bfb4","a0a5b6f6-d7c8-446e-bde2-f0b74986a766","01930e26-c6c0-47ca-9245-25cd699354d4","03cc1977-8bc2-4e8e-aa90-5c5c3c6e50f0","8d612fbb-8003-43d1-a3c8-d54f79fcd5ff","84ca54d8-ccf8-4109-a529-e4df2bdb21e0","61026fe8-c370-4250-b502-847027f4bb62","c34a1759-3e9f-4227-b48d-75d36e833495","dfa13954-d40a-4c9e-9f20-a61f5b303f60","cb9e79ed-44fd-42fe-8d0f-36fe034c53ea","e0e7ea13-02a8-4f6e-8d18-8772c71518fa","da03cb6c-fac5-47a7-90c1-2c14f34a63ae","417d2443-f9de-42ad-a927-6a2d9385c1d8","438bab14-ab06-4e0a-aaa1-ed43a9045980","a6fe75c4-4797-4418-a689-9c42dad66550","33dc07cf-d09a-4876-8263-0951ee7b4261","2936a124-d3a6-45cb-91ba-2179b7244de5","35c1b440-a2d9-4f71-a417-1ec92bab4e22","94acd58c-fb0d-4ff6-8b43-28926c2d7d70","55239091-36bd-4553-a546-a9625bcc8a0e","8bd0478a-c697-4510-aa28-79842bfbd2b9","192cd666-bd00-4076-a8e9-45af3b7a719f","ccf237bc-331b-4ed4-85f5-be7db169ac0c","011de229-8d91-42d2-826b-93c82bbfbb4c","d2a9d47e-127c-4668-8e44-0482f8021f0c","94fc5a13-aa57-4a77-8ec7-3bb54dab69f0","3dde32d0-5da3-468c-bfa8-701cd880d416","a4594815-eb8c-4851-9304-bb9ea9c1ac9a","2c640462-09a9-4c6c-8097-045a95834ae4","4ea06b32-c1c3-4343-b478-f422857256f3","c589226a-c757-484b-be26-03130c7d8419","2f70a65d-bfd2-409f-99ff-a8cff19a6783","67941908-3b7e-4218-b28a-06022083e658","0f1bbb93-3f59-4b2e-9196-f0ba0b11fdce","d8940169-3dff-4b42-ace9-2f93cf4c65c4","10691449-c48d-4e68-bd90-51cd0b4b9ef6","f551174d-597c-4740-abef-8a785c841a85"],"created_time":1671559080000,"last_edited_time":1764498890438,"parent_id":"210b67db-fc9a-8121-bebe-000bb39448db","parent_table":"collection","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"ob-owQ-vlq36txQZT6dRnw,\"start\",\"end\"","n":{"ob-owQ-vlq36txQZT6dRnw,\"start\",\"end\"":{"s":{"x":"ob-owQ-vlq36txQZT6dRnw","i":[{"t":"s"},{"t":"t","i":["tRgt-kekk4bb",1],"o":"start","l":13,"c":"代码混淆技术之控制流平坦化"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"210b67db-fc9a-80ed-8f3f-d06983ba70b2":{"value":{"id":"210b67db-fc9a-80ed-8f3f-d06983ba70b2","version":192,"type":"collection_view_page","content":["210b67db-fc9a-81b2-ac95-fe150207322a"],"view_ids":["210b67db-fc9a-8140-b9a0-000c10157bd6","216b67db-fc9a-80de-96f5-000ce107ba3c","210b67db-fc9a-81c8-ad66-000cf4838056","210b67db-fc9a-8138-ae5b-000cb5333572","210b67db-fc9a-81b8-b791-000c44caa07c"],"collection_id":"210b67db-fc9a-8121-bebe-000bb39448db","format":{"block_locked":false,"block_locked_by":"27074aef-7216-41ed-baef-d9b53addd870","collection_pointer":{"id":"210b67db-fc9a-8121-bebe-000bb39448db","table":"collection","spaceId":"0dd8935a-39f8-4c94-aaf7-d2de23196366"},"collection_pointers":[{"id":"210b67db-fc9a-8121-bebe-000bb39448db","table":"collection","spaceId":"0dd8935a-39f8-4c94-aaf7-d2de23196366"}],"copied_from_pointer":{"id":"02ab3b86-7800-4aa6-9e9e-415905ef32a5","table":"block","spaceId":"6c096b44-beb9-48ee-8f92-1efdde47f3a3"},"page_cover_position":0.5},"permissions":[{"role":"editor","type":"user_permission","user_id":"917b4bd9-a4fc-48ad-95f0-8eed14f27ec5"},{"role":"reader","type":"public_permission","is_site":true,"added_timestamp":1757511591748}],"created_time":1749756363583,"last_edited_time":1763222201717,"parent_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","parent_table":"space","alive":true,"copied_from":"02ab3b86-7800-4aa6-9e9e-415905ef32a5","file_ids":["819b206f-1f2e-4f8f-afe5-82b3ea067d0f"],"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"FNLtVrr9XhQzLmEOqwKg8A,\"start\",\"end\"","n":{"FNLtVrr9XhQzLmEOqwKg8A,\"start\",\"end\"":{"s":{"x":"FNLtVrr9XhQzLmEOqwKg8A","i":[{"t":"s"},{"t":"e"}],"l":""}}}}}},"role":"reader"},"82c80c17-68ab-4b4a-bd37-06859f2bf09a":{"value":{"id":"82c80c17-68ab-4b4a-bd37-06859f2bf09a","version":5,"type":"sub_header","properties":{"title":[["控制流平坦化是什么"]]},"created_time":1671628260278,"last_edited_time":1671628260001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"-9s8ZjP9EUgIpgTGLfzE2Q,\"start\",\"end\"","n":{"-9s8ZjP9EUgIpgTGLfzE2Q,\"start\",\"end\"":{"s":{"x":"-9s8ZjP9EUgIpgTGLfzE2Q","i":[{"t":"s"},{"t":"t","i":["oK1imFN6chNf",1],"o":"start","l":9,"c":"控制流平坦化是什么"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"e29c1f50-8b7c-4067-813d-e5de85c60e9a":{"value":{"id":"e29c1f50-8b7c-4067-813d-e5de85c60e9a","version":7,"type":"quote","properties":{"title":[["控制流平坦化指的是将正常控制流中基本块之间的跳转关系删除，用一个集中\n的分发块来调度基本块的执行顺序\n"]]},"created_time":1671628260284,"last_edited_time":1671628260001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"gGGsPITF58i-P5DhLpoAbg,\"start\",\"end\"","n":{"gGGsPITF58i-P5DhLpoAbg,\"start\",\"end\"":{"s":{"x":"gGGsPITF58i-P5DhLpoAbg","i":[{"t":"s"},{"t":"t","i":["3puZ0xHOXVOW",1],"o":"start","l":51,"c":"控制流平坦化指的是将正常控制流中基本块之间的跳转关系删除，用一个集中\n的分发块来调度基本块的执行顺序\n"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"d12ca3c2-2a7a-49f7-9e29-88062e0aa8d2":{"value":{"id":"d12ca3c2-2a7a-49f7-9e29-88062e0aa8d2","version":8,"type":"text","properties":{"title":[["如图所示，右边的图就是通过控制流平坦化实现的（因为看起来很平坦，所以被称为控制流平坦化）"]]},"created_time":1671628260000,"last_edited_time":1671628260001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"uuEJPeoAlM_ndk1fQaVVQw,\"start\",\"end\"","n":{"uuEJPeoAlM_ndk1fQaVVQw,\"start\",\"end\"":{"s":{"x":"uuEJPeoAlM_ndk1fQaVVQw","i":[{"t":"s"},{"t":"t","i":["PWEYyz3e5Dbj",1],"o":"start","l":44,"c":"如图所示，右边的图就是通过控制流平坦化实现的（因为看起来很平坦，所以被称为控制流平坦化）"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"7490f0bc-0c66-4bee-ab0c-afa11469abec":{"value":{"id":"7490f0bc-0c66-4bee-ab0c-afa11469abec","version":6,"type":"text","created_time":1671628260000,"last_edited_time":1671628260001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"P2RLRMAl-n22JJ_weRwbrg,\"start\",\"end\"","n":{"P2RLRMAl-n22JJ_weRwbrg,\"start\",\"end\"":{"s":{"x":"P2RLRMAl-n22JJ_weRwbrg","i":[{"t":"s"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"154e85d9-a7a2-4402-9a45-adc47c1cda8e":{"value":{"id":"154e85d9-a7a2-4402-9a45-adc47c1cda8e","version":7,"type":"image","properties":{"source":[["https://thestar0-1308426403.cos.ap-chengdu.myqcloud.com/img/20221220181333.png"]]},"created_time":1671628260279,"last_edited_time":1671628260001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"sI46UuZfwDDD6fdEHPIGfA,\"start\",\"end\"","n":{"sI46UuZfwDDD6fdEHPIGfA,\"start\",\"end\"":{"s":{"x":"sI46UuZfwDDD6fdEHPIGfA","i":[{"t":"s"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"d22c5e1e-2491-42f5-8501-e9f0c7555745":{"value":{"id":"d22c5e1e-2491-42f5-8501-e9f0c7555745","version":6,"type":"sub_sub_header","properties":{"title":[["控制流平坦化流程结构"]]},"created_time":1671628260284,"last_edited_time":1671628260001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"HzMsJK3MvZt9QgKr2_jSsA,\"start\",\"end\"","n":{"HzMsJK3MvZt9QgKr2_jSsA,\"start\",\"end\"":{"s":{"x":"HzMsJK3MvZt9QgKr2_jSsA","i":[{"t":"s"},{"t":"t","i":["WoeBhFLzglJv",1],"o":"start","l":10,"c":"控制流平坦化流程结构"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"05e5ed41-38d7-4782-be65-2c1bccbd8350":{"value":{"id":"05e5ed41-38d7-4782-be65-2c1bccbd8350","version":5,"type":"text","properties":{"title":[["大致分为四个结构"]]},"created_time":1671628260284,"last_edited_time":1671628260001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"4h0MNgQhmNIzRhRoRXzf7Q,\"start\",\"end\"","n":{"4h0MNgQhmNIzRhRoRXzf7Q,\"start\",\"end\"":{"s":{"x":"4h0MNgQhmNIzRhRoRXzf7Q","i":[{"t":"s"},{"t":"t","i":["1bM5CMpGrrxp",1],"o":"start","l":8,"c":"大致分为四个结构"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"889ac16c-f4b0-4902-ae84-4117bdbc91f7":{"value":{"id":"889ac16c-f4b0-4902-ae84-4117bdbc91f7","version":5,"type":"numbered_list","properties":{"title":[["入口块（进入函数第一个执行的基本块）"]]},"created_time":1671628260284,"last_edited_time":1671628260001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"3UVhoAeHLb5XRzM8LWUCVg,\"start\",\"end\"","n":{"3UVhoAeHLb5XRzM8LWUCVg,\"start\",\"end\"":{"s":{"x":"3UVhoAeHLb5XRzM8LWUCVg","i":[{"t":"s"},{"t":"t","i":["1mSUDcRVo_AE",1],"o":"start","l":18,"c":"入口块（进入函数第一个执行的基本块）"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"393bc37d-ec4a-4a43-ad5d-ccc578be8788":{"value":{"id":"393bc37d-ec4a-4a43-ad5d-ccc578be8788","version":5,"type":"numbered_list","properties":{"title":[["主分发块与子分发块（：负责跳转到下一个要执\n行的原基本块）"]]},"created_time":1671628260285,"last_edited_time":1671628260001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"hFAIR5bt52r1bBvB-RY0ZA,\"start\",\"end\"","n":{"hFAIR5bt52r1bBvB-RY0ZA,\"start\",\"end\"":{"s":{"x":"hFAIR5bt52r1bBvB-RY0ZA","i":[{"t":"s"},{"t":"t","i":["qH3wLtrW86yr",1],"o":"start","l":29,"c":"主分发块与子分发块（：负责跳转到下一个要执\n行的原基本块）"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"5f063915-141c-46ff-8990-9a74d4ffa08b":{"value":{"id":"5f063915-141c-46ff-8990-9a74d4ffa08b","version":5,"type":"numbered_list","properties":{"title":[["原基本块（混淆之前的基本块，真正完成程序工\n作的基本块）"]]},"created_time":1671628260285,"last_edited_time":1671628260001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"hSebTkKlB-kh_qDMaHWG8g,\"start\",\"end\"","n":{"hSebTkKlB-kh_qDMaHWG8g,\"start\",\"end\"":{"s":{"x":"hSebTkKlB-kh_qDMaHWG8g","i":[{"t":"s"},{"t":"t","i":["E5G3KJdY8ti1",1],"o":"start","l":28,"c":"原基本块（混淆之前的基本块，真正完成程序工\n作的基本块）"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"7c5be21e-824c-47b7-82ab-296a50dd684f":{"value":{"id":"7c5be21e-824c-47b7-82ab-296a50dd684f","version":6,"type":"numbered_list","properties":{"title":[["返回块（返回到主分发块）"]]},"created_time":1671628260285,"last_edited_time":1671628260001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"9RxS5nCQu50vMlEhhI7R6Q,\"start\",\"end\"","n":{"9RxS5nCQu50vMlEhhI7R6Q,\"start\",\"end\"":{"s":{"x":"9RxS5nCQu50vMlEhhI7R6Q","i":[{"t":"s"},{"t":"t","i":["a5LYJGvbl3jc",1],"o":"start","l":12,"c":"返回块（返回到主分发块）"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"6aac4fae-bc29-4477-9162-9bf84a9d5593":{"value":{"id":"6aac4fae-bc29-4477-9162-9bf84a9d5593","version":8,"type":"text","content":["68ff7bb0-06ee-4458-9471-265b87ca732e"],"created_time":1671628260000,"last_edited_time":1671628260001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"xaMyNQqiYsIc82QCrpBaYA,\"start\",\"end\"","n":{"xaMyNQqiYsIc82QCrpBaYA,\"start\",\"end\"":{"s":{"x":"xaMyNQqiYsIc82QCrpBaYA","i":[{"t":"s"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"4e2c97c2-931a-463f-b101-1221548c6309":{"value":{"id":"4e2c97c2-931a-463f-b101-1221548c6309","version":5,"type":"sub_sub_header","properties":{"title":[["程序流程混淆效果"]]},"created_time":1671628260285,"last_edited_time":1671628260001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"7EO1mgFLzcoM17hiCn1ZWg,\"start\",\"end\"","n":{"7EO1mgFLzcoM17hiCn1ZWg,\"start\",\"end\"":{"s":{"x":"7EO1mgFLzcoM17hiCn1ZWg","i":[{"t":"s"},{"t":"t","i":["z8N-8VMRNQ7O",1],"o":"start","l":8,"c":"程序流程混淆效果"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"5caa184a-ab4a-47df-932b-bd408352b93e":{"value":{"id":"5caa184a-ab4a-47df-932b-bd408352b93e","version":4,"type":"image","properties":{"source":[["https://thestar0-1308426403.cos.ap-chengdu.myqcloud.com/img/20221220181811.png"]]},"created_time":1671628260285,"last_edited_time":1671628260001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"bIWyb_eBhfs9mBgKbSAilA,\"start\",\"end\"","n":{"bIWyb_eBhfs9mBgKbSAilA,\"start\",\"end\"":{"s":{"x":"bIWyb_eBhfs9mBgKbSAilA","i":[{"t":"s"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"2bcaafd7-714b-408e-a1c3-648e6d84febf":{"value":{"id":"2bcaafd7-714b-408e-a1c3-648e6d84febf","version":5,"type":"bulleted_list","properties":{"title":[["当我们分析正常的控制流时，我们能很容易的分析出程序的执行顺序，以及每一段代码完成的工作如何执行（一段代码可能由多个互相关联的基本块组成），进而掌握整个程序的逻辑"]]},"created_time":1671628260285,"last_edited_time":1671628260001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"FSlpxX1Hh02v7nQx7AvZKw,\"start\",\"end\"","n":{"FSlpxX1Hh02v7nQx7AvZKw,\"start\",\"end\"":{"s":{"x":"FSlpxX1Hh02v7nQx7AvZKw","i":[{"t":"s"},{"t":"t","i":["SvxoNLLH8YHL",1],"o":"start","l":80,"c":"当我们分析正常的控制流时，我们能很容易的分析出程序的执行顺序，以及每一段代码完成的工作如何执行（一段代码可能由多个互相关联的基本块组成），进而掌握整个程序的逻辑"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"9c4638f2-5db4-465a-9e57-7b7e5585411e":{"value":{"id":"9c4638f2-5db4-465a-9e57-7b7e5585411e","version":5,"type":"bulleted_list","properties":{"title":[["当我们分析平坦化后的控制流时，在不知道基本块执行顺序的情况下，分别对每一个基本块进行分析是很难的，而如果要得知每一个基本块的执行顺序，必须分析分发块的调度逻辑"]]},"created_time":1671628260285,"last_edited_time":1671628260001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"k0XHnSv8eH16kXcPqVX5aw,\"start\",\"end\"","n":{"k0XHnSv8eH16kXcPqVX5aw,\"start\",\"end\"":{"s":{"x":"k0XHnSv8eH16kXcPqVX5aw","i":[{"t":"s"},{"t":"t","i":["P4DjHSdokcem",1],"o":"start","l":79,"c":"当我们分析平坦化后的控制流时，在不知道基本块执行顺序的情况下，分别对每一个基本块进行分析是很难的，而如果要得知每一个基本块的执行顺序，必须分析分发块的调度逻辑"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"144fc6dc-7c0a-4ea6-b71a-d535c100c6f8":{"value":{"id":"144fc6dc-7c0a-4ea6-b71a-d535c100c6f8","version":5,"type":"bulleted_list","properties":{"title":[["在实际分析中当函数比较复杂的时候，通过手动分析分发块还原原基本块的执行顺序是非常复杂的（比如上面这个图）"]]},"created_time":1671628260286,"last_edited_time":1671628260001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"tcgD_TuCbn41pC8flpThdQ,\"start\",\"end\"","n":{"tcgD_TuCbn41pC8flpThdQ,\"start\",\"end\"":{"s":{"x":"tcgD_TuCbn41pC8flpThdQ","i":[{"t":"s"},{"t":"t","i":["VUusJfWNMTWm",1],"o":"start","l":52,"c":"在实际分析中当函数比较复杂的时候，通过手动分析分发块还原原基本块的执行顺序是非常复杂的（比如上面这个图）"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"54b3f765-d72b-4f2a-82de-1a90d0c86381":{"value":{"id":"54b3f765-d72b-4f2a-82de-1a90d0c86381","version":5,"type":"sub_sub_header","properties":{"title":[["程序代码混淆效果"]]},"created_time":1671628260286,"last_edited_time":1671628260001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"e2BhEQamDG60xGYufrwGYQ,\"start\",\"end\"","n":{"e2BhEQamDG60xGYufrwGYQ,\"start\",\"end\"":{"s":{"x":"e2BhEQamDG60xGYufrwGYQ","i":[{"t":"s"},{"t":"t","i":["qs5S5LA3qYYE",1],"o":"start","l":8,"c":"程序代码混淆效果"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"d3baf788-11e8-421e-b19c-eb5014efce57":{"value":{"id":"d3baf788-11e8-421e-b19c-eb5014efce57","version":7,"type":"text","properties":{"title":[["控制流平坦化混淆后的伪代码，while + switch 结构对应平坦化后的控制流代码结构"]]},"created_time":1671628260286,"last_edited_time":1671628260001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"MyIAKAyFgcf10OIs37lNvw,\"start\",\"end\"","n":{"MyIAKAyFgcf10OIs37lNvw,\"start\",\"end\"":{"s":{"x":"MyIAKAyFgcf10OIs37lNvw","i":[{"t":"s"},{"t":"t","i":["l-6ceFFIKCWK",1],"o":"start","l":45,"c":"控制流平坦化混淆后的伪代码，while + switch 结构对应平坦化后的控制流代码结构"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"194ece73-097c-4b8f-854b-3d93ce61ee06":{"value":{"id":"194ece73-097c-4b8f-854b-3d93ce61ee06","version":4,"type":"image","properties":{"source":[["https://thestar0-1308426403.cos.ap-chengdu.myqcloud.com/img/20221220183924.png"]]},"created_time":1671628260286,"last_edited_time":1671628260001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"UJC2uS7KsE6g7xYwmGDfWw,\"start\",\"end\"","n":{"UJC2uS7KsE6g7xYwmGDfWw,\"start\",\"end\"":{"s":{"x":"UJC2uS7KsE6g7xYwmGDfWw","i":[{"t":"s"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"a2a73977-8c80-41fa-b819-ffa8fbf53d94":{"value":{"id":"a2a73977-8c80-41fa-b819-ffa8fbf53d94","version":5,"type":"sub_header","properties":{"title":[["代码实现"]]},"created_time":1671628260286,"last_edited_time":1671628260001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"XcF2JiNxIGwuX5elJmVM4w,\"start\",\"end\"","n":{"XcF2JiNxIGwuX5elJmVM4w,\"start\",\"end\"":{"s":{"x":"XcF2JiNxIGwuX5elJmVM4w","i":[{"t":"s"},{"t":"t","i":["LVbXoqIzlZ_d",1],"o":"start","l":4,"c":"代码实现"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"332bbbad-6e8c-4fc2-8894-97f6dab30020":{"value":{"id":"332bbbad-6e8c-4fc2-8894-97f6dab30020","version":5,"type":"sub_sub_header","properties":{"title":[["实现步骤"]]},"created_time":1671628260286,"last_edited_time":1671628260001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"QwOLxh_mueJ3OsWqdXi3jg,\"start\",\"end\"","n":{"QwOLxh_mueJ3OsWqdXi3jg,\"start\",\"end\"":{"s":{"x":"QwOLxh_mueJ3OsWqdXi3jg","i":[{"t":"s"},{"t":"t","i":["yWxEDD1Cg-9D",1],"o":"start","l":4,"c":"实现步骤"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"85595a01-6bfb-4235-a0fd-84529741be96":{"value":{"id":"85595a01-6bfb-4235-a0fd-84529741be96","version":5,"type":"text","properties":{"title":[["大致分为 5 步"]]},"created_time":1671628260286,"last_edited_time":1671628260001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"wTh9I3LsIINGB_9WD1_rUQ,\"start\",\"end\"","n":{"wTh9I3LsIINGB_9WD1_rUQ,\"start\",\"end\"":{"s":{"x":"wTh9I3LsIINGB_9WD1_rUQ","i":[{"t":"s"},{"t":"t","i":["Ee3sQcBUpYdh",1],"o":"start","l":8,"c":"大致分为 5 步"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"ce5daa84-f04d-4b09-af96-a4591706d59c":{"value":{"id":"ce5daa84-f04d-4b09-af96-a4591706d59c","version":5,"type":"numbered_list","properties":{"title":[["保存原基本块"]]},"created_time":1671628260286,"last_edited_time":1671628260001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"vKqdvNItMBgmQE8gY9GfSg,\"start\",\"end\"","n":{"vKqdvNItMBgmQE8gY9GfSg,\"start\",\"end\"":{"s":{"x":"vKqdvNItMBgmQE8gY9GfSg","i":[{"t":"s"},{"t":"t","i":["ozxpVv0PvFiA",1],"o":"start","l":6,"c":"保存原基本块"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"c749b321-6a87-4964-9d56-5e591d7b258d":{"value":{"id":"c749b321-6a87-4964-9d56-5e591d7b258d","version":5,"type":"numbered_list","properties":{"title":[["创建分发块和返回块"]]},"created_time":1671628260286,"last_edited_time":1671628260001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"zzX9yjxtoW77Z8cPPKoDiA,\"start\",\"end\"","n":{"zzX9yjxtoW77Z8cPPKoDiA,\"start\",\"end\"":{"s":{"x":"zzX9yjxtoW77Z8cPPKoDiA","i":[{"t":"s"},{"t":"t","i":["JkSBlRiJDQNH",1],"o":"start","l":9,"c":"创建分发块和返回块"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"68ff7bb0-06ee-4458-9471-265b87ca732e":{"value":{"id":"68ff7bb0-06ee-4458-9471-265b87ca732e","version":6,"type":"image","properties":{"source":[["https://thestar0-1308426403.cos.ap-chengdu.myqcloud.com/img/20221220181632.png"]]},"created_time":1671628260285,"last_edited_time":1671628260001,"parent_id":"6aac4fae-bc29-4477-9162-9bf84a9d5593","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"AZpfd6FCwXseE52N7bPBnQ,\"start\",\"end\"","n":{"AZpfd6FCwXseE52N7bPBnQ,\"start\",\"end\"":{"s":{"x":"AZpfd6FCwXseE52N7bPBnQ","i":[{"t":"s"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"2f5b5e04-a7f6-4274-b440-d6edaadb2082":{"value":{"id":"2f5b5e04-a7f6-4274-b440-d6edaadb2082","version":5,"type":"numbered_list","properties":{"title":[["实现分发块调度"]]},"created_time":1671628260286,"last_edited_time":1671628260001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"4RGYCKXYD5Wl_2KMuFIogw,\"start\",\"end\"","n":{"4RGYCKXYD5Wl_2KMuFIogw,\"start\",\"end\"":{"s":{"x":"4RGYCKXYD5Wl_2KMuFIogw","i":[{"t":"s"},{"t":"t","i":["cNGF688B3lgf",1],"o":"start","l":7,"c":"实现分发块调度"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"be88c4b4-2b0c-4d9a-8aed-032e7caccb51":{"value":{"id":"be88c4b4-2b0c-4d9a-8aed-032e7caccb51","version":5,"type":"numbered_list","properties":{"title":[["实现调度变量自动调整"]]},"created_time":1671628260286,"last_edited_time":1671628260001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"BOBEC69_6su_fYikwYhqNg,\"start\",\"end\"","n":{"BOBEC69_6su_fYikwYhqNg,\"start\",\"end\"":{"s":{"x":"BOBEC69_6su_fYikwYhqNg","i":[{"t":"s"},{"t":"t","i":["Cw07-Gs-Nzs7",1],"o":"start","l":10,"c":"实现调度变量自动调整"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"08f9b1b0-dd15-4c6a-bdca-a63f427c0c08":{"value":{"id":"08f9b1b0-dd15-4c6a-bdca-a63f427c0c08","version":5,"type":"numbered_list","properties":{"title":[["修复 PHI 指令和逃逸变量"]]},"created_time":1671628260286,"last_edited_time":1671628260001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"B7FJRvXmxt400yw2nGK80g,\"start\",\"end\"","n":{"B7FJRvXmxt400yw2nGK80g,\"start\",\"end\"":{"s":{"x":"B7FJRvXmxt400yw2nGK80g","i":[{"t":"s"},{"t":"t","i":["i3vsEx_kbYJB",1],"o":"start","l":14,"c":"修复 PHI 指令和逃逸变量"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"bb2468a1-2977-49ef-a1e5-07e2c69845c4":{"value":{"id":"bb2468a1-2977-49ef-a1e5-07e2c69845c4","version":5,"type":"sub_sub_header","properties":{"title":[["保存原基本块"]]},"created_time":1671628260287,"last_edited_time":1671628260001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"Rt0X-2N4ysKj6LBzAELTsQ,\"start\",\"end\"","n":{"Rt0X-2N4ysKj6LBzAELTsQ,\"start\",\"end\"":{"s":{"x":"Rt0X-2N4ysKj6LBzAELTsQ","i":[{"t":"s"},{"t":"t","i":["z6CFXvMFsrDs",1],"o":"start","l":6,"c":"保存原基本块"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"6a67c94a-cc8c-498d-b2a7-2ca3b058bfb4":{"value":{"id":"6a67c94a-cc8c-498d-b2a7-2ca3b058bfb4","version":8,"type":"bulleted_list","properties":{"title":[["将除入口块以外的以外的基本块保存到 vector 容器中，方便后续处理（原因可以看上一篇的 LLVM 基本块分割里面说的有）"]]},"created_time":1671628260287,"last_edited_time":1671628320001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"RXX7--qTZu_sr7MrsHn5aQ,\"start\",\"end\"","n":{"RXX7--qTZu_sr7MrsHn5aQ,\"start\",\"end\"":{"s":{"x":"RXX7--qTZu_sr7MrsHn5aQ","i":[{"t":"s"},{"t":"t","i":["j5NUb5NxSb5a",1],"o":"start","l":62,"c":"将除入口块以外的以外的基本块保存到 vector 容器中，方便后续处理（原因可以看上一篇的 LLVM 基本块分割里面说的有）"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"a0a5b6f6-d7c8-446e-bde2-f0b74986a766":{"value":{"id":"a0a5b6f6-d7c8-446e-bde2-f0b74986a766","version":15,"type":"bulleted_list","properties":{"title":[["如果入口块的终结指令是条件分支指令，则将该指令单独分离出来作为一个基本块，加入到 vector 容器的最前面"]]},"created_time":1671628260287,"last_edited_time":1671628320001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"oS0XT1mHRZfJYdMpRDEsQw,\"start\",\"end\"","n":{"oS0XT1mHRZfJYdMpRDEsQw,\"start\",\"end\"":{"s":{"x":"oS0XT1mHRZfJYdMpRDEsQw","i":[{"t":"s"},{"t":"t","i":["qzMHAGh-FLbX",1],"o":"start","l":54,"c":"如果入口块的终结指令是条件分支指令，则将该指令单独分离出来作为一个基本块，加入到 vector 容器的最前面"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"01930e26-c6c0-47ca-9245-25cd699354d4":{"value":{"id":"01930e26-c6c0-47ca-9245-25cd699354d4","version":7,"type":"image","properties":{"source":[["https://thestar0-1308426403.cos.ap-chengdu.myqcloud.com/img/20221220184408.png"]]},"created_time":1671628260287,"last_edited_time":1671628320001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"yC9gctUUgBttp3RBYNr_qA,\"start\",\"end\"","n":{"yC9gctUUgBttp3RBYNr_qA,\"start\",\"end\"":{"s":{"x":"yC9gctUUgBttp3RBYNr_qA","i":[{"t":"s"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"03cc1977-8bc2-4e8e-aa90-5c5c3c6e50f0":{"value":{"id":"03cc1977-8bc2-4e8e-aa90-5c5c3c6e50f0","version":13,"type":"text","properties":{"title":[["代码实现："]]},"created_time":1671628320000,"last_edited_time":1671628320001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"MX_MIYdvkljcc2bMNDEFYQ,\"start\",\"end\"","n":{"MX_MIYdvkljcc2bMNDEFYQ,\"start\",\"end\"":{"s":{"x":"MX_MIYdvkljcc2bMNDEFYQ","i":[{"t":"s"},{"t":"t","i":["gBcdwmPgUuYW",1],"o":"start","l":5,"c":"代码实现："},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"8d612fbb-8003-43d1-a3c8-d54f79fcd5ff":{"value":{"id":"8d612fbb-8003-43d1-a3c8-d54f79fcd5ff","version":8,"type":"code","properties":{"title":[["// 第一步保存除入口(第一个基本块)之外的所有基本块保存到vector容器中\n    vector\u003cBasicBlock *\u003e origBB;\n    for (BasicBlock \u0026BB : F) // 遍历函数F中的所有基本块\n    {\n        origBB.push_back(\u0026BB); // 将基本块保存到vector容器中\n    }\n    origBB.erase(origBB.begin());                                       // 从vector容器中删除入口块\n    BasicBlock \u0026entryBB = F.getEntryBlock();                            // 获取入口块\n    if (BranchInst *br = dyn_cast\u003cBranchInst\u003e(entryBB.getTerminator())) // 判断入口块的跳转指令是否是分支指令\n    {\n        if (br-\u003eisConditional())\n        {\n            // 如果入口块是条件分支，则将条件分支转换为无条件分支\n            origBB.insert(origBB.begin(), entryBB.splitBasicBlock(br));\n        }\n    }\n"]],"language":[["cpp"]]},"format":{"code_wrap":true},"created_time":1671628260287,"last_edited_time":1671628320001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"7cqa5YMJajPSXcDSqARGvA,\"start\",\"end\"","n":{"7cqa5YMJajPSXcDSqARGvA,\"start\",\"end\"":{"s":{"x":"7cqa5YMJajPSXcDSqARGvA","i":[{"t":"s"},{"t":"t","i":["zjWAxfOCkiHK",1],"o":"start","l":624,"c":"// 第一步保存除入口(第一个基本块)之外的所有基本块保存到vector容器中\n    vector\u003cBasicBlock *\u003e origBB;\n    for (BasicBlock \u0026BB : F) // 遍历函数F中的所有基本块\n    {\n        origBB.push_back(\u0026BB); // 将基本块保存到vector容器中\n    }\n    origBB.erase(origBB.begin());                                       // 从vector容器中删除入口块\n    BasicBlock \u0026entryBB = F.getEntryBlock();                            // 获取入口块\n    if (BranchInst *br = dyn_cast\u003cBranchInst\u003e(entryBB.getTerminator())) // 判断入口块的跳转指令是否是分支指令\n    {\n        if (br-\u003eisConditional())\n        {\n            // 如果入口块是条件分支，则将条件分支转换为无条件分支\n            origBB.insert(origBB.begin(), entryBB.splitBasicBlock(br));\n        }\n    }\n"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"84ca54d8-ccf8-4109-a529-e4df2bdb21e0":{"value":{"id":"84ca54d8-ccf8-4109-a529-e4df2bdb21e0","version":5,"type":"sub_sub_header","properties":{"title":[["创建分发块和返回块"]]},"created_time":1671628260287,"last_edited_time":1671628260001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"NmmaR3uh74ROjCJbk9GsVg,\"start\",\"end\"","n":{"NmmaR3uh74ROjCJbk9GsVg,\"start\",\"end\"":{"s":{"x":"NmmaR3uh74ROjCJbk9GsVg","i":[{"t":"s"},{"t":"t","i":["keMsMe6o050R",1],"o":"start","l":9,"c":"创建分发块和返回块"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"61026fe8-c370-4250-b502-847027f4bb62":{"value":{"id":"61026fe8-c370-4250-b502-847027f4bb62","version":5,"type":"bulleted_list","properties":{"title":[["除了原基本块之外，我们还要续创建一个分发块来调度基本块的执行顺序。并建立入口块到分发块的绝对跳转。"]]},"created_time":1671628260287,"last_edited_time":1671628260001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"u67detuzBMpXPtM0xvkLbg,\"start\",\"end\"","n":{"u67detuzBMpXPtM0xvkLbg,\"start\",\"end\"":{"s":{"x":"u67detuzBMpXPtM0xvkLbg","i":[{"t":"s"},{"t":"t","i":["WjN6iuqGjY2R",1],"o":"start","l":49,"c":"除了原基本块之外，我们还要续创建一个分发块来调度基本块的执行顺序。并建立入口块到分发块的绝对跳转。"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"c34a1759-3e9f-4227-b48d-75d36e833495":{"value":{"id":"c34a1759-3e9f-4227-b48d-75d36e833495","version":9,"type":"bulleted_list","properties":{"title":[["再创建一个返回块，原基本块执行完后都需要跳转到这个返回块，返回块会直接跳转到分发块。"]]},"created_time":1671628260288,"last_edited_time":1671628380001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"eTIQipsCkuSRO-nAbVgfzQ,\"start\",\"end\"","n":{"eTIQipsCkuSRO-nAbVgfzQ,\"start\",\"end\"":{"s":{"x":"eTIQipsCkuSRO-nAbVgfzQ","i":[{"t":"s"},{"t":"t","i":["UMsIISSJHrnB",1],"o":"start","l":42,"c":"再创建一个返回块，原基本块执行完后都需要跳转到这个返回块，返回块会直接跳转到分发块。"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"dfa13954-d40a-4c9e-9f20-a61f5b303f60":{"value":{"id":"dfa13954-d40a-4c9e-9f20-a61f5b303f60","version":10,"type":"text","content":["a3b6b96d-de2d-4804-80fb-e5e3837b27fd"],"created_time":1671628380000,"last_edited_time":1671628380001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"mAzvCRnKB3BbFzUk2C_f7Q,\"start\",\"end\"","n":{"mAzvCRnKB3BbFzUk2C_f7Q,\"start\",\"end\"":{"s":{"x":"mAzvCRnKB3BbFzUk2C_f7Q","i":[{"t":"s"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"cb9e79ed-44fd-42fe-8d0f-36fe034c53ea":{"value":{"id":"cb9e79ed-44fd-42fe-8d0f-36fe034c53ea","version":14,"type":"text","properties":{"title":[["代码实现："]]},"created_time":1671628380000,"last_edited_time":1671628380001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"0Eg_m4On82rRHGuKMy3rvA,\"start\",\"end\"","n":{"0Eg_m4On82rRHGuKMy3rvA,\"start\",\"end\"":{"s":{"x":"0Eg_m4On82rRHGuKMy3rvA","i":[{"t":"s"},{"t":"t","i":["6ItfuAK-YRe_",1],"o":"start","l":5,"c":"代码实现："},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"e0e7ea13-02a8-4f6e-8d18-8772c71518fa":{"value":{"id":"e0e7ea13-02a8-4f6e-8d18-8772c71518fa","version":7,"type":"code","properties":{"title":[["// 第二步，创建分发块和返回块\n    BasicBlock *dispatchBB = BasicBlock::Create(*CONTEXT, \"dispatchBB\", \u0026F, \u0026entryBB); // 创建分发块\n    BasicBlock *returnBB = BasicBlock::Create(*CONTEXT, \"returnBB\", \u0026F, \u0026entryBB);     // 创建返回块\n    entryBB.moveBefore(dispatchBB);                                                    // 将入口块移动到分发块之前\n    entryBB.getTerminator()-\u003eeraseFromParent();                                        // 删除入口块的跳转指令\n    BranchInst::Create(dispatchBB, \u0026entryBB);                                          // 在入口块中添加跳转指令，跳转到分发块\n    BranchInst::Create(dispatchBB, returnBB);                                          // 在返回块中添加跳转指令，跳转到分发块\n\n"]],"language":[["cpp"]]},"format":{"code_wrap":true},"created_time":1671628260288,"last_edited_time":1671628380001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"1v5mJZ_D9-WM3NjPmSJzCA,\"start\",\"end\"","n":{"1v5mJZ_D9-WM3NjPmSJzCA,\"start\",\"end\"":{"s":{"x":"1v5mJZ_D9-WM3NjPmSJzCA","i":[{"t":"s"},{"t":"t","i":["DvOSqBrWK1Ul",1],"o":"start","l":632,"c":"// 第二步，创建分发块和返回块\n    BasicBlock *dispatchBB = BasicBlock::Create(*CONTEXT, \"dispatchBB\", \u0026F, \u0026entryBB); // 创建分发块\n    BasicBlock *returnBB = BasicBlock::Create(*CONTEXT, \"returnBB\", \u0026F, \u0026entryBB);     // 创建返回块\n    entryBB.moveBefore(dispatchBB);                                                    // 将入口块移动到分发块之前\n    entryBB.getTerminator()-\u003eeraseFromParent();                                        // 删除入口块的跳转指令\n    BranchInst::Create(dispatchBB, \u0026entryBB);                                          // 在入口块中添加跳转指令，跳转到分发块\n    BranchInst::Create(dispatchBB, returnBB);                                          // 在返回块中添加跳转指令，跳转到分发块\n\n"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"da03cb6c-fac5-47a7-90c1-2c14f34a63ae":{"value":{"id":"da03cb6c-fac5-47a7-90c1-2c14f34a63ae","version":6,"type":"sub_sub_header","properties":{"title":[["实现分发块调度"]]},"created_time":1671628260288,"last_edited_time":1671628380001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"-5ALwFPYw_4TOaPk91JcRw,\"start\",\"end\"","n":{"-5ALwFPYw_4TOaPk91JcRw,\"start\",\"end\"":{"s":{"x":"-5ALwFPYw_4TOaPk91JcRw","i":[{"t":"s"},{"t":"t","i":["XU2k3buYYGCm",1],"o":"start","l":7,"c":"实现分发块调度"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"417d2443-f9de-42ad-a927-6a2d9385c1d8":{"value":{"id":"417d2443-f9de-42ad-a927-6a2d9385c1d8","version":5,"type":"bulleted_list","properties":{"title":[["在入口块中创建并初始化 switch 变量，在调度块中插入 switch 指令实现分发功能"]]},"created_time":1671628260288,"last_edited_time":1671628260001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"fMISbtHdAQMJM-TdlNg5IA,\"start\",\"end\"","n":{"fMISbtHdAQMJM-TdlNg5IA,\"start\",\"end\"":{"s":{"x":"fMISbtHdAQMJM-TdlNg5IA","i":[{"t":"s"},{"t":"t","i":["PV3Y-NOsAS0O",1],"o":"start","l":45,"c":"在入口块中创建并初始化 switch 变量，在调度块中插入 switch 指令实现分发功能"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"438bab14-ab06-4e0a-aaa1-ed43a9045980":{"value":{"id":"438bab14-ab06-4e0a-aaa1-ed43a9045980","version":7,"type":"bulleted_list","properties":{"title":[["将原基本块移动到返回块之前，并分配随机的 case 值，并将其添加到 switch 指令的分支中"]]},"created_time":1671628260288,"last_edited_time":1671628380001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"VYCrnPvoZARF9LDtGrAReQ,\"start\",\"end\"","n":{"VYCrnPvoZARF9LDtGrAReQ,\"start\",\"end\"":{"s":{"x":"VYCrnPvoZARF9LDtGrAReQ","i":[{"t":"s"},{"t":"t","i":["7e8kzXG_7NxR",1],"o":"start","l":48,"c":"将原基本块移动到返回块之前，并分配随机的 case 值，并将其添加到 switch 指令的分支中"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"a6fe75c4-4797-4418-a689-9c42dad66550":{"value":{"id":"a6fe75c4-4797-4418-a689-9c42dad66550","version":12,"type":"text","content":["52f52e50-0448-4f5f-b8ed-fd42b246105a"],"created_time":1671628380000,"last_edited_time":1671628380001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"-igGSCcxMqUKj5fU5f6nbQ,\"start\",\"end\"","n":{"-igGSCcxMqUKj5fU5f6nbQ,\"start\",\"end\"":{"s":{"x":"-igGSCcxMqUKj5fU5f6nbQ","i":[{"t":"s"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"33dc07cf-d09a-4876-8263-0951ee7b4261":{"value":{"id":"33dc07cf-d09a-4876-8263-0951ee7b4261","version":14,"type":"text","properties":{"title":[["代码实现："]]},"created_time":1671628380000,"last_edited_time":1671628380001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"rLBcDSrRcRe_X6WrLe4nUQ,\"start\",\"end\"","n":{"rLBcDSrRcRe_X6WrLe4nUQ,\"start\",\"end\"":{"s":{"x":"rLBcDSrRcRe_X6WrLe4nUQ","i":[{"t":"s"},{"t":"t","i":["ajg3V_LdAUAe",1],"o":"start","l":5,"c":"代码实现："},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"2936a124-d3a6-45cb-91ba-2179b7244de5":{"value":{"id":"2936a124-d3a6-45cb-91ba-2179b7244de5","version":7,"type":"code","properties":{"title":[["// 第三步，实现分发块的调度功能\n    int randNumCase = rand();// 生成随机数\n    AllocaInst *swVarPtr = new AllocaInst(TYPE_I32, 0, \"swVar.ptr\", entryBB.getTerminator());// 在入口块中创建一个局部变量\n    new StoreInst(CONST_I32(randNumCase), swVarPtr, entryBB.getTerminator());// 将随机数保存到局部变量中\n    LoadInst *swVar = new LoadInst(TYPE_I32, swVarPtr, \"swVar\", dispatchBB);// 在分发块中加载局部变量的值\n    BasicBlock *defaultBB = BasicBlock::Create(*CONTEXT, \"defaultBB\", \u0026F, returnBB);// 创建默认块\n    BranchInst::Create(returnBB, defaultBB);// 在默认块中添加跳转指令，跳转到返回块\n    SwitchInst *swInst = SwitchInst::Create(swVar, defaultBB, 0, dispatchBB);// 在分发块中创建switch指令\n    for (BasicBlock *BB : origBB)// 遍历除入口块之外的所有基本块\n    {\n        BB-\u003emoveBefore(returnBB);// 将基本块移动到返回块之前\n        swInst-\u003eaddCase(CONST_I32(randNumCase), BB);// 将基本块添加到switch指令中\n        randNumCase = rand();// 生成随机数\n    }\n"]],"language":[["cpp"]]},"format":{"code_wrap":true},"created_time":1671628260288,"last_edited_time":1671628380001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"JTuDW1dSLx76ZDVhW75Neg,\"start\",\"end\"","n":{"JTuDW1dSLx76ZDVhW75Neg,\"start\",\"end\"":{"s":{"x":"JTuDW1dSLx76ZDVhW75Neg","i":[{"t":"s"},{"t":"t","i":["FPb_nV2TFzDH",1],"o":"start","l":829,"c":"// 第三步，实现分发块的调度功能\n    int randNumCase = rand();// 生成随机数\n    AllocaInst *swVarPtr = new AllocaInst(TYPE_I32, 0, \"swVar.ptr\", entryBB.getTerminator());// 在入口块中创建一个局部变量\n    new StoreInst(CONST_I32(randNumCase), swVarPtr, entryBB.getTerminator());// 将随机数保存到局部变量中\n    LoadInst *swVar = new LoadInst(TYPE_I32, swVarPtr, \"swVar\", dispatchBB);// 在分发块中加载局部变量的值\n    BasicBlock *defaultBB = BasicBlock::Create(*CONTEXT, \"defaultBB\", \u0026F, returnBB);// 创建默认块\n    BranchInst::Create(returnBB, defaultBB);// 在默认块中添加跳转指令，跳转到返回块\n    SwitchInst *swInst = SwitchInst::Create(swVar, defaultBB, 0, dispatchBB);// 在分发块中创建switch指令\n    for (BasicBlock *BB : origBB)// 遍历除入口块之外的所有基本块\n    {\n        BB-\u003emoveBefore(returnBB);// 将基本块移动到返回块之前\n        swInst-\u003eaddCase(CONST_I32(randNumCase), BB);// 将基本块添加到switch指令中\n        randNumCase = rand();// 生成随机数\n    }\n"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"35c1b440-a2d9-4f71-a417-1ec92bab4e22":{"value":{"id":"35c1b440-a2d9-4f71-a417-1ec92bab4e22","version":6,"type":"sub_sub_header","properties":{"title":[["实现调度变量自动调整"]]},"created_time":1671628260288,"last_edited_time":1671628380001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"6AeHoBEbeFOQm3P1xewXHA,\"start\",\"end\"","n":{"6AeHoBEbeFOQm3P1xewXHA,\"start\",\"end\"":{"s":{"x":"6AeHoBEbeFOQm3P1xewXHA","i":[{"t":"s"},{"t":"t","i":["9qVwMjqW3yxu",1],"o":"start","l":10,"c":"实现调度变量自动调整"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"94acd58c-fb0d-4ff6-8b43-28926c2d7d70":{"value":{"id":"94acd58c-fb0d-4ff6-8b43-28926c2d7d70","version":5,"type":"bulleted_list","properties":{"title":[["在每个原基本块最后添加修改 switch 变量值的指令，以便返回分发块之后，能够正确执行到下一个基本块"]]},"created_time":1671628260288,"last_edited_time":1671628260001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"GRqYzNg3iacECgtQC66ffA,\"start\",\"end\"","n":{"GRqYzNg3iacECgtQC66ffA,\"start\",\"end\"":{"s":{"x":"GRqYzNg3iacECgtQC66ffA","i":[{"t":"s"},{"t":"t","i":["HPfMtJNtxNba",1],"o":"start","l":51,"c":"在每个原基本块最后添加修改 switch 变量值的指令，以便返回分发块之后，能够正确执行到下一个基本块"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"55239091-36bd-4553-a546-a9625bcc8a0e":{"value":{"id":"55239091-36bd-4553-a546-a9625bcc8a0e","version":8,"type":"bulleted_list","properties":{"title":[["删除原基本块末尾的跳转，使其结束执行后跳转到返回块"]]},"content":["43d8718b-b696-403d-9698-50d4104ab1b5"],"created_time":1671628260288,"last_edited_time":1671628440001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"wIPHZ3DD0pDo3HEzZJntlA,\"start\",\"end\"","n":{"wIPHZ3DD0pDo3HEzZJntlA,\"start\",\"end\"":{"s":{"x":"wIPHZ3DD0pDo3HEzZJntlA","i":[{"t":"s"},{"t":"t","i":["-r-W4x57DO7l",1],"o":"start","l":25,"c":"删除原基本块末尾的跳转，使其结束执行后跳转到返回块"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"8bd0478a-c697-4510-aa28-79842bfbd2b9":{"value":{"id":"8bd0478a-c697-4510-aa28-79842bfbd2b9","version":12,"type":"text","properties":{"title":[["代码实现："]]},"created_time":1671628440000,"last_edited_time":1671628440001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"MSTMfzoS838lwVYxKBzwkA,\"start\",\"end\"","n":{"MSTMfzoS838lwVYxKBzwkA,\"start\",\"end\"":{"s":{"x":"MSTMfzoS838lwVYxKBzwkA","i":[{"t":"s"},{"t":"t","i":["J3GdduS_RbHu",1],"o":"start","l":5,"c":"代码实现："},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"a3b6b96d-de2d-4804-80fb-e5e3837b27fd":{"value":{"id":"a3b6b96d-de2d-4804-80fb-e5e3837b27fd","version":7,"type":"image","properties":{"source":[["https://thestar0-1308426403.cos.ap-chengdu.myqcloud.com/img/20221220211351.png"]]},"created_time":1671628260287,"last_edited_time":1671628380001,"parent_id":"dfa13954-d40a-4c9e-9f20-a61f5b303f60","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"TgImg1R_TSjCzUqEIBVvYw,\"start\",\"end\"","n":{"TgImg1R_TSjCzUqEIBVvYw,\"start\",\"end\"":{"s":{"x":"TgImg1R_TSjCzUqEIBVvYw","i":[{"t":"s"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"52f52e50-0448-4f5f-b8ed-fd42b246105a":{"value":{"id":"52f52e50-0448-4f5f-b8ed-fd42b246105a","version":7,"type":"image","properties":{"source":[["https://thestar0-1308426403.cos.ap-chengdu.myqcloud.com/img/20221220211610.png"]]},"created_time":1671628260288,"last_edited_time":1671628380001,"parent_id":"a6fe75c4-4797-4418-a689-9c42dad66550","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"JHhz4jliEiNlUi5xXj_nxA,\"start\",\"end\"","n":{"JHhz4jliEiNlUi5xXj_nxA,\"start\",\"end\"":{"s":{"x":"JHhz4jliEiNlUi5xXj_nxA","i":[{"t":"s"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"43d8718b-b696-403d-9698-50d4104ab1b5":{"value":{"id":"43d8718b-b696-403d-9698-50d4104ab1b5","version":4,"type":"image","properties":{"source":[["https://thestar0-1308426403.cos.ap-chengdu.myqcloud.com/img/20221221015624.png"]]},"created_time":1671628260288,"last_edited_time":1671628260001,"parent_id":"55239091-36bd-4553-a546-a9625bcc8a0e","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"IhMYg3BOkxN6EA1pX4-rfQ,\"start\",\"end\"","n":{"IhMYg3BOkxN6EA1pX4-rfQ,\"start\",\"end\"":{"s":{"x":"IhMYg3BOkxN6EA1pX4-rfQ","i":[{"t":"s"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"192cd666-bd00-4076-a8e9-45af3b7a719f":{"value":{"id":"192cd666-bd00-4076-a8e9-45af3b7a719f","version":7,"type":"code","properties":{"title":[["// 第四步，实现调度变量自动调整\nfor (BasicBlock *BB : origBB) // 遍历除入口块之外的所有基本块\n    {\n        if (BB-\u003egetTerminator()-\u003egetNumSuccessors() == 0) // 如果基本块没有后继基本块，则跳过\n        {\n            continue;\n        }\n        else if (BB-\u003egetTerminator()-\u003egetNumSuccessors() == 1) // 如果基本块只有一个后继基本块，则将调度变量的值设置为随机数\n        {\n            // 获取switch指令中的case值\n            ConstantInt *numCase = swInst-\u003efindCaseDest(BB-\u003egetTerminator()-\u003egetSuccessor(0));\n            // 将case值保存到局部变量中\n            new StoreInst(numCase, swVarPtr, BB-\u003egetTerminator());\n            // 删除基本块的跳转指令\n            BB-\u003egetTerminator()-\u003eeraseFromParent();\n            // 在基本块中添加跳转指令，跳转到返回块\n            BranchInst::Create(returnBB, BB);\n        }\n        else if (BB-\u003egetTerminator()-\u003egetNumSuccessors() == 2) // 如果基本块有两个后继基本块，则将调度变量的值设置为随机数\n        {\n            ConstantInt *numCase1 = swInst-\u003efindCaseDest(BB-\u003egetTerminator()-\u003egetSuccessor(0));                    // 获取switch指令中的case值\n            ConstantInt *numCase2 = swInst-\u003efindCaseDest(BB-\u003egetTerminator()-\u003egetSuccessor(1));                    // 获取switch指令中的case值\n            BranchInst *br = cast\u003cBranchInst\u003e(BB-\u003egetTerminator());                                                // 获取基本块的跳转指令\n            SelectInst *sel = SelectInst::Create(br-\u003egetCondition(), numCase1, numCase2, \"\", BB-\u003egetTerminator()); // 创建选择指令\n            new StoreInst(sel, swVarPtr, BB-\u003egetTerminator());                                                     // 将选择指令的结果保存到局部变量中\n            BB-\u003egetTerminator()-\u003eeraseFromParent();                                                                // 删除基本块的跳转指令\n            BranchInst::Create(returnBB, BB);                                                                      // 在基本块中添加跳转指令，跳转到返回块\n        }\n    }\n"]],"language":[["cpp"]]},"format":{"code_wrap":true},"created_time":1671628260288,"last_edited_time":1671628440001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"ejzgKyIpdLbL7oP3Qw6VPQ,\"start\",\"end\"","n":{"ejzgKyIpdLbL7oP3Qw6VPQ,\"start\",\"end\"":{"s":{"x":"ejzgKyIpdLbL7oP3Qw6VPQ","i":[{"t":"s"},{"t":"t","i":["AXRVDhfwlig0",1],"o":"start","l":1739,"c":"// 第四步，实现调度变量自动调整\nfor (BasicBlock *BB : origBB) // 遍历除入口块之外的所有基本块\n    {\n        if (BB-\u003egetTerminator()-\u003egetNumSuccessors() == 0) // 如果基本块没有后继基本块，则跳过\n        {\n            continue;\n        }\n        else if (BB-\u003egetTerminator()-\u003egetNumSuccessors() == 1) // 如果基本块只有一个后继基本块，则将调度变量的值设置为随机数\n        {\n            // 获取switch指令中的case值\n            ConstantInt *numCase = swInst-\u003efindCaseDest(BB-\u003egetTerminator()-\u003egetSuccessor(0));\n            // 将case值保存到局部变量中\n            new StoreInst(numCase, swVarPtr, BB-\u003egetTerminator());\n            // 删除基本块的跳转指令\n            BB-\u003egetTerminator()-\u003eeraseFromParent();\n            // 在基本块中添加跳转指令，跳转到返回块\n            BranchInst::Create(returnBB, BB);\n        }\n        else if (BB-\u003egetTerminator()-\u003egetNumSuccessors() == 2) // 如果基本块有两个后继基本块，则将调度变量的值设置为随机数\n        {\n            ConstantInt *numCase1 = swInst-\u003efindCaseDest(BB-\u003egetTerminator()-\u003egetSuccessor(0));                    // 获取switch指令中的case值\n            ConstantInt *numCase2 = swInst-\u003efindCaseDest(BB-\u003egetTerminator()-\u003egetSuccessor(1));                    // 获取switch指令中的case值\n            BranchInst *br = cast\u003cBranchInst\u003e(BB-\u003egetTerminator());                                                // 获取基本块的跳转指令\n            SelectInst *sel = SelectInst::Create(br-\u003egetCondition(), numCase1, numCase2, \"\", BB-\u003egetTerminator()); // 创建选择指令\n            new StoreInst(sel, swVarPtr, BB-\u003egetTerminator());                                                     // 将选择指令的结果保存到局部变量中\n            BB-\u003egetTerminator()-\u003eeraseFromParent();                                                                // 删除基本块的跳转指令\n            BranchInst::Create(returnBB, BB);                                                                      // 在基本块中添加跳转指令，跳转到返回块\n        }\n    }\n"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"ccf237bc-331b-4ed4-85f5-be7db169ac0c":{"value":{"id":"ccf237bc-331b-4ed4-85f5-be7db169ac0c","version":6,"type":"sub_sub_header","properties":{"title":[["修复 PHI 指令和逃逸变量"]]},"created_time":1671628260288,"last_edited_time":1671628440001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"Ch2iDnh6-7IMd20PG_XuPA,\"start\",\"end\"","n":{"Ch2iDnh6-7IMd20PG_XuPA,\"start\",\"end\"":{"s":{"x":"Ch2iDnh6-7IMd20PG_XuPA","i":[{"t":"s"},{"t":"t","i":["W8JWrDlafl2W",1],"o":"start","l":14,"c":"修复 PHI 指令和逃逸变量"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"011de229-8d91-42d2-826b-93c82bbfbb4c":{"value":{"id":"011de229-8d91-42d2-826b-93c82bbfbb4c","version":5,"type":"bulleted_list","properties":{"title":[["PHI 指令的值由前驱块决定，平坦化后所有原基本块的前驱块都变成了分发块，因此 PHI 指令发生了损坏"]]},"created_time":1671628260288,"last_edited_time":1671628260001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"_H2bwLAb8KYGZf6FFbrgBA,\"start\",\"end\"","n":{"_H2bwLAb8KYGZf6FFbrgBA,\"start\",\"end\"":{"s":{"x":"_H2bwLAb8KYGZf6FFbrgBA","i":[{"t":"s"},{"t":"t","i":["4U-Ef3Zrbe_0",1],"o":"start","l":51,"c":"PHI 指令的值由前驱块决定，平坦化后所有原基本块的前驱块都变成了分发块，因此 PHI 指令发生了损坏"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"d2a9d47e-127c-4668-8e44-0482f8021f0c":{"value":{"id":"d2a9d47e-127c-4668-8e44-0482f8021f0c","version":5,"type":"bulleted_list","properties":{"title":[["逃逸变量指在一个基本块中定义，并且在另一个基本块被引用的变量。在原程序中某些基本块可能引用之前某个基本块中的变量，平坦化后原基本块之间不存在确定的前后关系了（由分发块决定），因此某些变量的引用可能会损坏"]]},"created_time":1671628260288,"last_edited_time":1671628260001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"-yS6cSHGxp8mKXz35VSCxg,\"start\",\"end\"","n":{"-yS6cSHGxp8mKXz35VSCxg,\"start\",\"end\"":{"s":{"x":"-yS6cSHGxp8mKXz35VSCxg","i":[{"t":"s"},{"t":"t","i":["OoYKiJdhW4hg",1],"o":"start","l":101,"c":"逃逸变量指在一个基本块中定义，并且在另一个基本块被引用的变量。在原程序中某些基本块可能引用之前某个基本块中的变量，平坦化后原基本块之间不存在确定的前后关系了（由分发块决定），因此某些变量的引用可能会损坏"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"94fc5a13-aa57-4a77-8ec7-3bb54dab69f0":{"value":{"id":"94fc5a13-aa57-4a77-8ec7-3bb54dab69f0","version":5,"type":"bulleted_list","properties":{"title":[["修复的方法是，将 PHI 指令和逃逸变量都转化为内存存取指令"]]},"created_time":1671628260289,"last_edited_time":1671628260001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"biax5X6bN5hnp_f2ssPYRw,\"start\",\"end\"","n":{"biax5X6bN5hnp_f2ssPYRw,\"start\",\"end\"":{"s":{"x":"biax5X6bN5hnp_f2ssPYRw","i":[{"t":"s"},{"t":"t","i":["LT80lQQZ836M",1],"o":"start","l":30,"c":"修复的方法是，将 PHI 指令和逃逸变量都转化为内存存取指令"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"3dde32d0-5da3-468c-bfa8-701cd880d416":{"value":{"id":"3dde32d0-5da3-468c-bfa8-701cd880d416","version":10,"type":"text","properties":{"title":[["代码实现："]]},"created_time":1671628380000,"last_edited_time":1671628440001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"h3yZscJpqwxyx7kayaALXQ,\"start\",\"end\"","n":{"h3yZscJpqwxyx7kayaALXQ,\"start\",\"end\"":{"s":{"x":"h3yZscJpqwxyx7kayaALXQ","i":[{"t":"s"},{"t":"t","i":["4IC1HfBgMfvT",1],"o":"start","l":5,"c":"代码实现："},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"a4594815-eb8c-4851-9304-bb9ea9c1ac9a":{"value":{"id":"a4594815-eb8c-4851-9304-bb9ea9c1ac9a","version":7,"type":"code","properties":{"title":[["// 第五步修复 PHI 指令和逃逸变量\nvoid llvm::fixStack(Function \u0026F) // 将函数F中的所有PHI指令和逃逸变量转换为栈变量\n{\n    vector\u003cPHINode *\u003e origPHI;               // 保存函数F中的所有PHI指令\n    vector\u003cInstruction *\u003e origReg;           // 保存函数F中的所有逃逸变量\n    BasicBlock \u0026entryBB = F.getEntryBlock(); // 获取函数F的入口块\n    for (BasicBlock \u0026BB : F)                 // 遍历函数F中的所有基本块\n    {\n        for (Instruction \u0026I : BB) // 遍历基本块BB中的所有指令\n        {\n            if (PHINode *PN = dyn_cast\u003cPHINode\u003e(\u0026I)) // 判断指令I是否是PHI指令\n            {\n                origPHI.push_back(PN); // 将PHI指令保存到vector容器中\n            }\n            else if (!(isa\u003cAllocaInst\u003e(\u0026I) \u0026\u0026 I.getParent() == \u0026entryBB) \u0026\u0026 I.isUsedOutsideOfBlock(\u0026BB)) // 判断指令I是否是逃逸变量\n            {\n                origReg.push_back(\u0026I); // 将逃逸变量保存到vector容器中\n            }\n        }\n    }\n\n    for (PHINode *PN : origPHI) // 遍历vector容器中的所有PHI指令\n    {\n        DemotePHIToStack(PN, entryBB.getTerminator()); // 将PHI指令转换为栈变量\n    }\n    for (Instruction *I : origReg) // 遍历vector容器中的所有逃逸变量\n    {\n        DemoteRegToStack(*I, entryBB.getTerminator()); // 将逃逸变量转换为栈变量\n    }\n}\n\n"]],"language":[["cpp"]]},"format":{"code_wrap":true},"created_time":1671628260289,"last_edited_time":1671628380001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"Sc_PGEMvCENsCbQFovesoQ,\"start\",\"end\"","n":{"Sc_PGEMvCENsCbQFovesoQ,\"start\",\"end\"":{"s":{"x":"Sc_PGEMvCENsCbQFovesoQ","i":[{"t":"s"},{"t":"t","i":["syrTXuPsGaT4",1],"o":"start","l":1060,"c":"// 第五步修复 PHI 指令和逃逸变量\nvoid llvm::fixStack(Function \u0026F) // 将函数F中的所有PHI指令和逃逸变量转换为栈变量\n{\n    vector\u003cPHINode *\u003e origPHI;               // 保存函数F中的所有PHI指令\n    vector\u003cInstruction *\u003e origReg;           // 保存函数F中的所有逃逸变量\n    BasicBlock \u0026entryBB = F.getEntryBlock(); // 获取函数F的入口块\n    for (BasicBlock \u0026BB : F)                 // 遍历函数F中的所有基本块\n    {\n        for (Instruction \u0026I : BB) // 遍历基本块BB中的所有指令\n        {\n            if (PHINode *PN = dyn_cast\u003cPHINode\u003e(\u0026I)) // 判断指令I是否是PHI指令\n            {\n                origPHI.push_back(PN); // 将PHI指令保存到vector容器中\n            }\n            else if (!(isa\u003cAllocaInst\u003e(\u0026I) \u0026\u0026 I.getParent() == \u0026entryBB) \u0026\u0026 I.isUsedOutsideOfBlock(\u0026BB)) // 判断指令I是否是逃逸变量\n            {\n                origReg.push_back(\u0026I); // 将逃逸变量保存到vector容器中\n            }\n        }\n    }\n\n    for (PHINode *PN : origPHI) // 遍历vector容器中的所有PHI指令\n    {\n        DemotePHIToStack(PN, entryBB.getTerminator()); // 将PHI指令转换为栈变量\n    }\n    for (Instruction *I : origReg) // 遍历vector容器中的所有逃逸变量\n    {\n        DemoteRegToStack(*I, entryBB.getTerminator()); // 将逃逸变量转换为栈变量\n    }\n}\n\n"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"2c640462-09a9-4c6c-8097-045a95834ae4":{"value":{"id":"2c640462-09a9-4c6c-8097-045a95834ae4","version":27,"type":"sub_header","properties":{"title":[["最终效果"]]},"created_time":1671628440000,"last_edited_time":1671628500001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"0D13OKwh8h2SD4Za_aTifQ,\"start\",\"end\"","n":{"0D13OKwh8h2SD4Za_aTifQ,\"start\",\"end\"":{"s":{"x":"0D13OKwh8h2SD4Za_aTifQ","i":[{"t":"s"},{"t":"t","i":["tlIoVmoePoAc",1],"o":"start","l":4,"c":"最终效果"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"4ea06b32-c1c3-4343-b478-f422857256f3":{"value":{"id":"4ea06b32-c1c3-4343-b478-f422857256f3","version":25,"type":"text","properties":{"title":[["没有加基本块分割实现的控制流平坦化"]]},"created_time":1671628440000,"last_edited_time":1671628800001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"DnnsQuwrlG8v7KmJ4DxZGQ,\"start\",\"end\"","n":{"DnnsQuwrlG8v7KmJ4DxZGQ,\"start\",\"end\"":{"s":{"x":"DnnsQuwrlG8v7KmJ4DxZGQ","i":[{"t":"s"},{"t":"t","i":["9VHgtYElZDTp",1],"o":"start","l":17,"c":"没有加基本块分割实现的控制流平坦化"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"c589226a-c757-484b-be26-03130c7d8419":{"value":{"id":"c589226a-c757-484b-be26-03130c7d8419","version":15,"type":"image","properties":{"size":[["24.9KB"]],"title":[["Untitled"]],"source":[["https://s3-us-west-2.amazonaws.com/secure.notion-static.com/23afbb92-8e3f-40f0-81d4-1a4dff45b70d/Untitled.png"]]},"format":{"block_width":605.9921875,"display_source":"https://s3-us-west-2.amazonaws.com/secure.notion-static.com/23afbb92-8e3f-40f0-81d4-1a4dff45b70d/Untitled.png","block_full_width":false,"block_page_width":true,"block_aspect_ratio":0.7506493506493507,"block_preserve_scale":true},"created_time":1671628740000,"last_edited_time":1749758614265,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"file_ids":["23afbb92-8e3f-40f0-81d4-1a4dff45b70d"],"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"xZDHysWX-hg27wXJjR31mQ,\"start\",\"end\"","n":{"xZDHysWX-hg27wXJjR31mQ,\"start\",\"end\"":{"s":{"x":"xZDHysWX-hg27wXJjR31mQ","i":[{"t":"s"},{"t":"t","i":["tqUr_NGzYJaV",1],"o":"start","l":8,"c":"Untitled"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"2f70a65d-bfd2-409f-99ff-a8cff19a6783":{"value":{"id":"2f70a65d-bfd2-409f-99ff-a8cff19a6783","version":15,"type":"text","properties":{"title":[["加了基本块分割后"]]},"created_time":1671628500000,"last_edited_time":1671628560001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"oiySmWaa9U6FaBmtKJNWxw,\"start\",\"end\"","n":{"oiySmWaa9U6FaBmtKJNWxw,\"start\",\"end\"":{"s":{"x":"oiySmWaa9U6FaBmtKJNWxw","i":[{"t":"s"},{"t":"t","i":["FD2aAiHZJWdj",1],"o":"start","l":8,"c":"加了基本块分割后"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"67941908-3b7e-4218-b28a-06022083e658":{"value":{"id":"67941908-3b7e-4218-b28a-06022083e658","version":14,"type":"image","properties":{"size":[["32.9KB"]],"title":[["Untitled"]],"source":[["https://s3-us-west-2.amazonaws.com/secure.notion-static.com/12736e73-db51-46d8-b1fe-e2ff652ebe15/Untitled.png"]]},"format":{"block_width":605.984375,"display_source":"https://s3-us-west-2.amazonaws.com/secure.notion-static.com/12736e73-db51-46d8-b1fe-e2ff652ebe15/Untitled.png","block_full_width":false,"block_page_width":true,"block_aspect_ratio":0.576961271102284,"block_preserve_scale":true},"created_time":1671628620000,"last_edited_time":1749758614001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"file_ids":["12736e73-db51-46d8-b1fe-e2ff652ebe15"],"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"ZJNSso5-aRDqof_NtM_5-A,\"start\",\"end\"","n":{"ZJNSso5-aRDqof_NtM_5-A,\"start\",\"end\"":{"s":{"x":"ZJNSso5-aRDqof_NtM_5-A","i":[{"t":"s"},{"t":"t","i":["M91pzTpHztoe",1],"o":"start","l":8,"c":"Untitled"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"0f1bbb93-3f59-4b2e-9196-f0ba0b11fdce":{"value":{"id":"0f1bbb93-3f59-4b2e-9196-f0ba0b11fdce","version":7,"type":"text","created_time":1671628440000,"last_edited_time":1671628440001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"EqDTqOaRUX4pxqWhmEROtg,\"start\",\"end\"","n":{"EqDTqOaRUX4pxqWhmEROtg,\"start\",\"end\"":{"s":{"x":"EqDTqOaRUX4pxqWhmEROtg","i":[{"t":"s"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"d8940169-3dff-4b42-ace9-2f93cf4c65c4":{"value":{"id":"d8940169-3dff-4b42-ace9-2f93cf4c65c4","version":6,"type":"text","created_time":1671628440000,"last_edited_time":1671628440001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"mspinV68goUASgs23wDRTg,\"start\",\"end\"","n":{"mspinV68goUASgs23wDRTg,\"start\",\"end\"":{"s":{"x":"mspinV68goUASgs23wDRTg","i":[{"t":"s"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"10691449-c48d-4e68-bd90-51cd0b4b9ef6":{"value":{"id":"10691449-c48d-4e68-bd90-51cd0b4b9ef6","version":5,"type":"sub_header","properties":{"title":[["参考于"]]},"created_time":1671559260000,"last_edited_time":1671628440001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"x4GnJsLxh0rtpHf4ajzvfA,\"start\",\"end\"","n":{"x4GnJsLxh0rtpHf4ajzvfA,\"start\",\"end\"":{"s":{"x":"x4GnJsLxh0rtpHf4ajzvfA","i":[{"t":"s"},{"t":"t","i":["MTUF9O8ror9f",1],"o":"start","l":3,"c":"参考于"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"},"f551174d-597c-4740-abef-8a785c841a85":{"value":{"id":"f551174d-597c-4740-abef-8a785c841a85","version":11,"type":"bookmark","properties":{"link":[["https://www.kanxue.com/book-section_list-88.htm"]],"title":[["LLVM与代码混淆技术 - Android - 看雪学苑-看雪-安全培训|安全招聘|www.kanxue.com"]],"description":[["LLVM与代码混淆技术 - 看雪学苑-看雪-安全培训|安全招聘|www.kanxue.com"]]},"format":{"bookmark_icon":"https://www.kanxue.com/view/img/favicon.ico","bookmark_cover":"https://www.kanxue.com/upload/brief/195.png"},"created_time":1671559260000,"last_edited_time":1671559260001,"parent_id":"eef4533f-2e0e-40aa-b2ad-b859a802825c","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","crdt_format_version":1,"crdt_data":{"title":{"r":"Pv4arFrobLQNln7qAGShlA,\"start\",\"end\"","n":{"Pv4arFrobLQNln7qAGShlA,\"start\",\"end\"":{"s":{"x":"Pv4arFrobLQNln7qAGShlA","i":[{"t":"s"},{"t":"t","i":["932K_w6CTmiD",1],"o":"start","l":56,"c":"LLVM与代码混淆技术 - Android - 看雪学苑-看雪-安全培训|安全招聘|www.kanxue.com"},{"t":"e"}],"l":""},"c":[]}}}}},"role":"reader"}},"collection":{"210b67db-fc9a-8121-bebe-000bb39448db":{"value":{"id":"210b67db-fc9a-8121-bebe-000bb39448db","version":141,"name":[["thestar的博客"]],"description":[["记录所思"]],"schema":{"@NcA":{"name":"password","type":"text"},"Dj]h":{"name":"icon","type":"text"},"NX\\Q":{"name":"date","type":"date","date_format":"YYYY/MM/DD"},"`gQ~":{"name":"type","type":"select","options":[{"id":"5aff2f95-fd1e-489b-8840-bf10bc9519cb","color":"purple","value":"Post","collectionIds":["210b67db-fc9a-8121-bebe-000bb39448db"]},{"id":"374d2bc6-a144-4832-8ca4-474aaae0ea1f","color":"orange","value":"Page","collectionIds":["210b67db-fc9a-8121-bebe-000bb39448db"]},{"id":"95b7fea5-98b3-476e-892f-79e8f36d0633","color":"brown","value":"Notice","collectionIds":["210b67db-fc9a-8121-bebe-000bb39448db"]},{"id":"2287395b-9f64-4852-b46f-ff3df4b4acef","color":"yellow","value":"Menu","collectionIds":["210b67db-fc9a-8121-bebe-000bb39448db"]},{"id":"50fefd65-c28e-4806-9183-aa12995f11f3","color":"pink","value":"SubMenu","collectionIds":["210b67db-fc9a-8121-bebe-000bb39448db"]},{"id":"b945f57d-dbcc-4603-9fab-5cfe447aad1b","color":"red","value":"Config","collectionIds":["210b67db-fc9a-8121-bebe-000bb39448db"]}]},"bB{M":{"name":"category","type":"select","options":[{"id":"c950d411-b38b-4257-9286-9f4713043e3e","color":"green","value":"漏洞分析","collectionIds":["210b67db-fc9a-8121-bebe-000bb39448db"]},{"id":"2a814645-0598-42ce-bc94-8e1c487ca555","color":"default","value":"CTF","collectionIds":["210b67db-fc9a-8121-bebe-000bb39448db"]},{"id":"8e657123-4cac-436f-98e0-b42df17b05c7","color":"blue","value":"二进制安全","collectionIds":["210b67db-fc9a-8121-bebe-000bb39448db"]}]},"d]hq":{"name":"slug","type":"text"},"sD^m":{"name":"tags","type":"multi_select","options":[{"id":"5cf04eea-d134-4783-8d81-af7eb7b32527","color":"pink","value":"任意文件读取漏洞","collectionIds":["210b67db-fc9a-8121-bebe-000bb39448db"]},{"id":"1be2ab44-3920-4ab5-b88b-0ad050d9bd4e","color":"gray","value":"JDBC反序列化漏洞","collectionIds":["210b67db-fc9a-8121-bebe-000bb39448db"]},{"id":"be93e0cf-e936-4e6f-bc34-79fd622707f2","color":"brown","value":"契约锁","collectionIds":["210b67db-fc9a-8121-bebe-000bb39448db"]},{"id":"fe505666-d77e-4577-a8be-4a10bf1b680f","color":"default","value":"Jenkins","collectionIds":["210b67db-fc9a-8121-bebe-000bb39448db"]}]},"wz|S":{"name":"summary","type":"text"},"title":{"name":"title","type":"title"},"f211bdc0-ee00-4186-9a7d-f68c055ec2ee":{"name":"status","type":"select","options":[{"id":"7abc61d4-b405-480d-b699-12588755fa65","color":"red","value":"Published","collectionIds":["210b67db-fc9a-8121-bebe-000bb39448db"]},{"id":"d1242312-e0a8-456d-b8f0-6e998e2c4fb2","color":"orange","value":"Invisible","collectionIds":["210b67db-fc9a-8121-bebe-000bb39448db"]},{"id":"41d5f5c6-b53c-42bc-8e0f-fc9402048480","color":"yellow","value":"Draft","collectionIds":["210b67db-fc9a-8121-bebe-000bb39448db"]}]}},"icon":"notion://custom_emoji/0dd8935a-39f8-4c94-aaf7-d2de23196366/225b67db-fc9a-80fe-9e2f-007add087083","cover":"attachment:de44147d-4cdf-48f2-8ff9-2a64437e928b:Untitled.png","format":{"copied_from_pointer":{"id":"4379bc14-5d22-453b-a153-12639616fc01","table":"collection","spaceId":"6c096b44-beb9-48ee-8f92-1efdde47f3a3"},"property_visibility":[{"property":"`gQ~","visibility":"show"},{"property":"f211bdc0-ee00-4186-9a7d-f68c055ec2ee","visibility":"show"},{"property":"NX\\Q","visibility":"show"},{"property":"d]hq","visibility":"show"},{"property":"wz|S","visibility":"show"},{"property":"sD^m","visibility":"show"},{"property":"bB{M","visibility":"show"},{"property":"Dj]h","visibility":"hide_if_empty"},{"property":"uHoD","visibility":"show"},{"property":"kiCR","visibility":"hide"}],"metadata_copied_from":{"id":"210b67db-fc9a-80ed-8f3f-d06983ba70b2","table":"block","spaceId":"0dd8935a-39f8-4c94-aaf7-d2de23196366"},"collection_cover_position":0.3,"collection_page_properties":[{"visible":false,"property":"`gQ~"},{"visible":false,"property":"f211bdc0-ee00-4186-9a7d-f68c055ec2ee"},{"visible":false,"property":"NX\\Q"},{"visible":false,"property":"d]hq"},{"visible":false,"property":"wz|S"},{"visible":false,"property":"sD^m"},{"visible":true,"property":"bB{M"},{"visible":true,"property":"Dj]h"},{"visible":true,"property":"@NcA"},{"visible":true,"property":"ckw_"}],"collection_default_template":"empty"},"parent_id":"210b67db-fc9a-80ed-8f3f-d06983ba70b2","parent_table":"block","alive":true,"file_ids":["6cf3dc36-2f98-4f0e-9679-1bdbb1485129","5520bd92-e709-4c0d-ad58-06923f23f7e9","624d393a-62e3-4464-a1bf-1c79ecd4fbda","d52f6766-3e32-4c3d-8529-46e1f214360f","abe3a0aa-2aff-4274-81bb-c2443d4ef9e2","a2a32795-101d-46aa-a7f6-eb35b8750166","29db38d2-d5fa-4fa6-8a92-3b527cfe80d1","de44147d-4cdf-48f2-8ff9-2a64437e928b"],"copied_from":"4379bc14-5d22-453b-a153-12639616fc01","template_pages":["210b67db-fc9a-8174-a8f9-c8a18f623a91","26ab67db-fc9a-804a-8d4a-fa6c616d004a"],"migrated":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","deleted_schema":{"9656bdc7-deb5-45a0-88e7-b0de008de665":{"name":"标签","type":"multi_select","options":[{"id":"64cb0961-cc5a-4724-8534-bf8cbd96792a","color":"default","value":"面试"},{"id":"403b6e21-0dd9-4c02-b32c-a577c7ab278e","color":"yellow","value":"代理"},{"id":"33ac8e08-f219-4385-ac3d-db34fbb6516b","color":"blue","value":"AI"},{"id":"1747cfb2-b00b-4454-896a-7c5324b05ceb","color":"brown","value":"工具配置"},{"id":"e9eb621d-a0de-4fb3-8910-4bd8eb36ff09","color":"orange","value":"学习资源"},{"id":"0af0d4cc-357e-4f11-96cb-cfbb695c077b","color":"pink","value":"凭证窃取"},{"id":"ebb76f4c-1e82-4901-8ab7-f9a021bb9b54","color":"red","value":"内网渗透"},{"id":"bb64568b-cdaa-476c-9508-60e35ed7cd82","color":"purple","value":"权限维持"},{"id":"69a228df-e4b1-4f8b-9203-a9cb616f52c2","color":"green","value":"免杀"},{"id":"a518801f-c4eb-4599-8f1c-276cd4d469fb","color":"gray","value":"安全开发"},{"id":"d91c7fad-4315-4baf-9d19-8a754a62d11c","color":"orange","value":"漏洞复现"},{"id":"d4b682c4-da4a-4fc3-a646-4d6ba7f45b62","color":"yellow","value":"漏洞原理"},{"id":"08789408-8f18-411d-ad24-790f71ffb240","color":"pink","value":"渗透测试"}]}},"created_time":1749756363583,"last_edited_time":1763222201717,"created_by_table":"notion_user","created_by_id":"917b4bd9-a4fc-48ad-95f0-8eed14f27ec5","last_edited_by_table":"notion_user","last_edited_by_id":"917b4bd9-a4fc-48ad-95f0-8eed14f27ec5"},"role":"reader"}},"custom_emoji":{"225b67db-fc9a-80fe-9e2f-007add087083":{"value":{"id":"225b67db-fc9a-80fe-9e2f-007add087083","version":1,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","name":"头像","url":"https://s3-us-west-2.amazonaws.com/public.notion-static.com/1a46e89e-d46e-4cb3-8c5f-e95f51548a69/IMG_9104.jpg","created_time":1751573707284,"created_by_id":"917b4bd9-a4fc-48ad-95f0-8eed14f27ec5","created_by_table":"notion_user","alive":true},"role":"reader"}},"collection_view":{"210b67db-fc9a-8140-b9a0-000c10157bd6":{"value":{"id":"210b67db-fc9a-8140-b9a0-000c10157bd6","version":61,"type":"table","name":"表格","format":{"property_filters":[{"id":"751a5e1a-70a0-4089-987a-3670b540b6c8","filter":{"filter":{"value":{"type":"exact"},"operator":"enum_is"},"property":"f211bdc0-ee00-4186-9a7d-f68c055ec2ee"}},{"id":"5b8f22b6-0bee-4124-b984-fdf64509a908","filter":{"filter":{"value":{"type":"exact"},"operator":"enum_is"},"property":"`gQ~"}}],"table_properties":[{"width":100,"visible":true,"property":"`gQ~"},{"width":219,"visible":true,"property":"title"},{"width":288,"visible":true,"property":"wz|S"},{"width":100,"visible":true,"property":"f211bdc0-ee00-4186-9a7d-f68c055ec2ee"},{"width":100,"visible":true,"property":"bB{M"},{"width":141,"visible":true,"property":"sD^m"},{"width":229,"visible":true,"property":"d]hq"},{"width":253,"visible":true,"property":"NX\\Q"},{"width":100,"visible":true,"property":"@NcA"},{"width":117,"visible":true,"property":"Dj]h"}],"collection_pointer":{"id":"210b67db-fc9a-8121-bebe-000bb39448db","table":"collection","spaceId":"0dd8935a-39f8-4c94-aaf7-d2de23196366"},"table_frozen_column_index":-1,"collection_view_default_template":"empty"},"parent_id":"210b67db-fc9a-80ed-8f3f-d06983ba70b2","parent_table":"block","alive":true,"page_sort":["cc459e5b-0f15-4a0c-83db-bb6bf2001aa3","a9bfecc8-9761-4987-9aca-af79d4ebbd0c","7aa40ad8-1e69-4d56-b245-d135d3101cec","e4eefa7d-e2f2-44ed-83f6-fd6951d50900","0f9b7a0d-ad15-4ece-8a8b-948d96b50ff7","58a216ce-4d8d-4b60-906c-6097c5fd8d41","b824f35b-aee9-4a22-81c9-d44b65f99f43","ba565c08-0d2f-46cb-9fcb-5eeface44dfb","560c76dd-c69f-429b-827d-7974407bb23f","0533a861-81cc-40fa-8ab8-5be721800b86","3578fa31-ea0a-4e07-82dc-28704e0dc685","f2625c60-ca69-493b-858c-bf38979f468c","96b14e20-e592-42f6-b7d2-357f4693f18c","fe8fafec-6d1b-4fbb-8a7a-fb079a6bb8e4","9345db3a-b8bd-4e02-b296-9734958eddb6","26e8ddc4-10b4-4765-a96d-e87290556164","840f0871-b58b-428d-8a28-0861947974b4","5787bc4f-06a4-4158-a27f-6c81fb9b1efe","e1bff221-486f-42c8-9cf3-6379f83f3510","2db01777-47d0-4230-bbe8-ef65ab694707","ab0d5acb-9230-4656-9c49-1aff13aba865","98330ff5-71d2-4ea9-945a-ba76fc282e9d","210b67db-fc9a-811d-81e2-fcc41b12fa3d","210b67db-fc9a-81ae-a1ea-c7df4af5e0de","210b67db-fc9a-8128-9dc5-e8655b0083ca","210b67db-fc9a-81fe-82ae-e16f875e1a34","210b67db-fc9a-8175-b45b-d656fdb300b1","210b67db-fc9a-81b4-8fbc-c4a26a9e3520","210b67db-fc9a-812c-95fb-fd8ad06348de","210b67db-fc9a-813b-9281-d1c2c9c0913e","210b67db-fc9a-81e7-a2c3-e585202b80c0","210b67db-fc9a-8162-b7d2-d65b02feef1e","210b67db-fc9a-81b8-8383-fed75abb6683","210b67db-fc9a-81b6-9ede-f15ab087d659","210b67db-fc9a-81d4-8147-ec9b6a097f2a","ce720858-10b7-4c0c-8083-906f29150a81","210b67db-fc9a-818b-b080-e495834c6ed3","210b67db-fc9a-819e-91f5-ebfc587d9bd9","4194acae-3f4b-4c08-98b9-907a0b5bd4b9","210b67db-fc9a-813d-b04e-c6cc9120513a","210b67db-fc9a-811d-bf37-ea7bb7bb89f8","210b67db-fc9a-81a0-9b31-c81ada1d5234","210b67db-fc9a-81d5-9515-e047e4249662","210b67db-fc9a-817d-8747-fe695b029bf8","210b67db-fc9a-811c-a23d-f22a0f965d0c","f3550fb0-346c-4212-b57f-86433738b50b","210b67db-fc9a-81c3-b578-f172beccb2f5","210b67db-fc9a-8182-9b32-d4447de09d9d","210b67db-fc9a-819d-8901-f7e3a94c287f","210b67db-fc9a-81ae-a206-d42cf627b9b8","1ffb90ba-821d-4d16-8520-e46604a470d7","adc7c47b-6dd7-439f-9e06-6075256c91a7","210b67db-fc9a-812c-b633-fda809f7e262","210b67db-fc9a-81cc-8e4e-fc1230d8af35","210b67db-fc9a-81ac-b689-cd063e705208","210b67db-fc9a-81ab-8942-f05a48d44326","210b67db-fc9a-8156-9d18-c1e2bf214696","210b67db-fc9a-81d3-9508-f340444c0ed4","9e017f37-5917-4cda-afb8-92072abdbdba","8aafeb2c-85b4-4c4e-af36-3b9efacb167c","6d0e0705-57f3-4223-8745-a27295245029","dec89a30-7004-499f-a99e-05b2842cad2b","7efc83d4-2645-4578-b588-a9cffb15524a","1769e8de-bebe-4687-a28a-34c15859ed98","203f2c30-a3cd-4f70-95b3-07df9f996428","2a0b435c-6f77-4db8-be6b-831d177bd762","eac01009-c323-46fd-8339-09c282e6597e","c4b37f96-4ab0-4a0b-a16e-55bac3e32990","4ad5c69e-0dab-4d66-b548-360da7d53568","72d89744-ac04-4dd4-be8b-9d629acd7c11","32dc3358-e954-4934-9e71-cf1dfbca5b91","961e45bd-8bed-4ebc-b3d8-1f0e63736d04","26ab67db-fc9a-8052-903e-e266e0b6936b","26ab67db-fc9a-80dd-9148-c71b83bc5de6","26eb67db-fc9a-8005-b53b-e5fc06c69a48","212b67db-fc9a-808c-ae1f-e5a294b9e934","20fb67db-fc9a-8088-9172-e2de1af90222","13ab67db-fc9a-8042-8495-c3c466962833","12eb67db-fc9a-8056-8c41-dbc587108bd8","ad39dd30-fdb2-4fcc-aa48-a8112a6a346a","d56e837c-8e39-4d64-8589-c238a56d8e44","001c5807-161f-4069-a99c-1b57237d2992","b5038df5-153b-4d24-bc61-58013de5ca42","21d5e1a0-7a5d-48ff-998b-6377f7ce7a9f","eef4533f-2e0e-40aa-b2ad-b859a802825c","8cd88b0f-7d1f-4629-bfdc-de0f24de1308","9e3ffb57-ab3e-41d9-9828-91058b154dc2","385cfc11-4eea-4d18-832e-2ff52b908961","c9360c01-070f-4b23-ae03-4e435318a94b","9472ac55-a7d3-4758-b5f9-72c5df574e7f","f5cfb97a-9384-4548-9f51-de7f48c462e9","a3d95fbb-d7c6-440d-873c-f8eac56536cc","9b67c174-1618-43eb-9cf2-bbd771043354","07801026-0504-4b64-bad6-2c86260ef508","bb2f36ec-1ba9-480b-9ab5-b76c19b52d89","20f75995-1829-4fc6-9f33-13b64eb7e0be","5e87101b-0624-4fb6-85a0-deec5bf93aee","3dbbfc68-5579-41eb-afad-7cf5849dfc38","416b6888-102e-41db-a58e-3dd178d5b149","142b67db-fc9a-80cc-9af2-ddd7fd405259","20a3610a-ef40-4386-ae7a-a508909f6e27","2595be8c-a903-4997-884f-2e6eea612429","f036a70a-0a8c-4715-b382-3b70ee00ea05"],"query2":{"sort":[{"property":"NX\\Q","direction":"descending"}],"aggregations":[{"property":"title","aggregator":"count"}]},"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","created_time":1749760576319,"last_edited_time":1763222189565,"created_by_table":"notion_user","created_by_id":"917b4bd9-a4fc-48ad-95f0-8eed14f27ec5"},"role":"reader"},"216b67db-fc9a-80de-96f5-000ce107ba3c":{"value":{"id":"216b67db-fc9a-80de-96f5-000ce107ba3c","version":5,"type":"feed","name":"","format":{"table_properties":[{"width":100,"visible":true,"property":"`gQ~"},{"width":116,"visible":true,"property":"bB{M"},{"width":142,"visible":true,"property":"sD^m"},{"width":219,"visible":true,"property":"title"},{"width":100,"visible":true,"property":"f211bdc0-ee00-4186-9a7d-f68c055ec2ee"},{"width":155,"visible":true,"property":"d]hq"},{"width":352,"visible":true,"property":"wz|S"},{"width":111,"visible":true,"property":"NX\\Q"},{"width":100,"visible":true,"property":"@NcA"},{"width":117,"visible":true,"property":"Dj]h"}],"collection_pointer":{"id":"210b67db-fc9a-8121-bebe-000bb39448db","table":"collection","spaceId":"0dd8935a-39f8-4c94-aaf7-d2de23196366"},"table_subitem_toggle_column":"title"},"parent_id":"210b67db-fc9a-80ed-8f3f-d06983ba70b2","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","created_time":1750262108787,"last_edited_time":1750262114533,"created_by_table":"notion_user","created_by_id":"917b4bd9-a4fc-48ad-95f0-8eed14f27ec5"},"role":"reader"},"210b67db-fc9a-81c8-ad66-000cf4838056":{"value":{"id":"210b67db-fc9a-81c8-ad66-000cf4838056","version":16,"type":"table","name":"配置","format":{"gallery_cover":{"type":"page_content"},"list_properties":[{"visible":true,"property":"NX\\Q"},{"visible":true,"property":"d]hq"},{"visible":true,"property":"f211bdc0-ee00-4186-9a7d-f68c055ec2ee"},{"visible":true,"property":"sD^m"},{"visible":true,"property":"`gQ~"},{"visible":false,"property":"wz|S"},{"visible":false,"property":"bB{M"},{"visible":false,"property":"Dj]h"},{"visible":false,"property":"@NcA"}],"property_filters":[{"id":"b54a6c88-635d-4de4-946e-5a855a1f4069","filter":{"filter":{"value":[{"type":"exact","value":"Notice"},{"type":"exact","value":"Menu"},{"type":"exact","value":"Config"},{"type":"exact","value":"SubMenu"},{"type":"exact","value":"Page"}],"operator":"enum_is"},"property":"`gQ~"}}],"table_properties":[{"width":116,"visible":true,"property":"f211bdc0-ee00-4186-9a7d-f68c055ec2ee"},{"width":118,"visible":true,"property":"`gQ~"},{"width":219,"visible":true,"property":"title"},{"width":326,"visible":true,"property":"d]hq"},{"width":352,"visible":true,"property":"wz|S"},{"width":111,"visible":true,"property":"NX\\Q"},{"width":116,"visible":true,"property":"bB{M"},{"width":142,"visible":true,"property":"sD^m"},{"width":100,"visible":true,"property":"@NcA"},{"width":117,"visible":true,"property":"Dj]h"}],"collection_pointer":{"id":"210b67db-fc9a-8121-bebe-000bb39448db","table":"collection","spaceId":"0dd8935a-39f8-4c94-aaf7-d2de23196366"},"gallery_properties":[{"visible":true,"property":"title"},{"visible":true,"property":"d]hq"},{"visible":true,"property":"`gQ~"},{"visible":true,"property":"f211bdc0-ee00-4186-9a7d-f68c055ec2ee"},{"visible":false,"property":"bB{M"},{"visible":false,"property":"NX\\Q"},{"visible":false,"property":"Dj]h"},{"visible":false,"property":"@NcA"},{"visible":false,"property":"wz|S"},{"visible":false,"property":"sD^m"}],"table_frozen_column_index":-1,"table_subitem_toggle_column":"title"},"parent_id":"210b67db-fc9a-80ed-8f3f-d06983ba70b2","parent_table":"block","alive":true,"page_sort":["c57af74d-b056-4ccf-ba8b-0d7c1f496e10","766e8682-6bba-4fc9-a223-e4c6622a4577","891b5d89-925f-453a-936e-0a8f2f3ac533","97bdadaa-3ff7-405b-9704-722b1fda31d0","a4a12958-73ee-4b60-850a-f7637b944d15","5432042f-e1a2-4f64-b1fe-c0908a49c1d8","5af9ef64-0c34-4637-a509-19f57db26e34","a05d790e-be77-4104-b03b-53208a76f635","b3b70470-4407-4534-9aa5-3a280fcde81f","26ab67db-fc9a-80fc-8b94-c98c499e9fdb","b8231e62-6e8b-4436-b49c-4d4152d83760","cfdd5398-6080-473c-ba92-8ce57c10a557"],"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","created_time":1757512779530,"last_edited_time":1757513472894,"created_by_table":"notion_user","created_by_id":"917b4bd9-a4fc-48ad-95f0-8eed14f27ec5"},"role":"reader"},"210b67db-fc9a-8138-ae5b-000cb5333572":{"value":{"id":"210b67db-fc9a-8138-ae5b-000cb5333572","version":7,"type":"gallery","name":"上传的文章","format":{"gallery_cover":{"type":"page_cover"},"property_filters":[{"id":"e5e69a48-8053-4d20-9e5a-73e8b24dab16","filter":{"filter":{"value":{"type":"exact","value":"Post"},"operator":"enum_is"},"property":"`gQ~"}}],"table_properties":[{"width":100,"visible":true,"property":"`gQ~"},{"width":116,"visible":true,"property":"bB{M"},{"width":142,"visible":true,"property":"sD^m"},{"width":219,"visible":true,"property":"title"},{"width":100,"visible":true,"property":"f211bdc0-ee00-4186-9a7d-f68c055ec2ee"},{"width":155,"visible":true,"property":"d]hq"},{"width":352,"visible":true,"property":"wz|S"},{"width":111,"visible":true,"property":"NX\\Q"},{"width":100,"visible":true,"property":"@NcA"},{"width":117,"visible":true,"property":"Dj]h"}],"collection_groups":[{"value":{"type":"select","value":"心情随笔"},"property":"bB{M"},{"value":{"type":"select","value":"技术分享"},"property":"bB{M"},{"value":{"type":"select","value":"知行合一"},"property":"bB{M"},{"value":{"type":"select"},"hidden":true,"property":"bB{M"}],"collection_pointer":{"id":"210b67db-fc9a-8121-bebe-000bb39448db","table":"collection","spaceId":"0dd8935a-39f8-4c94-aaf7-d2de23196366"},"gallery_properties":[{"visible":true,"property":"title"},{"visible":true,"property":"NX\\Q"},{"visible":true,"property":"f211bdc0-ee00-4186-9a7d-f68c055ec2ee"},{"visible":false,"property":"bB{M"},{"visible":false,"property":"Dj]h"},{"visible":false,"property":"@NcA"},{"visible":false,"property":"d]hq"},{"visible":false,"property":"wz|S"},{"visible":false,"property":"sD^m"},{"visible":false,"property":"`gQ~"}],"collection_group_by":{"sort":{"type":"manual"},"type":"select","property":"bB{M"},"table_subitem_toggle_column":"title","collection_group_aggregation":{"aggregator":"count","enforceMaxAggregationLimit":true}},"parent_id":"210b67db-fc9a-80ed-8f3f-d06983ba70b2","parent_table":"block","alive":true,"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","created_time":1757476396208,"last_edited_time":1757512800981,"created_by_table":"notion_user","created_by_id":"917b4bd9-a4fc-48ad-95f0-8eed14f27ec5"},"role":"reader"},"210b67db-fc9a-81b8-b791-000c44caa07c":{"value":{"id":"210b67db-fc9a-81b8-b791-000c44caa07c","version":3,"type":"board","name":"Post Board","format":{"board_columns":[{"value":{"type":"select","value":"Draft"},"property":"f211bdc0-ee00-4186-9a7d-f68c055ec2ee"},{"value":{"type":"select","value":"Invisible"},"property":"f211bdc0-ee00-4186-9a7d-f68c055ec2ee"},{"value":{"type":"select","value":"Published"},"property":"f211bdc0-ee00-4186-9a7d-f68c055ec2ee"},{"value":{"type":"select"},"property":"f211bdc0-ee00-4186-9a7d-f68c055ec2ee"}],"board_columns_by":{"sort":{"type":"manual"},"type":"select","property":"f211bdc0-ee00-4186-9a7d-f68c055ec2ee"},"board_properties":[{"visible":true,"property":"title"},{"visible":true,"property":"bB{M"},{"visible":true,"property":"sD^m"},{"visible":true,"property":"wz|S"},{"visible":false,"property":"NX\\Q"},{"visible":false,"property":"Dj]h"},{"visible":false,"property":"@NcA"},{"visible":false,"property":"d]hq"},{"visible":false,"property":"f211bdc0-ee00-4186-9a7d-f68c055ec2ee"},{"visible":false,"property":"`gQ~"}],"table_properties":[{"width":100,"visible":true,"property":"`gQ~"},{"width":116,"visible":true,"property":"bB{M"},{"width":142,"visible":true,"property":"sD^m"},{"width":219,"visible":true,"property":"title"},{"width":100,"visible":true,"property":"f211bdc0-ee00-4186-9a7d-f68c055ec2ee"},{"width":155,"visible":true,"property":"d]hq"},{"width":352,"visible":true,"property":"wz|S"},{"width":111,"visible":true,"property":"NX\\Q"},{"width":100,"visible":true,"property":"@NcA"},{"width":117,"visible":true,"property":"Dj]h"}],"collection_pointer":{"id":"210b67db-fc9a-8121-bebe-000bb39448db","table":"collection","spaceId":"0dd8935a-39f8-4c94-aaf7-d2de23196366"},"table_subitem_toggle_column":"title"},"parent_id":"210b67db-fc9a-80ed-8f3f-d06983ba70b2","parent_table":"block","alive":true,"page_sort":["224b67db-fc9a-80fa-adea-ce63867817b4"],"space_id":"0dd8935a-39f8-4c94-aaf7-d2de23196366","created_time":1751454035153,"last_edited_time":1751454035153,"created_by_table":"notion_user","created_by_id":"917b4bd9-a4fc-48ad-95f0-8eed14f27ec5"},"role":"reader"}},"notion_user":{},"collection_query":{},"signed_urls":{"c589226a-c757-484b-be26-03130c7d8419":"https://file.notion.so/f/f/0dd8935a-39f8-4c94-aaf7-d2de23196366/23afbb92-8e3f-40f0-81d4-1a4dff45b70d/Untitled.png?table=block\u0026id=c589226a-c757-484b-be26-03130c7d8419\u0026spaceId=0dd8935a-39f8-4c94-aaf7-d2de23196366\u0026expirationTimestamp=1764532800000\u0026signature=-A3R8Z0hdjbWWoiHKAoqaaBNzmm616svt_3In01mAK8","67941908-3b7e-4218-b28a-06022083e658":"https://file.notion.so/f/f/0dd8935a-39f8-4c94-aaf7-d2de23196366/12736e73-db51-46d8-b1fe-e2ff652ebe15/Untitled.png?table=block\u0026id=67941908-3b7e-4218-b28a-06022083e658\u0026spaceId=0dd8935a-39f8-4c94-aaf7-d2de23196366\u0026expirationTimestamp=1764532800000\u0026signature=mx-CCjWR6HuME0HKREQ548XnyD6hLDzi-Ved7bd35vw"}},"content":["82c80c17-68ab-4b4a-bd37-06859f2bf09a","e29c1f50-8b7c-4067-813d-e5de85c60e9a","d12ca3c2-2a7a-49f7-9e29-88062e0aa8d2","7490f0bc-0c66-4bee-ab0c-afa11469abec","154e85d9-a7a2-4402-9a45-adc47c1cda8e","d22c5e1e-2491-42f5-8501-e9f0c7555745","05e5ed41-38d7-4782-be65-2c1bccbd8350","889ac16c-f4b0-4902-ae84-4117bdbc91f7","393bc37d-ec4a-4a43-ad5d-ccc578be8788","5f063915-141c-46ff-8990-9a74d4ffa08b","7c5be21e-824c-47b7-82ab-296a50dd684f","6aac4fae-bc29-4477-9162-9bf84a9d5593","4e2c97c2-931a-463f-b101-1221548c6309","5caa184a-ab4a-47df-932b-bd408352b93e","2bcaafd7-714b-408e-a1c3-648e6d84febf","9c4638f2-5db4-465a-9e57-7b7e5585411e","144fc6dc-7c0a-4ea6-b71a-d535c100c6f8","54b3f765-d72b-4f2a-82de-1a90d0c86381","d3baf788-11e8-421e-b19c-eb5014efce57","194ece73-097c-4b8f-854b-3d93ce61ee06","a2a73977-8c80-41fa-b819-ffa8fbf53d94","332bbbad-6e8c-4fc2-8894-97f6dab30020","85595a01-6bfb-4235-a0fd-84529741be96","ce5daa84-f04d-4b09-af96-a4591706d59c","c749b321-6a87-4964-9d56-5e591d7b258d","2f5b5e04-a7f6-4274-b440-d6edaadb2082","be88c4b4-2b0c-4d9a-8aed-032e7caccb51","08f9b1b0-dd15-4c6a-bdca-a63f427c0c08","bb2468a1-2977-49ef-a1e5-07e2c69845c4","6a67c94a-cc8c-498d-b2a7-2ca3b058bfb4","a0a5b6f6-d7c8-446e-bde2-f0b74986a766","01930e26-c6c0-47ca-9245-25cd699354d4","03cc1977-8bc2-4e8e-aa90-5c5c3c6e50f0","8d612fbb-8003-43d1-a3c8-d54f79fcd5ff","84ca54d8-ccf8-4109-a529-e4df2bdb21e0","61026fe8-c370-4250-b502-847027f4bb62","c34a1759-3e9f-4227-b48d-75d36e833495","dfa13954-d40a-4c9e-9f20-a61f5b303f60","cb9e79ed-44fd-42fe-8d0f-36fe034c53ea","e0e7ea13-02a8-4f6e-8d18-8772c71518fa","da03cb6c-fac5-47a7-90c1-2c14f34a63ae","417d2443-f9de-42ad-a927-6a2d9385c1d8","438bab14-ab06-4e0a-aaa1-ed43a9045980","a6fe75c4-4797-4418-a689-9c42dad66550","33dc07cf-d09a-4876-8263-0951ee7b4261","2936a124-d3a6-45cb-91ba-2179b7244de5","35c1b440-a2d9-4f71-a417-1ec92bab4e22","94acd58c-fb0d-4ff6-8b43-28926c2d7d70","55239091-36bd-4553-a546-a9625bcc8a0e","8bd0478a-c697-4510-aa28-79842bfbd2b9","192cd666-bd00-4076-a8e9-45af3b7a719f","ccf237bc-331b-4ed4-85f5-be7db169ac0c","011de229-8d91-42d2-826b-93c82bbfbb4c","d2a9d47e-127c-4668-8e44-0482f8021f0c","94fc5a13-aa57-4a77-8ec7-3bb54dab69f0","3dde32d0-5da3-468c-bfa8-701cd880d416","a4594815-eb8c-4851-9304-bb9ea9c1ac9a","2c640462-09a9-4c6c-8097-045a95834ae4","4ea06b32-c1c3-4343-b478-f422857256f3","c589226a-c757-484b-be26-03130c7d8419","2f70a65d-bfd2-409f-99ff-a8cff19a6783","67941908-3b7e-4218-b28a-06022083e658","0f1bbb93-3f59-4b2e-9196-f0ba0b11fdce","d8940169-3dff-4b42-ace9-2f93cf4c65c4","10691449-c48d-4e68-bd90-51cd0b4b9ef6","f551174d-597c-4740-abef-8a785c841a85"],"toc":[{"id":"82c80c17-68ab-4b4a-bd37-06859f2bf09a","type":"sub_header","text":"控制流平坦化是什么","indentLevel":0},{"id":"d22c5e1e-2491-42f5-8501-e9f0c7555745","type":"sub_sub_header","text":"控制流平坦化流程结构","indentLevel":1},{"id":"4e2c97c2-931a-463f-b101-1221548c6309","type":"sub_sub_header","text":"程序流程混淆效果","indentLevel":1},{"id":"54b3f765-d72b-4f2a-82de-1a90d0c86381","type":"sub_sub_header","text":"程序代码混淆效果","indentLevel":1},{"id":"a2a73977-8c80-41fa-b819-ffa8fbf53d94","type":"sub_header","text":"代码实现","indentLevel":0},{"id":"332bbbad-6e8c-4fc2-8894-97f6dab30020","type":"sub_sub_header","text":"实现步骤","indentLevel":1},{"id":"bb2468a1-2977-49ef-a1e5-07e2c69845c4","type":"sub_sub_header","text":"保存原基本块","indentLevel":1},{"id":"84ca54d8-ccf8-4109-a529-e4df2bdb21e0","type":"sub_sub_header","text":"创建分发块和返回块","indentLevel":1},{"id":"da03cb6c-fac5-47a7-90c1-2c14f34a63ae","type":"sub_sub_header","text":"实现分发块调度","indentLevel":1},{"id":"35c1b440-a2d9-4f71-a417-1ec92bab4e22","type":"sub_sub_header","text":"实现调度变量自动调整","indentLevel":1},{"id":"ccf237bc-331b-4ed4-85f5-be7db169ac0c","type":"sub_sub_header","text":"修复 PHI 指令和逃逸变量","indentLevel":1},{"id":"2c640462-09a9-4c6c-8097-045a95834ae4","type":"sub_header","text":"最终效果","indentLevel":0},{"id":"10691449-c48d-4e68-bd90-51cd0b4b9ef6","type":"sub_header","text":"参考于","indentLevel":0}],"wordCount":2161,"readTime":6},"prev":{"id":"274b67db-fc9a-80ee-96bc-cd2f7ebbb79b","date":{"start_date":"2025-11-15"},"type":"Post","category":"漏洞分析","title":"帆软ReportServer RCE漏洞复现 （CNVD-2024-33679）","status":"Published","comment":"","publishDate":1763164800000,"publishDay":"2025-11-15","lastEditedDate":"2025-11-30T13:12:16.624Z","lastEditedDay":"2025-11-30","fullWidth":false,"pageIcon":"","pageCover":"","pageCoverThumbnail":"","ext":{},"tagItems":[],"slug":"article/2025/11/15/274b67db-fc9a-80ee-96bc-cd2f7ebbb79b","href":"/article/2025/11/15/274b67db-fc9a-80ee-96bc-cd2f7ebbb79b","target":"_self","password":""},"next":{"id":"274b67db-fc9a-80ee-96bc-cd2f7ebbb79b","date":{"start_date":"2025-11-15"},"type":"Post","category":"漏洞分析","title":"帆软ReportServer RCE漏洞复现 （CNVD-2024-33679）","status":"Published","comment":"","publishDate":1763164800000,"publishDay":"2025-11-15","lastEditedDate":"2025-11-30T13:12:16.624Z","lastEditedDay":"2025-11-30","fullWidth":false,"pageIcon":"","pageCover":"","pageCoverThumbnail":"","ext":{},"tagItems":[],"slug":"article/2025/11/15/274b67db-fc9a-80ee-96bc-cd2f7ebbb79b","href":"/article/2025/11/15/274b67db-fc9a-80ee-96bc-cd2f7ebbb79b","target":"_self","password":""},"recommendPosts":[]},"__N_SSG":true},"page":"/[prefix]/[slug]/[...suffix]","query":{"prefix":"article","slug":"2022","suffix":["12","21","eef4533f-2e0e-40aa-b2ad-b859a802825c"]},"buildId":"RToBr5HfI6dJkN6UgSld7","runtimeConfig":{"THEMES":["commerce","example","fukasawa","game","gitbook","heo","hexo","landing","magzine","matery","medium","movie","nav","next","nobelium","photo","plog","proxio","simple","starter","typography"]},"isFallback":false,"dynamicIds":[10635,31],"gsp":true,"scriptLoader":[]}</script></body></html>