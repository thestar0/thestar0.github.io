{
    "version": "https://jsonfeed.org/version/1",
    "title": "thestar的博客",
    "home_page_url": "https://thestar0.github.io//",
    "description": "记录所思",
    "author": {
        "name": "thestar",
        "url": "https://thestar0.github.io/"
    },
    "items": [
        {
            "content_html": "<div id=\"notion-article\" class=\"mx-auto overflow-hidden \"><main class=\"notion light-mode notion-page notion-block-2cbb67dbfc9a80a59e34d2ff9dee6f73\"><div class=\"notion-viewport\"></div><div class=\"notion-collection-page-properties\"></div><blockquote class=\"notion-quote notion-block-2cdb67dbfc9a8062b723e7bd3cece99d\"><div>第一时间在le1a大哥的带领下复现了这个漏洞，但过程中遇到很多问题</div></blockquote><h3 class=\"notion-h notion-h2 notion-h-indent-0 notion-block-2cbb67dbfc9a8049bf06d15251674fa5\" data-id=\"2cbb67dbfc9a8049bf06d15251674fa5\"><span><div id=\"2cbb67dbfc9a8049bf06d15251674fa5\" class=\"notion-header-anchor\"></div><a class=\"notion-hash-link\" href=\"#2cbb67dbfc9a8049bf06d15251674fa5\" title=\"漏洞描述\"><svg viewBox=\"0 0 16 16\" width=\"16\" height=\"16\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a><span class=\"notion-h-title\">漏洞描述</span></span></h3><div class=\"notion-text notion-block-2cbb67dbfc9a8083ba73eede057463c9\">TongWeb在处理EJB协议数据的时候，没有对请求的数据进行校验，导致攻击者可以通过构造恶意的反序列化数据在服务器上执行任意代码。</div><h3 class=\"notion-h notion-h2 notion-h-indent-0 notion-block-2cbb67dbfc9a80599b5ec878c2a3551b\" data-id=\"2cbb67dbfc9a80599b5ec878c2a3551b\"><span><div id=\"2cbb67dbfc9a80599b5ec878c2a3551b\" class=\"notion-header-anchor\"></div><a class=\"notion-hash-link\" href=\"#2cbb67dbfc9a80599b5ec878c2a3551b\" title=\"影响版本\"><svg viewBox=\"0 0 16 16\" width=\"16\" height=\"16\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a><span class=\"notion-h-title\">影响版本</span></span></h3><div class=\"notion-text notion-block-2cbb67dbfc9a80f7a024f2f5c352e917\">7.0.0.0&lt;=TongWeb&lt;=7.0.4.9_M9</div><div class=\"notion-text notion-block-2cbb67dbfc9a80859289c948a390a987\">6.1.7.0&lt;=TongWeb&lt;=6.1.8.13</div><h3 class=\"notion-h notion-h2 notion-h-indent-0 notion-block-2cbb67dbfc9a8078b2e2df237436c008\" data-id=\"2cbb67dbfc9a8078b2e2df237436c008\"><span><div id=\"2cbb67dbfc9a8078b2e2df237436c008\" class=\"notion-header-anchor\"></div><a class=\"notion-hash-link\" href=\"#2cbb67dbfc9a8078b2e2df237436c008\" title=\"环境搭建\"><svg viewBox=\"0 0 16 16\" width=\"16\" height=\"16\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a><span class=\"notion-h-title\">环境搭建</span></span></h3><div class=\"notion-text notion-block-2cbb67dbfc9a800da17cf21b7f4de121\">先安装jdk然后<code class=\"notion-inline-code\">./Install_TW7.0.4.x_Enterprise_Linux.bin</code>,一直回车即可，然后将<code class=\"notion-inline-code\">license.dat</code>文件放在安装的<code class=\"notion-inline-code\">TongWeb7.0</code> 目录下 </div><div class=\"notion-text notion-block-2cbb67dbfc9a80a28f86df7e10581689\">如果<code class=\"notion-inline-code\">license.dat </code>文件过期，需要修改时间为下面的标准：</div><div class=\"notion-blank notion-block-2ccb67dbfc9a808e8ae1f1f08441ad33\"> </div><div class=\"notion-text notion-block-2ccb67dbfc9a80b9a07cd6c8fceba384\">http://IP:9060/console/</div><div class=\"notion-text notion-block-2ccb67dbfc9a808c8080f4157e794610\">默认账号：thanos\n默认密码：<a target=\"_blank\" rel=\"noopener noreferrer\" class=\"notion-link\" href=\"http://thanos123.com/\">thanos123.com</a></div><h3 class=\"notion-h notion-h2 notion-h-indent-0 notion-block-2cbb67dbfc9a80d9addff7a7578d1ba8\" data-id=\"2cbb67dbfc9a80d9addff7a7578d1ba8\"><span><div id=\"2cbb67dbfc9a80d9addff7a7578d1ba8\" class=\"notion-header-anchor\"></div><a class=\"notion-hash-link\" href=\"#2cbb67dbfc9a80d9addff7a7578d1ba8\" title=\"代码分析\"><svg viewBox=\"0 0 16 16\" width=\"16\" height=\"16\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a><span class=\"notion-h-title\">代码分析</span></span></h3><div class=\"notion-text notion-block-2cbb67dbfc9a80bfac87e8eb5278ef45\">从官方下载补丁：</div><div class=\"notion-text notion-block-2cbb67dbfc9a80ed9d11ca71696cdd47\"><a target=\"_blank\" rel=\"noopener noreferrer\" class=\"notion-link\" href=\"https://www.tongtech.com/dft/download.html\">https://www.tongtech.com/dft/download.html</a></div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2cbb67dbfc9a80a2b4d7ea83fbf5e2dc\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3A37026b39-8001-48ad-a55e-641adc6bef3b%3Aimage.png?table=block&amp;id=2cbb67db-fc9a-80a2-b4d7-ea83fbf5e2dc&amp;t=2cbb67db-fc9a-80a2-b4d7-ea83fbf5e2dc\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><div class=\"notion-blank notion-block-2cbb67dbfc9a8035b9ebc9e9030f3c0f\"> </div><div class=\"notion-text notion-block-2cbb67dbfc9a80c3912dd38f369abfc5\">通过反编译补丁包和查看加固文档找到漏洞接口，也就是入口点：</div><div class=\"notion-text notion-block-2cbb67dbfc9a8062b6eec0854acd183b\"><code class=\"notion-inline-code\">com.tongweb.tongejb.server.httpd.ServerServlet.class</code> </div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2cbb67dbfc9a80568e05c0a2fa9aa78c\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3A3f7f26c8-07aa-4bb9-a418-626fac1e0b65%3A2025-12-16-16-41-322x.png?table=block&amp;id=2cbb67db-fc9a-8056-8e05-c0a2fa9aa78c&amp;t=2cbb67db-fc9a-8056-8e05-c0a2fa9aa78c\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2cbb67dbfc9a808998b1e6a8d6e53c72\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3Aa6f5a8d8-70bf-49ab-b42c-8216716627ee%3A2025-12-16-16-40-522x.png?table=block&amp;id=2cbb67db-fc9a-8089-98b1-e6a8d6e53c72&amp;t=2cbb67db-fc9a-8089-98b1-e6a8d6e53c72\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><div class=\"notion-text notion-block-2cbb67dbfc9a8026a9e3f6b9d88a742b\">拿到漏洞接口后尝试，在<code class=\"notion-inline-code\">/applications/heimdall/WEB-INF/web.xml</code>里面找到了<code class=\"notion-inline-code\">url</code>映射</div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2cbb67dbfc9a808888ece12c4e1b1738\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3A004fd915-821e-4cde-9a1a-ea511bcbb3e0%3A2025-11-13-22-15-462x.png?table=block&amp;id=2cbb67db-fc9a-8088-88ec-e12c4e1b1738&amp;t=2cbb67db-fc9a-8088-88ec-e12c4e1b1738\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><div class=\"notion-text notion-block-2cbb67dbfc9a80f6a033d621ecb7955d\">然后找到<code class=\"notion-inline-code\">ServerServlet</code>对应的类为：<code class=\"notion-inline-code\">com.tongweb.tongejb.server.httpd.ServerServlet</code></div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2cbb67dbfc9a802fb76adadf1ab6ecad\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3A26b03934-ae41-4da8-a616-a505ef7e5df8%3A2025-11-13-22-17-592x.png?table=block&amp;id=2cbb67db-fc9a-802f-b76a-dadf1ab6ecad&amp;t=2cbb67db-fc9a-802f-b76a-dadf1ab6ecad\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><h4 class=\"notion-h notion-h3 notion-h-indent-1 notion-block-2ccb67dbfc9a8043ab7afc45674afc21\" data-id=\"2ccb67dbfc9a8043ab7afc45674afc21\"><span><div id=\"2ccb67dbfc9a8043ab7afc45674afc21\" class=\"notion-header-anchor\"></div><a class=\"notion-hash-link\" href=\"#2ccb67dbfc9a8043ab7afc45674afc21\" title=\"Source→Sink\"><svg viewBox=\"0 0 16 16\" width=\"16\" height=\"16\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a><span class=\"notion-h-title\">Source→Sink</span></span></h4><div class=\"notion-text notion-block-2cbb67dbfc9a80929800e894660a2370\">进入到<code class=\"notion-inline-code\">ServerServlet</code>类后，重点看处理请求的方法 <code class=\"notion-inline-code\">com.tongweb.tongejb.server.httpd.ServerServlet#service</code></div><div class=\"notion-text notion-block-2cbb67dbfc9a804eb1f2fa86f4594e1d\">跟进<code class=\"notion-inline-code\">com.tongweb.tongejb.server.ejbd.EjbServer#service</code>,这个里面的<code class=\"notion-inline-code\">service</code>调用了</div><div class=\"notion-text notion-block-2cbb67dbfc9a8079ac95e1ebaf6076b6\"><code class=\"notion-inline-code\">this.server.service(inputStream, outputStream);</code></div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2ccb67dbfc9a8084bed9c1721dde7f63\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3Afb1efa0b-8d30-45c0-99aa-21653934da07%3A2025-12-17-09-45-552x.png?table=block&amp;id=2ccb67db-fc9a-8084-bed9-c1721dde7f63&amp;t=2ccb67db-fc9a-8084-bed9-c1721dde7f63\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><div class=\"notion-text notion-block-2cbb67dbfc9a8037b3cfc46b59ccb0d4\">继续跟入<code class=\"notion-inline-code\">com.tongweb.tongejb.server.ejbd.EjbDaemon#service</code></div><div class=\"notion-text notion-block-2cbb67dbfc9a8029a05bd17eb8b67a78\">这是一个服务器端通信服务方法，专门用于处理来自 EJB 客户端的请求：</div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2ccb67dbfc9a8085b6b0c61a5459c93b\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3Ad0167253-e902-474f-80a1-c7e51ebb10a0%3A2025-12-17-09-52-392x.png?table=block&amp;id=2ccb67db-fc9a-8085-b6b0-c61a5459c93b&amp;t=2ccb67db-fc9a-8085-b6b0-c61a5459c93b\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><div class=\"notion-text notion-block-2cbb67dbfc9a805da0bffdc724c6ac47\">跟进 <code class=\"notion-inline-code\">com.tongweb.tongejb.client.ProtocolMetaData</code> 这个类主要初始化以及配置客户端的协议头</div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2ccb67dbfc9a8074b322e1f5a80cfe83\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3Aba76902d-ca71-480c-8542-6347e9a1d3e3%3A2025-12-17-10-03-122x.png?table=block&amp;id=2ccb67db-fc9a-8074-b322-e1f5a80cfe83&amp;t=2ccb67db-fc9a-8074-b322-e1f5a80cfe83\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2ccb67dbfc9a809985a0fcaf62651d99\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3Ae3c41f5d-739e-43fd-8062-b69b116e83a0%3A2025-12-17-10-08-222x.png?table=block&amp;id=2ccb67db-fc9a-8099-85a0-fcaf62651d99&amp;t=2ccb67db-fc9a-8099-85a0-fcaf62651d99\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><div class=\"notion-text notion-block-2ccb67dbfc9a80c082a1fcb6f49fa138\">只有协议头格式为 <code class=\"notion-inline-code\">OEJP/x.x</code> ，客户端的输入流才能被服务端反序列化，否则，会在服务端反序列化前异常退出</div><div class=\"notion-text notion-block-2ccb67dbfc9a803e9f69e49e196d8ef3\">需要注意的是新老版本协议头不一样</div><div class=\"notion-text notion-block-2ccb67dbfc9a80aa98ceda0fdab26830\">在7.0.4.9中<code class=\"notion-inline-code\">writeExternal</code>和<code class=\"notion-inline-code\">readExternal</code> 内容被置空，所以可以不需要这8个字节的协议头了</div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2ccb67dbfc9a80a485eec875eb18f6e9\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3A3557646f-396e-4653-809d-1e2014720664%3A2025-12-17-23-14-522x.png?table=block&amp;id=2ccb67db-fc9a-80a4-85ee-c875eb18f6e9&amp;t=2ccb67db-fc9a-80a4-85ee-c875eb18f6e9\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><div class=\"notion-text notion-block-2ccb67dbfc9a8090a7e6e94f14a80c1a\">看完客户端如何配置协议头后，继续往下看服务端是如何进行对 EJB 客户端传入的输入流进行反序列化操作的</div><div class=\"notion-text notion-block-2ccb67dbfc9a8097b33ef101525558e9\">跟进 <code class=\"notion-inline-code\">com.tongweb.tongejb.client.ServerMetaData</code> 这个类</div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2ccb67dbfc9a80d3b5a2cb1729cbc3f8\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3A4d987647-a9c9-4fe3-95f1-43ef03a68d27%3A2025-12-17-10-31-582x.png?table=block&amp;id=2ccb67db-fc9a-80d3-b5a2-cb1729cbc3f8&amp;t=2ccb67db-fc9a-80d3-b5a2-cb1729cbc3f8\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><div class=\"notion-text notion-block-2cbb67dbfc9a80278d2fe6e6fdc36738\">继续看这个类实现的接口方法，<code class=\"notion-inline-code\">this.locations = (URI[])in.readObject();</code> 这个sink点就是 360 发的漏洞公告截图没有回显的sink点</div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2ccb67dbfc9a80dcb3e1d6b57139d662\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3A0cbc1a2a-bacc-49c7-954d-c2d72603f8a0%3A2025-12-17-10-39-162x.png?table=block&amp;id=2ccb67db-fc9a-80dc-b3e1-d6b57139d662&amp;t=2ccb67db-fc9a-80dc-b3e1-d6b57139d662\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><div class=\"notion-text notion-block-2ccb67dbfc9a8016ab90dfa8bb695418\">所以此 sink点要被触发，需要满足如下的条件（懒得画图，直接用现成的，yinsel师傅画的图）</div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2ccb67dbfc9a80c0b00dfb519e72c7c2\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3Ab23b1459-c2c5-4f84-886e-d16c46ea622f%3A2025-12-17-10-51-292x.png?table=block&amp;id=2ccb67db-fc9a-80c0-b00d-fb519e72c7c2&amp;t=2ccb67db-fc9a-80c0-b00d-fb519e72c7c2\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><div class=\"notion-text notion-block-2ccb67dbfc9a800e8b48cb6b7e420f4a\">后续就直接打反序列化链了</div><div class=\"notion-blank notion-block-2ccb67dbfc9a80a481b7d14dd5088903\"> </div><div class=\"notion-text notion-block-2ccb67dbfc9a8052bde4efa8bf4bbb19\">通过网盘分享的文件：tabby-tongweb7.0.4.2+jdk1.8.0_431.zip\n链接: <a target=\"_blank\" rel=\"noopener noreferrer\" class=\"notion-link\" href=\"https://pan.baidu.com/s/1zeJ3jJqKjve8V2ciTMAwxw?pwd=t6a2\">https://pan.baidu.com/s/1zeJ3jJqKjve8V2ciTMAwxw?pwd=t6a2</a> 提取码: t6a2\n--来自百度网盘超级会员v4的分享</div><div class=\"notion-text notion-block-2ccb67dbfc9a80449d25c290ba6234a6\">使用tabby跑路径，上面这个source→sink的路径如图所示：</div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2cbb67dbfc9a807fb604f4d764e4ba0e\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3A688ddf35-4122-4416-bf4a-1023ddcc7411%3A2025-12-16-21-10-092x.png?table=block&amp;id=2cbb67db-fc9a-807f-b604-f4d764e4ba0e&amp;t=2cbb67db-fc9a-807f-b604-f4d764e4ba0e\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><div class=\"notion-text notion-block-2ccb67dbfc9a80bea42ff518c0005c56\">看到上面这个图，发现从入口到反序列化点总共有八条路径，除了刚才这个最简单的路径以外，还有下面这一条可达路径，这就是为什么长亭的漏洞公告数据包截图有回显的原因</div><div class=\"notion-text notion-block-2ccb67dbfc9a804885bed381a6626e17\">这条可达路径如下图所示：</div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2ccb67dbfc9a803482d7c21ed841a508\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3Aaf17d3c5-fb30-4fae-846b-97b7cb03540e%3A2025-12-17-11-10-312x.png?table=block&amp;id=2ccb67db-fc9a-8034-82d7-c21ed841a508&amp;t=2ccb67db-fc9a-8034-82d7-c21ed841a508\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><div class=\"notion-text notion-block-2ccb67dbfc9a80d6a906fdd0e178aafd\">在 <code class=\"notion-inline-code\">com.tongweb.tongejb.server.ejbd.EjbDaemon#service</code> 方法的下面还有一段处理requestType的代码</div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2ccb67dbfc9a80299bdbdd9a87a8eb4b\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3A7fb5a708-1e2c-4ae8-9be8-4a5ba59de82c%3A2025-12-17-22-39-462x.png?table=block&amp;id=2ccb67db-fc9a-8029-9bdb-dd9a87a8eb4b&amp;t=2ccb67db-fc9a-8029-9bdb-dd9a87a8eb4b\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><div class=\"notion-text notion-block-2ccb67dbfc9a80b380e3fd80d61df89e\">EJB_REQUEST对应的是(byte)0</div><div class=\"notion-text notion-block-2ccb67dbfc9a8073b326cdc5e7f3406b\">跟进<code class=\"notion-inline-code\">this.processEjbRequest</code></div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2ccb67dbfc9a8061a873d1d2bc4c0d9b\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3Ad75fb610-7de5-487a-a100-e4727b7be7c0%3A2025-12-17-22-41-202x.png?table=block&amp;id=2ccb67db-fc9a-8061-a873-d1d2bc4c0d9b&amp;t=2ccb67db-fc9a-8061-a873-d1d2bc4c0d9b\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><div class=\"notion-text notion-block-2ccb67dbfc9a80a88c06ed5c787f9bcb\">继续跟进<code class=\"notion-inline-code\">this.ejbHandler.processRequest(in, metaData);</code></div><div class=\"notion-text notion-block-2ccb67dbfc9a805591fcfa5baf67fd9f\">发现RequestHandler抽象类实现了一个抽象方法，用于请求处理，我们看一下实现方法，找到处理 EJB 请求的<code class=\"notion-inline-code\">EjbRequestHandler</code>类，这个类继承了这个抽象类</div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2ccb67dbfc9a808a9eeec0222a5e1610\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3Ae6299759-d6fe-405b-a7ec-58849d74b6ef%3A2025-12-17-22-42-512x.png?table=block&amp;id=2ccb67db-fc9a-808a-9eee-c0222a5e1610&amp;t=2ccb67db-fc9a-808a-9eee-c0222a5e1610\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><div class=\"notion-text notion-block-2ccb67dbfc9a806abd0eeb728a8cc3e9\">跟进<code class=\"notion-inline-code\">EjbRequestHandler</code>这个处理 EJB 请求的类</div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2ccb67dbfc9a80d69bdbd3f2c78bc49f\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3A0931b04e-31e1-40c0-b1ca-4afdc3f73734%3A2025-12-17-22-45-432x.png?table=block&amp;id=2ccb67db-fc9a-80d6-9bdb-d3f2c78bc49f&amp;t=2ccb67db-fc9a-80d6-9bdb-d3f2c78bc49f\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><div class=\"notion-text notion-block-2ccb67dbfc9a80ee9670f02cebe6666d\">初始化阶段获取了 EJB 请求和版本号，继续跟进<code class=\"notion-inline-code\">req.readExternal(in);</code> 就找到了第二个sink点</div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2ccb67dbfc9a80e0badadbb4da063077\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3A0de959c0-fcd8-44cd-88a7-989e6e9f9478%3A2025-12-17-22-57-242x.png?table=block&amp;id=2ccb67db-fc9a-80e0-bada-dbb4da063077&amp;t=2ccb67db-fc9a-80e0-bada-dbb4da063077\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><div class=\"notion-text notion-block-2ccb67dbfc9a809fbd01d018036cc76c\">如下code为有效的code</div><div class=\"notion-text notion-block-2ccb67dbfc9a8019bbeafdab36fe33d9\">不过还需要注意的是，第二个sink点在第一个sink点后面，所以需要先走过第一个反序列化方法也就是那个成员变量<code class=\"notion-inline-code\">locations</code>,也就是URI[]类型的数组</div><div class=\"notion-text notion-block-2ccb67dbfc9a802894dad3ac3b89a236\">所以最终需要构造如下序列化数据</div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2ccb67dbfc9a80558707ceffbc3796d9\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3A3d1dda26-2092-4800-869b-c18c27e626e0%3A2025-12-17-23-02-572x.png?table=block&amp;id=2ccb67db-fc9a-8055-8707-ceffbc3796d9&amp;t=2ccb67db-fc9a-8055-8707-ceffbc3796d9\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><div class=\"notion-blank notion-block-2ccb67dbfc9a80e4afc0f8fbe4e68852\"> </div><h4 class=\"notion-h notion-h3 notion-h-indent-1 notion-block-2ccb67dbfc9a80489300dd22ac999aea\" data-id=\"2ccb67dbfc9a80489300dd22ac999aea\"><span><div id=\"2ccb67dbfc9a80489300dd22ac999aea\" class=\"notion-header-anchor\"></div><a class=\"notion-hash-link\" href=\"#2ccb67dbfc9a80489300dd22ac999aea\" title=\"gadget\"><svg viewBox=\"0 0 16 16\" width=\"16\" height=\"16\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a><span class=\"notion-h-title\">gadget</span></span></h4><div class=\"notion-text notion-block-2ccb67dbfc9a80098c03e169757c39c2\">知道了反序列化漏洞，现在只需要找到反序列化链，就能执行任意代码了</div><div class=\"notion-text notion-block-2ccb67dbfc9a80f38e25f0f8cdd7c8f5\">7.0.4.9的黑名单在这个类：<code class=\"notion-inline-code\">com.tongweb.serializer.kryo.io.BlacklistClassResolver</code></div><div class=\"notion-text notion-block-2ccb67dbfc9a804698edd46ee92eb386\">所以能用的链有如下这些,在java-chains都能找到（java-chains还是太权威了）：</div><div class=\"notion-blank notion-block-2ccb67dbfc9a807ab938f689b02c05c4\"> </div><div class=\"notion-text notion-block-2ccb67dbfc9a800baff1d996bdaa7442\">下面这两条链是看到公众号有师傅跑了一下，于是也用tabby跑了一下，跑的tongweb7.0.4.2和jdk1.8.0_431</div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2ccb67dbfc9a805883ddcc0e5385d92f\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3A7fb9b882-e400-4ccf-ab8d-dfa7672a6596%3A2025-12-17-23-33-132x.png?table=block&amp;id=2ccb67db-fc9a-8058-83dd-cc0e5385d92f&amp;t=2ccb67db-fc9a-8058-83dd-cc0e5385d92f\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><div class=\"notion-blank notion-block-2cbb67dbfc9a80ee93c9f6c716d746c5\"> </div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2cbb67dbfc9a807ab8f1d1471f190039\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3A102d6b16-103c-4226-9ed0-08ff2eb8795b%3Agraph_(1).png?table=block&amp;id=2cbb67db-fc9a-807a-b8f1-d1471f190039&amp;t=2cbb67db-fc9a-807a-b8f1-d1471f190039\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><div class=\"notion-blank notion-block-2ccb67dbfc9a80d692d3c7efb6e525bd\"> </div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2ccb67dbfc9a80afa5b3d59a250ef126\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3A3a5ee2d2-99b4-4d53-9ae6-bad7e8e194c5%3A2025-12-17-23-34-272x.png?table=block&amp;id=2ccb67db-fc9a-80af-a5b3-d59a250ef126&amp;t=2ccb67db-fc9a-80af-a5b3-d59a250ef126\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2cbb67dbfc9a80a9b0def2fc94b62fc9\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3A628ffee9-b468-43d6-9cc0-274773a62b56%3Agraph.png?table=block&amp;id=2cbb67db-fc9a-80a9-b0de-f2fc94b62fc9&amp;t=2cbb67db-fc9a-80a9-b0de-f2fc94b62fc9\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><div class=\"notion-blank notion-block-2ccb67dbfc9a80cdbcbef7b0a9a64e5f\"> </div><div class=\"notion-text notion-block-2ccb67dbfc9a807bae2dfbcebe27c3d0\">7.0.4.9能打的链在这个文章有说明：</div><div class=\"notion-text notion-block-2ccb67dbfc9a80d192dac506e9c426b3\"><a target=\"_blank\" rel=\"noopener noreferrer\" class=\"notion-link\" href=\"https://xz.aliyun.com/news/14169\">https://xz.aliyun.com/news/14169</a></div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2ccb67dbfc9a808288aedad9f2dd3013\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3A2e9d9be6-b2a8-49e5-be3c-75b4c8f7c8fb%3A2025-12-17-23-35-302x.png?table=block&amp;id=2ccb67db-fc9a-8082-88ae-dad9f2dd3013&amp;t=2ccb67db-fc9a-8082-88ae-dad9f2dd3013\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><div class=\"notion-text notion-block-2ccb67dbfc9a806cb260fce5db674561\">待补充：</div><h3 class=\"notion-h notion-h2 notion-h-indent-0 notion-block-2cbb67dbfc9a80a9b9c1e17d08605356\" data-id=\"2cbb67dbfc9a80a9b9c1e17d08605356\"><span><div id=\"2cbb67dbfc9a80a9b9c1e17d08605356\" class=\"notion-header-anchor\"></div><a class=\"notion-hash-link\" href=\"#2cbb67dbfc9a80a9b9c1e17d08605356\" title=\"漏洞复现\"><svg viewBox=\"0 0 16 16\" width=\"16\" height=\"16\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a><span class=\"notion-h-title\">漏洞复现</span></span></h3><div class=\"notion-text notion-block-2ccb67dbfc9a80cc8b7ae2a27734c666\">使用java-chains生成字节码</div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2ccb67dbfc9a8038bf35fb19977022d9\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3A7d9fbe54-89d8-431c-bd49-8caaab64ef72%3A2025-12-17-23-26-142x.png?table=block&amp;id=2ccb67db-fc9a-8038-bf35-fb19977022d9&amp;t=2ccb67db-fc9a-8038-bf35-fb19977022d9\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><div class=\"notion-text notion-block-2ccb67dbfc9a80a28037f9c05805d5d4\">这里的自定义字节码，要去memshellparty选择TongWeb 7，如果使用jmg的TongWeb字节码会有问题，猜测可能是jmg的TongWeb字节码是没有对TongWeb版本细分进行适配</div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2ccb67dbfc9a80bab89bfaa3af8d6312\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3Acaf2380e-0cab-48b7-b8c1-965b83c44474%3A2025-12-17-23-23-292x.png?table=block&amp;id=2ccb67db-fc9a-80ba-b89b-faa3af8d6312&amp;t=2ccb67db-fc9a-80ba-b89b-faa3af8d6312\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2ccb67dbfc9a803db86efdcf4ee95936\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3Add293a20-9c9c-478f-92c2-81785b3684a1%3A2025-12-17-23-23-072x.png?table=block&amp;id=2ccb67db-fc9a-803d-b86e-fdcf4ee95936&amp;t=2ccb67db-fc9a-803d-b86e-fdcf4ee95936\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><h3 class=\"notion-h notion-h2 notion-h-indent-0 notion-block-2cbb67dbfc9a801cb4a5d5af5daaa364\" data-id=\"2cbb67dbfc9a801cb4a5d5af5daaa364\"><span><div id=\"2cbb67dbfc9a801cb4a5d5af5daaa364\" class=\"notion-header-anchor\"></div><a class=\"notion-hash-link\" href=\"#2cbb67dbfc9a801cb4a5d5af5daaa364\" title=\"武器化\"><svg viewBox=\"0 0 16 16\" width=\"16\" height=\"16\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a><span class=\"notion-h-title\">武器化</span></span></h3><div class=\"notion-text notion-block-2cbb67dbfc9a80b8a490fbc76e95d3af\">java-chains插件（yinsel✅）</div><div class=\"notion-text notion-block-2cbb67dbfc9a80f38eebf4d2cfc4a7e9\">woodpecker插件（）</div><h3 class=\"notion-h notion-h2 notion-h-indent-0 notion-block-2cbb67dbfc9a80b9a446d760ab2e5588\" data-id=\"2cbb67dbfc9a80b9a446d760ab2e5588\"><span><div id=\"2cbb67dbfc9a80b9a446d760ab2e5588\" class=\"notion-header-anchor\"></div><a class=\"notion-hash-link\" href=\"#2cbb67dbfc9a80b9a446d760ab2e5588\" title=\"后渗透\"><svg viewBox=\"0 0 16 16\" width=\"16\" height=\"16\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a><span class=\"notion-h-title\">后渗透</span></span></h3><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2ccb67dbfc9a8068b2a0f28bafd08c06\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3Abeb668e0-4be4-4bcb-b76d-62fb22579c85%3A2025-12-17-23-54-322x.png?table=block&amp;id=2ccb67db-fc9a-8068-b2a0-f28bafd08c06&amp;t=2ccb67db-fc9a-8068-b2a0-f28bafd08c06\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><h3 class=\"notion-h notion-h2 notion-h-indent-0 notion-block-2cbb67dbfc9a803fa3cffdf700f476be\" data-id=\"2cbb67dbfc9a803fa3cffdf700f476be\"><span><div id=\"2cbb67dbfc9a803fa3cffdf700f476be\" class=\"notion-header-anchor\"></div><a class=\"notion-hash-link\" href=\"#2cbb67dbfc9a803fa3cffdf700f476be\" title=\"总结\"><svg viewBox=\"0 0 16 16\" width=\"16\" height=\"16\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a><span class=\"notion-h-title\">总结</span></span></h3><div class=\"notion-blank notion-block-2cdb67dbfc9a80c1b099c51e9d19c17f\"> </div><h3 class=\"notion-h notion-h2 notion-h-indent-0 notion-block-2cbb67dbfc9a80569ef5d46af64f8282\" data-id=\"2cbb67dbfc9a80569ef5d46af64f8282\"><span><div id=\"2cbb67dbfc9a80569ef5d46af64f8282\" class=\"notion-header-anchor\"></div><a class=\"notion-hash-link\" href=\"#2cbb67dbfc9a80569ef5d46af64f8282\" title=\"参考资料\"><svg viewBox=\"0 0 16 16\" width=\"16\" height=\"16\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a><span class=\"notion-h-title\">参考资料</span></span></h3><ul class=\"notion-list notion-list-disc notion-block-2cbb67dbfc9a80468328c24d65dba474\"><li><span class=\"notion-link-mention\"><a href=\"https://le1a.github.io/article/2ae7c031-1dd6-80f9-b3b2-dfaf8b7cc13e\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"notion-link-mention-link\"><img class=\"notion-link-mention-icon\" src=\"https://le1a.github.io/favicon.ico\" alt=\"TongWeb ejbserver 反序列化漏洞分析 | Le1a的菜园坝\"/><span class=\"notion-link-mention-provider\">TongWeb ejbserver 反序列化漏洞分析 | Le1a的菜园坝</span><span class=\"notion-link-mention-title\">TongWeb ejbserver 反序列化漏洞分析 | Le1a的菜园坝</span></a><div class=\"notion-link-mention-preview\"><article class=\"notion-link-mention-card\"><img class=\"notion-link-mention-preview-thumbnail\" src=\"https://images.unsplash.com/photo-1645927790904-b307b37e276a?ixlib=rb-4.1.0&amp;q=50&amp;fm=webp&amp;crop=entropy&amp;cs=srgb&amp;t=2ae7c031-1dd6-80f9-b3b2-dfaf8b7cc13e&amp;width=800&amp;fmt=webp\" alt=\"TongWeb ejbserver 反序列化漏洞分析 | Le1a的菜园坝\" referrerPolicy=\"same-origin\"/><div class=\"notion-link-mention-preview-content\"><p class=\"notion-link-mention-preview-title\">TongWeb ejbserver 反序列化漏洞分析 | Le1a的菜园坝</p><p class=\"notion-link-mention-preview-description\">一个NotionNext搭建的博客</p><div class=\"notion-link-mention-preview-footer\"><img class=\"notion-link-mention-preview-icon\" src=\"https://le1a.github.io/favicon.ico\" alt=\"TongWeb ejbserver 反序列化漏洞分析 | Le1a的菜园坝\" referrerPolicy=\"same-origin\"/><span class=\"notion-link-mention-preview-provider\">TongWeb ejbserver 反序列化漏洞分析 | Le1a的菜园坝</span></div></div></article></div></span></li></ul><ul class=\"notion-list notion-list-disc notion-block-2cbb67dbfc9a80118790ea4ad99a55d3\"><li><span class=\"notion-link-mention\"><a href=\"https://blog.yinsel.redcellsec.cn/%E7%9F%A5%E8%AF%86%E5%BA%93/%E7%BA%A2%E8%93%9D%E5%AF%B9%E6%8A%97/%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F--and--%E6%BC%8F%E6%B4%9E/TongWeb/TongWeb-EJB-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"notion-link-mention-link\"><img class=\"notion-link-mention-icon\" src=\"https://blog.yinsel.redcellsec.cn/static/icon.png\" alt=\"YinselのBlog\"/><span class=\"notion-link-mention-provider\">YinselのBlog</span><span class=\"notion-link-mention-title\">TongWeb EJB 反序列化漏洞 | YinselのBlog</span></a><div class=\"notion-link-mention-preview\"><article class=\"notion-link-mention-card\"><img class=\"notion-link-mention-preview-thumbnail\" src=\"https://blog.yinsel.top/知识库/红蓝对抗/应用程序--and--漏洞/TongWeb/TongWeb-EJB-反序列化漏洞-og-image.webp\" alt=\"TongWeb EJB 反序列化漏洞 | YinselのBlog\" referrerPolicy=\"same-origin\"/><div class=\"notion-link-mention-preview-content\"><p class=\"notion-link-mention-preview-title\">TongWeb EJB 反序列化漏洞 | YinselのBlog</p><p class=\"notion-link-mention-preview-description\">TongWeb EJB 反序列化漏洞 声明 本文版权归原作者所有，未经允许禁止转载。 2025 年 11 月 13 日爆出的漏洞，手上有环境和源码，并且朋友第一时间透露了利用链的信息，于是便尝试复现并分析，记录下来。 漏洞原理 TongWeb ejb 服务没有校验请求的数据，直接对来源的数据进行反序列化，而默认情况下，http 服务（8088 端口） /ejbserver/ejb 接口会转发至 ejb 服务（5100 端口）的相同接口，攻击者可发送特定的数据包，造成反序列化漏洞，其中可利用的反序列化链主要有： # 7.0.4.2 可用, 7.0.4.9黑名单 BadAttributeValue...</p><div class=\"notion-link-mention-preview-footer\"><img class=\"notion-link-mention-preview-icon\" src=\"https://blog.yinsel.redcellsec.cn/static/icon.png\" alt=\"YinselのBlog\" referrerPolicy=\"same-origin\"/><span class=\"notion-link-mention-preview-provider\">YinselのBlog</span></div></div></article></div></span></li></ul><ul class=\"notion-list notion-list-disc notion-block-2cbb67dbfc9a800bbd97fb8d2d66b234\"><li><a target=\"_blank\" rel=\"noopener noreferrer\" class=\"notion-link\" href=\"https://mp.weixin.qq.com/s/xR4hMI52b0ud43G5c3yenQ\">https://mp.weixin.qq.com/s/xR4hMI52b0ud43G5c3yenQ</a></li></ul><ul class=\"notion-list notion-list-disc notion-block-2cbb67dbfc9a80ffbdcfe5b184e76ed5\"><li><span class=\"notion-link-mention\"><a href=\"https://github.com/ReaJason/MemShellParty/\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"notion-link-mention-link\"><img class=\"notion-link-mention-icon\" src=\"https://github.com/fluidicon.png\" alt=\"GitHub\"/><span class=\"notion-link-mention-provider\">GitHub</span><span class=\"notion-link-mention-title\">GitHub - ReaJason/MemShellParty: 一款专注于 Java 主流 Web 中间件的内存马快速生成工具，致力于简化安全研究人员和红队成员的工作流程，提升攻防效率</span></a><div class=\"notion-link-mention-preview\"><article class=\"notion-link-mention-card\"><img class=\"notion-link-mention-preview-thumbnail\" src=\"https://opengraph.githubassets.com/0f7379eda55020971d1e6615b45531fb05e8929b93cd5dd1f7d227e2b9a107c6/ReaJason/MemShellParty\" alt=\"GitHub - ReaJason/MemShellParty: 一款专注于 Java 主流 Web 中间件的内存马快速生成工具，致力于简化安全研究人员和红队成员的工作流程，提升攻防效率\" referrerPolicy=\"same-origin\"/><div class=\"notion-link-mention-preview-content\"><p class=\"notion-link-mention-preview-title\">GitHub - ReaJason/MemShellParty: 一款专注于 Java 主流 Web 中间件的内存马快速生成工具，致力于简化安全研究人员和红队成员的工作流程，提升攻防效率</p><p class=\"notion-link-mention-preview-description\">一款专注于 Java 主流 Web 中间件的内存马快速生成工具，致力于简化安全研究人员和红队成员的工作流程，提升攻防效率 - ReaJason/MemShellParty</p><div class=\"notion-link-mention-preview-footer\"><img class=\"notion-link-mention-preview-icon\" src=\"https://github.com/fluidicon.png\" alt=\"GitHub\" referrerPolicy=\"same-origin\"/><span class=\"notion-link-mention-preview-provider\">GitHub</span></div></div></article></div></span></li></ul><ul class=\"notion-list notion-list-disc notion-block-2cbb67dbfc9a80bfb04cce6c0b38fd61\"><li><span class=\"notion-link-mention\"><a href=\"https://github.com/vulhub/java-chains/\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"notion-link-mention-link\"><img class=\"notion-link-mention-icon\" src=\"https://github.com/fluidicon.png\" alt=\"GitHub\"/><span class=\"notion-link-mention-provider\">GitHub</span><span class=\"notion-link-mention-title\">GitHub - vulhub/java-chains: Java Vulnerability Exploitation Platform</span></a><div class=\"notion-link-mention-preview\"><article class=\"notion-link-mention-card\"><img class=\"notion-link-mention-preview-thumbnail\" src=\"https://opengraph.githubassets.com/d63cb0667b8b5f0e3ac36743e421f12b8a0e2293b29dc619ae8ee1ab00228473/vulhub/java-chains\" alt=\"GitHub - vulhub/java-chains: Java Vulnerability Exploitation Platform\" referrerPolicy=\"same-origin\"/><div class=\"notion-link-mention-preview-content\"><p class=\"notion-link-mention-preview-title\">GitHub - vulhub/java-chains: Java Vulnerability Exploitation Platform</p><p class=\"notion-link-mention-preview-description\">Java Vulnerability Exploitation Platform. Contribute to vulhub/java-chains development by creating an account on GitHub.</p><div class=\"notion-link-mention-preview-footer\"><img class=\"notion-link-mention-preview-icon\" src=\"https://github.com/fluidicon.png\" alt=\"GitHub\" referrerPolicy=\"same-origin\"/><span class=\"notion-link-mention-preview-provider\">GitHub</span></div></div></article></div></span></li></ul><ul class=\"notion-list notion-list-disc notion-block-2cbb67dbfc9a8065a7f9de1429746b61\"><li><span class=\"notion-link-mention\"><a href=\"https://github.com/tabby-sec/tabby/\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"notion-link-mention-link\"><img class=\"notion-link-mention-icon\" src=\"https://github.com/fluidicon.png\" alt=\"GitHub\"/><span class=\"notion-link-mention-provider\">GitHub</span><span class=\"notion-link-mention-title\">GitHub - tabby-sec/tabby: A CAT called tabby ( Code Analysis Tool )</span></a><div class=\"notion-link-mention-preview\"><article class=\"notion-link-mention-card\"><img class=\"notion-link-mention-preview-thumbnail\" src=\"https://opengraph.githubassets.com/6af4519d02b85dfaaad1bfec6bd3a9f3dcf51646138179596c54317cb45c23ef/tabby-sec/tabby\" alt=\"GitHub - tabby-sec/tabby: A CAT called tabby ( Code Analysis Tool )\" referrerPolicy=\"same-origin\"/><div class=\"notion-link-mention-preview-content\"><p class=\"notion-link-mention-preview-title\">GitHub - tabby-sec/tabby: A CAT called tabby ( Code Analysis Tool )</p><p class=\"notion-link-mention-preview-description\">A CAT called tabby ( Code Analysis Tool ). Contribute to tabby-sec/tabby development by creating an account on GitHub.</p><div class=\"notion-link-mention-preview-footer\"><img class=\"notion-link-mention-preview-icon\" src=\"https://github.com/fluidicon.png\" alt=\"GitHub\" referrerPolicy=\"same-origin\"/><span class=\"notion-link-mention-preview-provider\">GitHub</span></div></div></article></div></span></li></ul><div class=\"notion-blank notion-block-2cbb67dbfc9a8022b897dd9ee76b76cb\"> </div></main></div>",
            "url": "https://thestar0.github.io//article/2025/12/16/2cbb67db-fc9a-80a5-9e34-d2ff9dee6f73",
            "title": "tabby 辅助下的TongWeb ejb接口反序列化漏洞分析与复现",
            "date_modified": "2025-12-16T00:00:00.000Z"
        },
        {
            "url": "https://thestar0.github.io//article/2025/12/18/2ccb67db-fc9a-8066-a6d2-ff00a136aa94",
            "title": "永洪BI未公开历史漏洞分析",
            "date_modified": "2025-12-18T00:00:00.000Z"
        }
    ]
}